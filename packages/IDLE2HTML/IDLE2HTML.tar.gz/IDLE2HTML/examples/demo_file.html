<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/2002/REC-xhtml1-20020801/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>IDLE2HTML</title>
<meta name="generator" content="IDLE2HTML - IDLE extension" />
<style type="text/css">
.COMMENT {color: #dd0000; background: #ffffff;}
.DEFINITION {color: #0000ff; background: #ffffff;}
.hit {color: #ffffff; background: #000000;}
.STRING {color: #00aa00; background: #ffffff;}
.KEYWORD {color: #ff7700; background: #ffffff;}
.SYNC {color: ; background: ;}
.BREAK {color: black; background: #ffff55;}
.BUILTIN {color: #900090; background: #ffffff;}
.ERROR {color: #000000; background: #ff7777;}
.TODO {color: ; background: ;}
.sel {color: SystemHighlightText; background: SystemHighlight;}
</style>
</head>
<body>
<pre><span class="COMMENT"># IDLE2HTML - IDLE extension</span>
<span class="COMMENT"># saves the contents of the editwindow (file or shell)</span>
<span class="COMMENT"># to a html file using css styles</span>
<span class="COMMENT">#</span>
<span class="COMMENT"># creator:        d2m &lt;michael@d2m.at&gt;</span>
<span class="COMMENT"># 0.1/2006-07-22: initial revision</span>
<span class="COMMENT">#</span>
<span class="COMMENT"># todo:           check for valid css color values</span>
<span class="COMMENT">#                 use elementtree for html generation</span>

<span class="KEYWORD">import</span> Tkinter 
<span class="KEYWORD">import</span> tkFileDialog
<span class="KEYWORD">import</span> cgi

<span class="KEYWORD">class</span> <span class="DEFINITION">IDLE2HTML</span>:
    menudefs=[(<span class="STRING">'options'</span>,[(<span class="STRING">'Save to HTML'</span>, <span class="STRING">'&lt;&lt;idle2html&gt;&gt;'</span>)])]

    <span class="KEYWORD">def</span> <span class="DEFINITION">__init__</span>(self,editwin):
        self.editwin=editwin
        self.text=editwin.text
            
    <span class="KEYWORD">def</span> <span class="DEFINITION">idle2html_event</span>(self, event=<span class="BUILTIN">None</span>):
        filetypes = [
            (<span class="STRING">"All HTML files"</span>, <span class="STRING">"*.htm *.html"</span>, <span class="STRING">"TEXT"</span>),
            (<span class="STRING">"All files"</span>, <span class="STRING">"*"</span>),
            ]
        filename=tkFileDialog.SaveAs(master=self.text, filetypes=filetypes).show()
        f=<span class="BUILTIN">open</span>(filename,<span class="STRING">'w'</span>)
        f.write(self.idle2html())
        f.close()
        
    <span class="KEYWORD">def</span> <span class="DEFINITION">idle2html</span>(self):
        <span class="STRING">"""format tags 2 html
        """</span>
        out=[<span class="STRING">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" \
"http://www.w3.org/TR/2002/REC-xhtml1-20020801/DTD/xhtml1-transitional.dtd"&gt;\n'</span>]
        out.append(<span class="STRING">'&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;IDLE2HTML&lt;/title&gt;\n'</span>)
        out.append(<span class="STRING">'&lt;meta name="generator" content="IDLE2HTML - IDLE extension" /&gt;\n'</span>)
        out.append(<span class="STRING">'&lt;style type="text/css"&gt;\n'</span>)
        <span class="KEYWORD">for</span> tagname <span class="KEYWORD">in</span> self.text.tag_names():
            out.append(<span class="STRING">'.%s {color: %s; background: %s;}\n'</span> % (
                tagname,
                self.text.tag_cget(tagname,<span class="STRING">'foreground'</span>),
                self.text.tag_cget(tagname,<span class="STRING">'background'</span>),
                )
                       )
        out.append(<span class="STRING">'&lt;/style&gt;\n'</span>)
        out.append(<span class="STRING">'&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;'</span>)
        <span class="KEYWORD">for</span> tagname,content,dummy <span class="KEYWORD">in</span> self.text.dump(<span class="STRING">'1.0'</span>,self.text.index(<span class="STRING">'end'</span>)):
            <span class="KEYWORD">if</span> tagname==<span class="STRING">'tagon'</span> <span class="KEYWORD">and</span> content != <span class="STRING">'SYNC'</span>:
                out.append(<span class="STRING">'&lt;span class="'</span>+content+<span class="STRING">'"&gt;'</span>)
            <span class="KEYWORD">if</span> tagname==<span class="STRING">'text'</span>:
                out.append(cgi.escape(content))
            <span class="KEYWORD">if</span> tagname==<span class="STRING">'tagoff'</span> <span class="KEYWORD">and</span> content != <span class="STRING">'SYNC'</span>:
                out.append(<span class="STRING">'&lt;/span&gt;'</span>)
        out.append(<span class="STRING">'&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;'</span>)
        <span class="KEYWORD">return</span> <span class="STRING">''</span>.join(out)


</pre>
</body>
</html>