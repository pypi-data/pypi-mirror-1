<fieldset class="new-plone-relation"
          i18n:domain="plone">
  <legend>New relation</legend>
  <table style="border: 0px">
    <tr>
      <td>
        <input id="#" name="#" value="#"
               tal:define="field_name string:${context/getName}.search_value;"
               tal:attributes="id python:view.nameToId(field_name);  
                               name field_name;
                               value view/getSearchValue" />
      </td>
      <td>
        <input type="submit" 
               id="#" name="#" 
               value="Search"
               tal:define="field_name string:${context/getName}.search_button"
               tal:attributes="name field_name;
                               id python:view.nameToId(field_name)" />
      </td>
    </tr>
    <tal:block define="results view/getSearchResult"
               condition="results">
      <tr tal:repeat="result results">
        <tal:define tal:define="field_dot string:${context/getName}.add_value.${repeat/result/number};
                                field_id python:view.nameToId(field_dot)">
          <td>
            <input type="#" id="#" name="#" value="#"
                   tal:attributes="type  view/getButtonType;
                                   name  string:${context/getName}.add_value:list;
                                   id    field_id;
                                   value result/uid" />
          </td>
          <td>
            <label for="#"
                   tal:attributes="for   field_id">
              <a href="#"
                 tal:attributes="href    result/url"
                 tal:content="result/title">
                Title
              </a>
            </label>
          </td>
        </tal:define>
      </tr>
      <tr tal:condition="context/relationUseContext">
        <td colspan="2"
            tal:content="structure context/renderEditContext">
        </td>
      </tr>
      <tr>
        <td>
          <input type="submit" 
                 id="#" name="#"
                 value="Add"
                 tal:define="field_name string:${context/getName}.add_button"
                 tal:attributes="name   field_name;
                                 id     python:view.nameToId(field_name)" />
        </td>
      </tr>
    </tal:block>
  </table>
</fieldset>
