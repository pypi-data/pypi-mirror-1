<tal:block define="relations view/getRelationToRender"
           i18n:domain="plone">
  <tal:replace condition="view/canAddValues"
               replace="structure view/renderAddWidget" />
  <fieldset tal:condition="relations"
            class="edit-plone-relation">
    <legend tal:condition="not:view/relationAsOneItem">Current relations</legend>
    <legend tal:condition="view/relationAsOneItem">Current relation</legend>
    <table style="border: 0px">
      <tal:repeat repeat="relation relations">
        <tr>
          <td>
            <tal:repeat repeat="object relation/objects">
              <a href="#"
                 tal:attributes="href object/url"
                 tal:content="object/title">
                Title
              </a>
              <input type="hidden"
                     name="#" value="#" 
                     tal:attributes="name  string:${view/getName}.${relation/nb}:list;
                                     value object/uid" />
              <br tal:condition="not: repeat/object/end" />
            </tal:repeat>
          </td>
          <td tal:condition="context/relationUseContext">
            <input type="submit"
                   id="#" name="#"  
                   value="Modify"
                   tal:define="field_dot string:${view/getName}.modify_${relation/nb}"
                   tal:attributes="name  field_dot;
                                   id    python:view.nameToId(field_dot)"
                   tal:condition="not:relation/modify" />
            <input type="hidden"
                   name="#" value="#"
                   tal:attributes="name string:${view/getName}.context_${relation/nb};
                                   value relation/context" />
          </td>
          <td>
            <input type="submit"
                   id="#" name="#"  
                   value="Delete" 
                   tal:define="field_dot string:${view/getName}.remove_${relation/nb}"
                   tal:attributes="name  field_dot;
                                   id    python:view.nameToId(field_dot)"
                    />
          </td>
        </tr>
        <tr tal:condition="relation/modify">
          <td colspan="3">
            <tal:replace replace="structure view/renderEditContext" />
          </td>
        </tr>
      </tal:repeat>
    </table>
  </fieldset>
  <input type="hidden" 
         name="#" value="#" 
         tal:attributes="name string:${view/getName}.marker;
                         value view/getRelationCount"
         />
</tal:block>
