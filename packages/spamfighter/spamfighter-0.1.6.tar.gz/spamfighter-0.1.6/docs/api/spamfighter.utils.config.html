<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>API docs for &ldquo;spamfighter.utils.config&rdquo;</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="module">Module s.u.config</h1>
    <p>
      <span id="part">Part of <a href="spamfighter.html">spamfighter</a>.<a href="spamfighter.utils.html">utils</a></span>
      <a href="http://spam-fighter.ru/browser/config.py">View Source</a>
      
    </p>
    <div>
      
    </div>
    <div>Питоновский враппер конфигурационных 
XML файлов</p>
<p>Превращает xml файл с конфигом в 
питоновскую структуру настроек</p>
<p>Парсинг xml ===========</p>
<ul>
  <li>
    тег со значением транслируется в 
    строковую переменную:
<pre class="literalblock">
   &lt;variable&gt;value&lt;/variable&gt; 
   &gt;&gt;&gt;variable
   &quot;value&quot;
</pre>
  </li>
  <li>
    тег c аттрибутом type по возможности 
    будет оттранслирован в переменную 
    данного типа:
<pre class="literalblock">
   &lt;variable type=&quot;int&quot;&gt;5&lt;/variable&gt; 
   &gt;&gt;&gt;variable
   5
</pre>
  </li>
  <li>
    вложенные теги во вложенные объекты 
    класса {L Cfg} где дочерние элементы 
    представлены атрибутами:
<pre class="literalblock">
   &lt;parent&gt;
       &lt;child&gt;value&lt;/child&gt;
       &lt;child2&gt;value&lt;/child&gt;
   &lt;/parent&gt;
   &gt;&gt;&gt;parent.child
   &quot;value&quot;
   &gt;&gt;&gt;parent.child2
   &quot;value&quot;
</pre>
  </li>
  <li>
    Одинаковые теги с указанным id 
    превращаются в питоновский хэш:
<pre class="literalblock">
   &lt;parent&gt;
       &lt;items id = 'first'&gt;value1&lt;/items&gt;
       &lt;items id = 'second'&gt;value2&lt;/items&gt;
   &lt;/parent&gt;

   &gt;&gt;&gt;parent.items['first']
   &quot;value1&quot;
</pre>
  </li>
</ul>
<p>Структура xml конфига ===================== :</p>
<pre class="literalblock">
   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
   &lt;!DOCTYPE config&gt;
   &lt;config&gt;
       &lt;global&gt;
       &lt;!-- основная секция. Все что находится в этой секции будет доступно как аттрибуты модуля config  --&gt;
           &lt;servers&gt;
               &lt;!-- список &quot;боевых&quot; серверов. --&gt;
               &lt;server id=&quot;1&quot;&gt;
                   &lt;hostname&gt;webmorda.netstream.ru&lt;/hostname&gt;
               &lt;/server&gt;
           &lt;/servers&gt;
           &lt;some_my_params&gt;some my value&lt;/some_my_params&gt;
       &lt;/global&gt;
       &lt;local&gt;
       &lt;/local&gt;
       &lt;development&gt;
           &lt;!-- девелоперские настройки. Эта секция будет подключена в случае если сервер на котором запущено приложение, не в списке &quot;боевых&quot; серверов.
           Настройки из этого раздела перезаписывают одноименные настроки из основного раздела --&gt;
           &lt;some_my_params&gt;some my value&lt;/some_my_params&gt;
       &lt;/development&gt;
       &lt;testing&gt;
       &lt;!-- тестировочный раздел. Будет подключен если приложение запущено из под trial. Настройки из этого раздела перетирают одноименные настройки
       из основного и девелоперского разделов.
           &lt;some_my_params&gt;some my value&lt;/some_my_params&gt;
       &lt;/testing&gt;
   &lt;/config&gt;
</pre>
<p>Пример использования ====================</p>
<p>from spamfighter.utils import config # в случае если 
используется  конфигурационный файл 
./config.xml - этой строки достаточно 
config.load(&quot;cfg.py&quot;) print  config.some_my_params<table class="fieldTable"></table></div>

    
    
    <div id="splitTables">
      <table class="children sortable" id="id346">
  
  
<tr class="function">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#parse_file">parse_file</a></td>
    <td><span>Парсим переданный файл и возвращаем 
объект Cfg</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#load">load</a></td>
    <td><span>Загружаем переданный файл с конфигом 
или конфиг по умолчанию и</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="spamfighter.utils.config.Cfg.html">Cfg</a></td>
    <td><span>Класс в который мы заворачиваем хеш. 
Нужен для того, чтобы нормально 
отображать штуки типа config.db.dsn</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="spamfighter.utils.config.ParseException.html">ParseException</a></td>
    <td><span>Исключение кидаемое при попытке 
распарсить файл с некорректной 
структурой</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_parse_dom">_parse_dom</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_get_class_by_name">_get_class_by_name</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_is_numeric_dict">_is_numeric_dict</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_deep_merge">_deep_merge</a></td>
    <td><span>пробегаемся по всему хешу</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_get_path">_get_path</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_load_file">_load_file</a></td>
    <td><span>Загружаем указанный файл и возвращаем 
его в качестве конфигурационного.</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="spamfighter.utils.config.html#_export_config">_export_config</a></td>
    <td><span>Экспортирует указанный 
конфигурационный файл в качетсве 
атрибутов данного модуля.</span></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    

    <div class="function">
  <a name="spamfighter.utils.config.parse_file">
    
  </a>
  <a name="parse_file">
    
  </a>
  <div class="functionHeader">
    
    def
    parse_file(filename):
    <a href="http://spam-fighter.ru/browser/config.py#L110" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Парсим переданный файл и возвращаем 
объект Cfg</p>
<p>Данный метод НЕ парсит секции global, 
development и проч, а просто переводит xml в 
питоновский объект</p>
<p>Использование: from spamfighet.utils.config import 
parse_file cfg = parse_file('cfg.xml') print cfg.some_my_params<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">filename</td><td>имя файла с конфигом @rtype : <code>Cfg</code> @return : 
экземпляр Cfg c настройками
 (type: <code>str</code>
)</td></tr></table></div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._parse_dom">
    
  </a>
  <a name="_parse_dom">
    
  </a>
  <div class="functionHeader">
    
    def
    _parse_dom(dom):
    <a href="http://spam-fighter.ru/browser/config.py#L132" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._get_class_by_name">
    
  </a>
  <a name="_get_class_by_name">
    
  </a>
  <div class="functionHeader">
    
    def
    _get_class_by_name(name):
    <a href="http://spam-fighter.ru/browser/config.py#L168" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._is_numeric_dict">
    
  </a>
  <a name="_is_numeric_dict">
    
  </a>
  <div class="functionHeader">
    
    def
    _is_numeric_dict(d):
    <a href="http://spam-fighter.ru/browser/config.py#L176" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._deep_merge">
    
  </a>
  <a name="_deep_merge">
    
  </a>
  <div class="functionHeader">
    
    def
    _deep_merge(old, new):
    <a href="http://spam-fighter.ru/browser/config.py#L187" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>пробегаемся по всему хешу<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._get_path">
    
  </a>
  <a name="_get_path">
    
  </a>
  <div class="functionHeader">
    
    def
    _get_path():
    <a href="http://spam-fighter.ru/browser/config.py#L201" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config.load">
    
  </a>
  <a name="load">
    
  </a>
  <div class="functionHeader">
    
    def
    load(filename=_get_path() + '/config.xml'):
    <a href="http://spam-fighter.ru/browser/config.py#L204" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Загружаем переданный файл с конфигом 
или конфиг по умолчанию и отображаем его 
в виде содержимого данного модуля.</p>
<p>Использование: from spamfighther.utils import config 
config.load(&quot;cfg.xml&quot;) print config.some_my_param<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._load_file">
    
  </a>
  <a name="_load_file">
    
  </a>
  <div class="functionHeader">
    
    def
    _load_file(filename):
    <a href="http://spam-fighter.ru/browser/config.py#L217" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Загружаем указанный файл и возвращаем 
его в качестве конфигурационного.<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="spamfighter.utils.config._export_config">
    
  </a>
  <a name="_export_config">
    
  </a>
  <div class="functionHeader">
    
    def
    _export_config(__config):
    <a href="http://spam-fighter.ru/browser/config.py#L266" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Экспортирует указанный 
конфигурационный файл в качетсве 
атрибутов данного модуля.</p>
<p>Предварительно удаляем старые 
отображения.<table class="fieldTable"></table></div>
  </div>
</div>
    <address>
      <a href="index.html">API Documentation</a> for SpamFighter, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2009-02-22 18:23:24.
    </address>
  </body>
</html>