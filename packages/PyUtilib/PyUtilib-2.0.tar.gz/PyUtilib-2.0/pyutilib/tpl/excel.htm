<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>excel code</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="/stylesheets/snippets.css?1210343063" media="screen" rel="Stylesheet" type="text/css" />
    <link href="/stylesheets/minitabs.css?1178022196" media="screen" rel="Stylesheet" type="text/css" />

    <!--[if IE]>
    <link href="/stylesheets/iefixes.css?1178022196" media="screen" rel="Stylesheet" type="text/css" />
    <![endif]-->
    <!-- Use this code block to activate a prestitial if there's one to load -->
<!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->


<script language="JavaScript">
<!--

function SymError()
{
  return true;
}

window.onerror = SymError;

function SymInitWinOpen()
{
  if (SymRealWinOpen == null)
     SymRealWinOpen = window.open;
  return SymWinOpen;
}

function SymWinOpen(url, name, attributes)
{
  return (new Object());
}

var SymRealWinOpen;
window.open = SymInitWinOpen();

//-->
</script>

<SCRIPT language="JavaScript" type="text/javascript">
<!--
document.write('<SCR'+'IPT src="http://avpa.javalobby.org/servlet/view/dynamic/javascript/zone?zid=159&pid=0&random='+Math.floor(89999999*Math.random()+10000000)+'&millis='+new Date().getTime()+'" language="JavaScript" type="text/javascript"></SCR'+'IPT>');
//-->
</SCRIPT>

<!-- END ADVERTPRO ADVANCED CODE BLOCK -->
</head>

<body class="normal" id="none">
    <div id="container">
      <div id="header">
	<form action="/account/login" method="post">
	    <div id="functions">
	    <a href="/account/signup">Create account</a> or <input id="username" name="username" type="text" /> <input id="password" name="password" type="password" /> <input name="commit" type="submit" value="Log In" /><br />
         <!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->

<!-- b style="background-color: #f5f; border-top: solid 1px #660; border-bottom: solid 1px #660; padding: 4px" -->
<!-- %= link_to 'Get your coding job seen by 130,000 coders', :controller => 'ads', :action => 'new' % -->
<!-- /b -->
	    </div>
	</form>
	<p id="title">
    <a href="http://snippets.dzone.com/">DZone Snippets</a>
    
     &gt; <a href="/tag/excel">excel</a>
</p><p><em>11415 users tagging and storing useful source code snippets</em></p>
	<!-- p><em>Post code snippets. Sort by tags, people, people and tags, etc..</em></p -->
</div>

      




      


<div id="sidebar">
    <div class="inner">
                       <div id="mediumRect" class="box">
            <!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->



<A href="http://avpa.javalobby.org/servlet/click/zone?zid=83&pid=0&lookup=true&position=1" target="_top">

</A>


<!-- END ADVERTPRO ADVANCED CODE BLOCK -->
        </div>
               

        <div id="dzone_latest" class="box blue">
            <h3>Popular @ <a href="http://www.dzone.com">dzone.com</a></h3>
            
                        <p><a href="http://www.dzone.com/links/rss/50_web_designers_to_follow_on_twitter.html" title="50  Web Designers to Follow On Twitter">
                           50  Web Designers to Follow On Twitter</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/dont_fear_the_regexp.html" title="Groovy:  Don't Fear the RegExp">
                           Groovy:  Don't Fear the RegExp</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/top_reasons_your_css_columns_are_messed_up.html" title="Top reasons your CSS columns are messed up">
                           Top reasons your CSS columns are messed up</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/java_concurrency_starvation_and_fairness.html" title="Java Concurrency - Starvation and Fairness">
                           Java Concurrency - Starvation and Fairness</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/festswing_10a2_fluent_interface_for_testing_swing.html" title="FEST-Swing 1.0a2: Fluent interface for testing Swing GUIs">
                           FEST-Swing 1.0a2: Fluent interface for testing ...</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/share_your_eclipse_tool_configurations_with_pulse.html" title="Share Your Eclipse Tool Configurations With Pulse">
                           Share Your Eclipse Tool Configurations With Pulse</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/debugging_web_services.html" title="Debugging Web Services">
                           Debugging Web Services</a></p>
            
        </div>

        
        
        <div class="box green">
            <h3>Related Tags</h3>
            <p>
                
                <a href="/tag/excel" class="tag ">excel</a> (10)<br /><a href="/tag/vba" class="tag ">vba</a> (4)<br /><a href="/tag/ruby" class="tag ">ruby</a> (2)<br /><a href="/tag/oracle" class="tag ">oracle</a> (2)<br /><a href="/tag/query" class="tag ">query</a> (2)<br /><a href="/tag/registry" class="tag ">registry</a> (1)<br /><a href="/tag/object" class="tag ">object</a> (1)<br /><a href="/tag/com" class="tag ">com</a> (1)<br /><a href="/tag/QueryTables" class="tag ">QueryTables</a> (1)<br /><a href="/tag/access" class="tag ">access</a> (1)<br /><a href="/tag/word" class="tag ">word</a> (1)<br /><a href="/tag/sqlite" class="tag ">sqlite</a> (1)<br /><a href="/tag/DDE" class="tag ">DDE</a> (1)<br /><a href="/tag/python" class="tag ">python</a> (1)<br /><a href="/tag/refresh" class="tag ">refresh</a> (1)<br /><a href="/tag/PivotTable" class="tag ">PivotTable</a> (1)<br /><a href="/tag/worksheet" class="tag ">worksheet</a> (1)<br />
                
            </p>
        </div>
        
        
        
        
    </div>
</div>

<div id="main">
    <div id="leaderboard">
    
    
    <A href="http://avpa.javalobby.org/servlet/click/zone?zid=91&pid=0&lookup=true&position=1" target="_top">
    
    </A>
    
    <!-- END ADVERTPRO ADVANCED CODE BLOCK -->
</div>
      
    
        <div class="green box">
            <h3>Never been to DZone Snippets before?</h3>
            <p><b>Snippets is a <span class='highlighted'>public source code repository.</span></b> Easily build up your personal collection of code snippets, categorize them with tags / keywords, and share them with the world</p>
        </div>
        
    
    

<!--     -->
        


<div class="box grey paginator" style="text-align: center; color: #fff"><div style="float: left">
    <span class="disabled">&laquo; Newer Snippets</span></div><div style="float: right"><span class="disabled">Older Snippets &raquo;</span></div>Showing 1-9 of 9 total <a title="RSS 2.0" href="/rss/tag/excel"><span style="border:1px solid;border-color:#FC9 #630 #330 #F96;padding:1px 4px;font:bold 11px verdana,sans-serif;color:#FFF;background:#F60;text-decoration:none;margin:0px">&nbsp;RSS&nbsp;</span></a><br />
<div style="margin-top: 8px; "><form action="#"><select style="width: 250px" onchange="JumpToIt(this)">
 
 <option value="#post4675">Excel VBA : read registry key values on a remote computer using WMI</option>
 
 <option value="#post4518">Excel : Make a query on a Oracle database and return the result (useful for sheet formulas)</option>
 
 <option value="#post4503">VBA procedure to pen an Excel workbook and refresh all datas in the QueryTables and PivotTable objects</option>
 
 <option value="#post4317">Excel object</option>
 
 <option value="#post4215">Create an SQLite Database from an Excel Workbook with Ruby</option>
 
 <option value="#post3613">Detect a field edit in Excel and refresh a Query</option>
 
 <option value="#post3610">Script Excel in Ruby</option>
 
 <option value="#post3112">VBA DDE WORD EXCEL</option>
 
 <option value="#post2036">Script Excel from Python</option>
 
 </select></form>
     </div>

</div>





<div id="posts">
	<a name="post4675"></a>

<div id="post4675">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/4675">Excel VBA : read registry key values on a remote computer using WMI</a></h3>

		<div class="post-body">// VBA code to paste in an module<br /><pre>
<span class="constant">Function</span> <span class="constant">ORACLEHOMES</span><span class="punct">(</span><span class="ident">strComputer</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">)</span>
    <span class="constant">Const</span> <span class="constant">HKEY_LOCAL_MACHINE</span> <span class="punct">=</span> <span class="punct">&amp;</span><span class="constant">H80000002</span>
    <span class="constant">ORACLEHOMES</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">Dim</span> <span class="ident">strKeyPath</span>
    <span class="constant">Dim</span> <span class="ident">arrSubKeys</span>
    <span class="constant">Dim</span> <span class="ident">oReg</span>
    <span class="constant">Dim</span> <span class="ident">strValueName</span>
    <span class="constant">Dim</span> <span class="ident">strValue</span>
    <span class="punct">'</span><span class="string">strComputer = &quot;.&quot;
    Set oReg = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!<span class="escape">\\</span>&quot; &amp; strComputer &amp; &quot;\root\default:StdRegProv&quot;)
    strKeyPath = &quot;SOFTWARE\ORACLE&quot;
    oReg.EnumKey HKEY_LOCAL_MACHINE, strKeyPath, arrSubKeys
    For Each subkey In arrSubKeys
        If Left(subkey, 4) = &quot;KEY_&quot; Then
            strValueName = &quot;ORACLE_HOME&quot;
            oReg.GetStringValue HKEY_LOCAL_MACHINE, strKeyPath &amp; &quot;\&quot; &amp; subkey, strValueName, strValue
            If ORACLEHOMES = &quot;&quot; Then
                ORACLEHOMES = strValue
            Else
                ORACLEHOMES = ORACLEHOMES &amp; &quot;;&quot; &amp; strValue
            End If
        End If
    Next
End Function<span class="normal">
</span></span></pre></div>

		<div class="post-metadata">to <a href="/tag/oracle" class="tag ">oracle</a> <a href="/tag/registry" class="tag ">registry</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (1511) --> by <a href="/user/bouffon69">bouffon69</a> on Oct 19, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post4518"></a>

<div id="post4518">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/4518">Excel : Make a query on a Oracle database and return the result (useful for sheet formulas)</a></h3>

		<div class="post-body">// This should be pasted in a module of the workbook<br /><pre>
<span class="constant">Function</span> <span class="constant">ORAQUERY</span><span class="punct">(</span><span class="ident">strHost</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">,</span> <span class="ident">strDatabase</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">,</span> <span class="ident">strSQL</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">,</span> <span class="ident">strUser</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">,</span> <span class="ident">strPassword</span> <span class="constant">As</span> <span class="constant">String</span><span class="punct">)</span>
  <span class="constant">Dim</span> <span class="ident">strConOracle</span><span class="punct">,</span> <span class="ident">oConOracle</span><span class="punct">,</span> <span class="ident">oRsOracle</span>
  <span class="constant">Dim</span> <span class="constant">StrResult</span> <span class="constant">As</span> <span class="constant">String</span>
  
  <span class="constant">StrResult</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;</span>
  
  <span class="ident">strConOracle</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">Driver={Microsoft ODBC for Oracle}; </span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">_</span>
         <span class="punct">&quot;</span><span class="string">CONNECTSTRING=(DESCRIPTION=</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">_</span>
         <span class="punct">&quot;</span><span class="string">(ADDRESS=(PROTOCOL=TCP)</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">_</span>
         <span class="punct">&quot;</span><span class="string">(HOST=</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">strHost</span> <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string">)(PORT=1521))</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">_</span>
         <span class="punct">&quot;</span><span class="string">(CONNECT_DATA=(SERVICE_NAME=</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">strDatabase</span> <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string">))); uid=</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">strUser</span> <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string"> ;pwd=</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="ident">strPassword</span> <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string">;</span><span class="punct">&quot;</span>
  <span class="constant">Set</span> <span class="ident">oConOracle</span> <span class="punct">=</span> <span class="constant">CreateObject</span><span class="punct">(&quot;</span><span class="string">ADODB.Connection</span><span class="punct">&quot;)</span>
  <span class="constant">Set</span> <span class="ident">oRsOracle</span> <span class="punct">=</span> <span class="constant">CreateObject</span><span class="punct">(&quot;</span><span class="string">ADODB.Recordset</span><span class="punct">&quot;)</span>
  <span class="ident">oConOracle</span><span class="punct">.</span><span class="ident">Open</span> <span class="ident">strConOracle</span>
  <span class="constant">Set</span> <span class="ident">oRsOracle</span> <span class="punct">=</span> <span class="ident">oConOracle</span><span class="punct">.</span><span class="ident">Execute</span><span class="punct">(</span><span class="ident">strSQL</span><span class="punct">)</span>
  <span class="constant">Do</span> <span class="constant">While</span> <span class="constant">Not</span> <span class="ident">oRsOracle</span><span class="punct">.</span><span class="ident">EOF</span>
      <span class="ident">If</span> <span class="ident">StrResult</span> <span class="punct">&lt;&gt;</span> <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;</span> <span class="ident">Then</span>
        <span class="ident">StrResult</span> <span class="punct">=</span> <span class="ident">StrResult</span> <span class="punct">&amp;</span> <span class="ident">Chr</span><span class="punct">(</span><span class="number">10</span><span class="punct">)</span> <span class="punct">&amp;</span> <span class="ident">oRsOracle</span><span class="punct">.</span><span class="ident">Fields</span><span class="punct">(</span><span class="number">0</span><span class="punct">).</span><span class="ident">Value</span>
      <span class="ident">Else</span>
        <span class="ident">StrResult</span> <span class="punct">=</span> <span class="ident">oRsOracle</span><span class="punct">.</span><span class="ident">Fields</span><span class="punct">(</span><span class="number">0</span><span class="punct">).</span><span class="ident">Value</span>
      <span class="ident">End</span> <span class="ident">If</span>
    <span class="ident">oRsOracle</span><span class="punct">.</span><span class="ident">MoveNext</span>
  <span class="ident">Loop</span>
  <span class="ident">oConOracle</span><span class="punct">.</span><span class="ident">Close</span>
  <span class="ident">Set</span> <span class="ident">oRsOracle</span> <span class="punct">=</span> <span class="constant">Nothing</span>
  <span class="constant">Set</span> <span class="ident">oConOracle</span> <span class="punct">=</span> <span class="constant">Nothing</span>
  <span class="constant">ORAQUERY</span> <span class="punct">=</span> <span class="constant">StrResult</span>
<span class="constant">End</span> <span class="constant">Function</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/vba" class="tag ">vba</a> <a href="/tag/oracle" class="tag ">oracle</a> <a href="/tag/query" class="tag ">query</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (1256) --> by <a href="/user/bouffon69">bouffon69</a> on Sep 10, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post4503"></a>

<div id="post4503">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/4503">VBA procedure to pen an Excel workbook and refresh all datas in the QueryTables and PivotTable objects</a></h3>

		<div class="post-body">// description of your code here<br />// Can also use the Workbook Open event ( Private Sub Workbook_Open() )<br /><br /><pre>
<span class="constant">Sub</span> <span class="constant">Auto_Open</span><span class="punct">()</span>
<span class="constant">Application</span><span class="punct">.</span><span class="ident">DisplayAlerts</span> <span class="punct">=</span> <span class="ident">False</span>
    <span class="ident">ChDir</span> <span class="punct">&quot;</span><span class="string">T:<span class="escape">\E</span>XPLOIT<span class="escape">\T</span>SMENV<span class="escape">\E</span>XCEL<span class="escape">\p</span>olitiques</span><span class="punct">&quot;</span>
    <span class="ident">Workbooks</span><span class="punct">.</span><span class="ident">Open</span> <span class="ident">Filename</span><span class="punct">:=&quot;</span><span class="string">t:<span class="escape">\E</span>XPLOIT<span class="escape">\T</span>SMENV<span class="escape">\E</span>XCEL<span class="escape">\p</span>olitiques<span class="escape">\p</span>olitiques.xls</span><span class="punct">&quot;,</span> <span class="ident">_</span>
        <span class="constant">UpdateLinks</span><span class="punct">:=</span><span class="number">3</span>
    <span class="constant">For</span> <span class="ident">i</span> <span class="punct">=</span> <span class="number">1</span> <span class="constant">To</span> <span class="constant">ActiveWorkbook</span><span class="punct">.</span><span class="ident">PivotCaches</span><span class="punct">.</span><span class="ident">Count</span>
        <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">PivotCaches</span><span class="punct">(</span><span class="ident">i</span><span class="punct">).</span><span class="ident">RefreshOnFileOpen</span> <span class="punct">=</span> <span class="ident">False</span>
    <span class="ident">Next</span>
    <span class="ident">For</span> <span class="ident">i</span> <span class="punct">=</span> <span class="number">1</span> <span class="constant">To</span> <span class="constant">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">.</span><span class="ident">Count</span>
        <span class="ident">For</span> <span class="ident">j</span> <span class="punct">=</span> <span class="number">1</span> <span class="constant">To</span> <span class="constant">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">(</span><span class="ident">i</span><span class="punct">).</span><span class="ident">QueryTables</span><span class="punct">.</span><span class="ident">Count</span>
            <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">(</span><span class="ident">i</span><span class="punct">).</span><span class="ident">QueryTables</span><span class="punct">(</span><span class="ident">j</span><span class="punct">).</span><span class="ident">RefreshOnFileOpen</span> <span class="punct">=</span> <span class="ident">False</span>
        <span class="ident">Next</span>
    <span class="ident">Next</span>
    <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">RefreshAll</span>
    <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">RefreshAll</span>
    <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">RefreshAll</span>
    <span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Save</span>
    <span class="ident">ActiveWindow</span><span class="punct">.</span><span class="ident">Close</span>
    <span class="ident">Application</span><span class="punct">.</span><span class="ident">Quit</span>
<span class="ident">End</span> <span class="ident">Sub</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/vba" class="tag ">vba</a> <a href="/tag/excel" class="tag ">excel</a> <a href="/tag/refresh" class="tag ">refresh</a> <a href="/tag/QueryTables" class="tag ">QueryTables</a> <a href="/tag/PivotTable" class="tag ">PivotTable</a>  <!-- (1092) --> by <a href="/user/bouffon69">bouffon69</a> on Sep 07, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post4317"></a>

<div id="post4317">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/4317">Excel object</a></h3>

		<div class="post-body">// Excel object<br /><pre>
<span class="punct">/</span><span class="regex"></span><span class="punct">/</span> <span class="punct">'</span><span class="string">create object
Set excelobj = CreateObject( &quot;Excel.Application&quot;)
Set exp_data_workbook=excelobj.workbooks.open(&quot;c:\debug_expected.xls&quot;)


</span><span class="punct">'</span><span class="ident">get</span> <span class="ident">the</span> <span class="ident">sheet</span> <span class="ident">count</span>
<span class="ident">exp_sheetcnt</span><span class="punct">=</span><span class="ident">exp_data_workbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">.</span><span class="ident">Count</span>
	

<span class="punct">'</span><span class="string">select a sheet
For i = 1 to exp_sheetcnt
	sheet_tblname=exp_data_workbook.Sheets(i).Name
	If  UCASE(Trim(sheet_tblname)) = &quot;Sheet_name&quot; Then
		exp_data_workbook.Sheets(i).select

		</span><span class="punct">'</span><span class="ident">once</span> <span class="ident">selected</span> <span class="ident">set</span> <span class="ident">the</span> <span class="ident">range</span> <span class="ident">object</span>	
		<span class="ident">set</span> <span class="ident">exp_rangeobj</span><span class="punct">=</span><span class="ident">exp_data_workbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">(</span><span class="ident">i</span><span class="punct">).</span><span class="ident">UsedRange</span>
	<span class="ident">end</span> <span class="keyword">if</span>
<span class="keyword">next</span>


<span class="punct">'</span><span class="string">Get the column count for the 

columncnt=exp_rangeobj.columns.count

</span><span class="punct">'</span><span class="ident">find</span>  <span class="ident">the</span> <span class="ident">column</span> <span class="ident">index</span> <span class="ident">of</span>  <span class="ident">the</span> <span class="ident">column</span> <span class="ident">column_name</span>
		<span class="constant">For</span> <span class="ident">i</span><span class="punct">=</span><span class="number">1</span> <span class="ident">to</span> <span class="ident">columncnt</span>
			<span class="ident">colname</span><span class="punct">=</span><span class="ident">exp_rangeobj</span><span class="punct">.</span><span class="ident">cells</span><span class="punct">(</span><span class="number">1</span><span class="punct">,</span><span class="ident">i</span><span class="punct">).</span><span class="ident">value</span>
			<span class="constant">If</span> <span class="constant">UCASE</span><span class="punct">(</span><span class="constant">Trim</span><span class="punct">(</span><span class="ident">colname</span><span class="punct">))</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">column_name</span><span class="punct">&quot;</span> <span class="constant">Then</span>
				<span class="ident">pos_id_idx</span> <span class="punct">=</span> <span class="ident">i</span>
				<span class="constant">Exit</span> <span class="constant">For</span>
			<span class="constant">End</span> <span class="constant">If</span>
		<span class="constant">Next</span>		

<span class="punct">'</span><span class="string">proceess the value from that column

rowcnt=exp_rangeobj.rows.count

		</span><span class="punct">'</span><span class="constant">Strat</span> <span class="ident">reading</span> <span class="ident">the</span> <span class="ident">values</span> <span class="ident">from</span> <span class="ident">the</span> <span class="number">2</span><span class="ident">nd</span> <span class="ident">row</span> <span class="ident">since</span> <span class="ident">the</span> <span class="ident">first</span> <span class="ident">row</span> <span class="ident">contains</span> <span class="ident">the</span> <span class="ident">column</span> <span class="ident">names</span><span class="punct">.</span>
		<span class="ident">If</span> <span class="ident">rowcnt</span> <span class="punct">&gt;</span> <span class="number">1</span> <span class="constant">Then</span>
			<span class="constant">For</span> <span class="ident">i</span><span class="punct">=</span><span class="number">2</span> <span class="ident">to</span> <span class="ident">rowcnt</span>				 
				<span class="punct">'</span><span class="string">process the expected file row if it has a value
				If  Len(Trim(exp_rangeobj.cells(i,1).value))&gt;0 Then 
					posIndex = (exp_rangeobj.cells(i,pos_id_idx).value) -1
				end if
			next 
		end if
		</span></pre></div>

		<div class="post-metadata">to <a href="/tag/object" class="tag ">object</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (547) --> by <a href="/user/sarunbe">sarunbe</a> on Jul 18, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post4215"></a>

<div id="post4215">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/4215">Create an SQLite Database from an Excel Workbook with Ruby</a></h3>

		<div class="post-body">From the <a href="http://rubyonwindows.blogspot.com/">Ruby on Windows</a> blog.<br /><br />Here's a brief, unpolished snippet of code that reads data from an open Excel workbook and creates an SQLite database with a table for each worksheet in the Excel workbook:<br /><pre>
<span class="ident">require</span> <span class="punct">'</span><span class="string">win32ole</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">sqlite3</span><span class="punct">'</span>

<span class="comment">#   Connect to a running instance of Excel</span>
<span class="ident">xl</span> <span class="punct">=</span> <span class="constant">WIN32OLE</span><span class="punct">.</span><span class="ident">connect</span><span class="punct">('</span><span class="string">Excel.Application</span><span class="punct">')</span>
<span class="comment">#   Get the active workbook</span>
<span class="ident">wb</span> <span class="punct">=</span> <span class="ident">xl</span><span class="punct">.</span><span class="ident">ActiveWorkbook</span>
<span class="comment">#   Create the SQLite3 database</span>
<span class="ident">db</span> <span class="punct">=</span> <span class="constant">SQLite3</span><span class="punct">::</span><span class="constant">Database</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">excel.db</span><span class="punct">')</span>
<span class="comment">#   Create a database table for each worksheet </span>
<span class="comment">#   in the workbook</span>
<span class="ident">wb</span><span class="punct">.</span><span class="ident">Worksheets</span><span class="punct">.</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">ws</span><span class="punct">|</span>
    <span class="comment">#   Grab all values from worksheet into a </span>
    <span class="comment">#   2-dimensional array</span>
    <span class="ident">data</span> <span class="punct">=</span> <span class="ident">ws</span><span class="punct">.</span><span class="ident">UsedRange</span><span class="punct">.</span><span class="ident">Value</span>
    <span class="comment">#   Grab first row of data to use as field names</span>
    <span class="ident">field_names</span> <span class="punct">=</span> <span class="ident">data</span><span class="punct">.</span><span class="ident">shift</span>
    <span class="comment">#   Create database table using worksheet name and </span>
    <span class="comment">#   field names</span>
    <span class="ident">db</span><span class="punct">.</span><span class="ident">execute</span><span class="punct">(&quot;</span><span class="string">CREATE TABLE [<span class="expr">#{ws.Name}</span>] <span class="escape">\
</span>        ( <span class="expr">#{field_names.join(',')}</span> );</span><span class="punct">&quot;)</span>
    <span class="comment">#   For each row of data...</span>
    <span class="ident">data</span><span class="punct">.</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">row</span><span class="punct">|</span>
        <span class="comment">#   ...single-quote all field values...</span>
        <span class="ident">row</span><span class="punct">.</span><span class="ident">collect!</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">f</span><span class="punct">|</span> <span class="ident">f</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">'</span><span class="punct">&quot;</span> <span class="punct">+</span> <span class="ident">f</span><span class="punct">.</span><span class="ident">to_s</span> <span class="punct">+</span> <span class="punct">&quot;</span><span class="string">'</span><span class="punct">&quot;</span> <span class="punct">}</span>
        <span class="comment">#   ...and insert a new record into the </span>
        <span class="comment">#   database table</span>
        <span class="ident">db</span><span class="punct">.</span><span class="ident">execute</span><span class="punct">(&quot;</span><span class="string">INSERT INTO [<span class="expr">#{ws.Name}</span>] VALUES <span class="escape">\
</span>            ( <span class="expr">#{row.join(',')}</span> );</span><span class="punct">&quot;)</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><br />Further discussion can be found <a href="http://rubyonwindows.blogspot.com/2007/03/ruby-excel-and-sqlite-instead-of-ms.html">here</a>.<br /><br /></div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/sqlite" class="tag ">sqlite</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (1515) --> by <a href="/user/dmullet">dmullet</a> on Jun 27, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post3613"></a>

<div id="post3613">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/3613">Detect a field edit in Excel and refresh a Query</a></h3>

		<div class="post-body"><pre>
<span class="constant">Private</span> <span class="constant">Sub</span> <span class="constant">Worksheet_Change</span><span class="punct">(</span><span class="constant">ByVal</span> <span class="constant">Target</span> <span class="constant">As</span> <span class="constant">Range</span><span class="punct">)</span>
    <span class="constant">Dim</span> <span class="ident">wks</span> <span class="constant">As</span> <span class="constant">Worksheet</span>
    <span class="constant">Set</span> <span class="ident">wks</span> <span class="punct">=</span> <span class="constant">ActiveSheet</span>

    <span class="constant">If</span> <span class="constant">Target</span><span class="punct">.</span><span class="ident">Row</span> <span class="punct">=</span> <span class="number">1</span> <span class="ident">And</span> <span class="ident">Target</span><span class="punct">.</span><span class="ident">Column</span> <span class="punct">=</span> <span class="number">1</span> <span class="ident">Then</span>
      <span class="ident">wks</span><span class="punct">.</span><span class="ident">QueryTables</span><span class="punct">(</span><span class="number">1</span><span class="punct">).</span><span class="ident">Refresh</span>
    <span class="ident">End</span> <span class="ident">If</span>

    <span class="ident">Set</span> <span class="ident">wks</span> <span class="punct">=</span> <span class="constant">Nothing</span>
<span class="constant">End</span> <span class="constant">Sub</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/vba" class="tag ">vba</a> <a href="/tag/query" class="tag ">query</a> <a href="/tag/access" class="tag ">access</a> <a href="/tag/excel" class="tag ">excel</a> <a href="/tag/worksheet" class="tag ">worksheet</a>  <!-- (1912) --> by <a href="/user/davetrane">davetrane</a> on Mar 01, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post3610"></a>

<div id="post3610">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/3610">Script Excel in Ruby</a></h3>

		<div class="post-body"><pre>
<span class="ident">require</span> <span class="punct">'</span><span class="string">win32ole</span><span class="punct">'</span>
<span class="ident">excel</span> <span class="punct">=</span> <span class="constant">WIN32OLE</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">excel.application</span><span class="punct">')</span>
<span class="ident">excel</span><span class="punct">.</span><span class="ident">visible</span> <span class="punct">=</span> <span class="constant">true</span>
<span class="ident">excel</span><span class="punct">.</span><span class="ident">workbooks</span><span class="punct">.</span><span class="ident">open</span><span class="punct">(</span><span class="ident">file_path</span><span class="punct">)</span> <span class="comment"># absolute file path</span>
<span class="ident">excel</span><span class="punct">.</span><span class="ident">range</span><span class="punct">('</span><span class="string">A1</span><span class="punct">').</span><span class="ident">value</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">Hello, world.</span><span class="punct">'</span> <span class="comment"># get/set value</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (3150) --> by <a href="/user/timmorgan">timmorgan</a> on Mar 01, 2007 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post3112"></a>

<div id="post3112">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/3112">VBA DDE WORD EXCEL</a></h3>

		<div class="post-body">// This is just sample code of some dde commands<br /><br /><pre>
<span class="constant">Sub</span> <span class="constant">RUNEXCELMACRO</span><span class="punct">()</span>
<span class="punct">'</span><span class="string">RUN MACRO
aChan = DDEInitiate(App:=&quot;Excel&quot;, Topic:=&quot;System&quot;)
DDEExecute Channel:=aChan, Command:=&quot;[Run(&quot; &amp; Chr(34) &amp; _
    &quot;Personal.xls!Macro1&quot; &amp; Chr(34) &amp; &quot;)]&quot;
DDETerminate Channel:=aChan
</span><span class="punct">'</span><span class="constant">POKE</span>
<span class="constant">Chan</span> <span class="punct">=</span> <span class="constant">DDEInitiate</span><span class="punct">(</span><span class="constant">App</span><span class="punct">:=&quot;</span><span class="string">Excel</span><span class="punct">&quot;,</span> <span class="constant">Topic</span><span class="punct">:=&quot;</span><span class="string">System</span><span class="punct">&quot;)</span>
<span class="constant">DDEExecute</span> <span class="constant">Channel</span><span class="punct">:=</span><span class="constant">Chan</span><span class="punct">,</span> <span class="constant">Command</span><span class="punct">:=&quot;</span><span class="string">[OPEN(</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="constant">Chr</span><span class="punct">(</span><span class="number">34</span><span class="punct">)</span> <span class="ident">_</span>
    <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string">C:<span class="escape">\S</span>ales.xls</span><span class="punct">&quot;</span> <span class="punct">&amp;</span> <span class="constant">Chr</span><span class="punct">(</span><span class="number">34</span><span class="punct">)</span> <span class="punct">&amp;</span> <span class="punct">&quot;</span><span class="string">)]</span><span class="punct">&quot;</span>
<span class="constant">DDETerminate</span> <span class="constant">Channel</span><span class="punct">:=</span><span class="constant">Chan</span>
<span class="constant">Chan</span> <span class="punct">=</span> <span class="constant">DDEInitiate</span><span class="punct">(</span><span class="constant">App</span><span class="punct">:=&quot;</span><span class="string">Excel</span><span class="punct">&quot;,</span> <span class="constant">Topic</span><span class="punct">:=&quot;</span><span class="string">Sales.xls</span><span class="punct">&quot;)</span>
<span class="constant">DDEPoke</span> <span class="constant">Channel</span><span class="punct">:=</span><span class="constant">Chan</span><span class="punct">,</span> <span class="constant">Item</span><span class="punct">:=&quot;</span><span class="string">R1C1</span><span class="punct">&quot;,</span> <span class="constant">Data</span><span class="punct">:=&quot;</span><span class="string">1996 Sales</span><span class="punct">&quot;</span>
<span class="constant">DDETerminate</span> <span class="constant">Channel</span><span class="punct">:=</span><span class="constant">Chan</span>
<span class="punct">'</span><span class="string">This example opens the Microsoft Excel workbook Book1.xls and retrieves the contents of cell R1C1.
Chan = DDEInitiate(App:=&quot;Excel&quot;, Topic:=&quot;System&quot;)
DDEExecute Channel:=Chan, Command:=&quot;[OPEN(&quot; &amp; Chr(34) _
    &amp; &quot;C:\My Documents\Book1.xls&quot; &amp; Chr(34) &amp; &quot;)]&quot;
DDETerminate Channel:=Chan
Chan = DDEInitiate(App:=&quot;Excel&quot;, Topic:=&quot;C:\DATA\SBS.xls&quot;)
msg = DDERequest(Channel:=Chan, Item:=&quot;R2C1&quot;)
msg = msg &amp; &quot; &quot; &amp; DDERequest(Channel:=Chan, Item:=&quot;R2C2&quot;)
MsgBox msg
DDETerminateAll
</span><span class="punct">'</span><span class="constant">This</span> <span class="ident">example</span> <span class="ident">opens</span> <span class="ident">a</span> <span class="ident">channel</span> <span class="ident">to</span> <span class="ident">the</span> <span class="constant">System</span> <span class="ident">topic</span> <span class="keyword">in</span> <span class="constant">Microsoft</span> <span class="constant">Excel</span> <span class="keyword">and</span> <span class="keyword">then</span> <span class="ident">uses</span> <span class="ident">the</span> <span class="constant">Topics</span> <span class="ident">item</span> <span class="ident">to</span> <span class="keyword">return</span> <span class="ident">a</span> <span class="ident">list</span> <span class="ident">of</span> <span class="ident">available</span> <span class="ident">topics</span><span class="punct">.</span> <span class="ident">The</span> <span class="ident">example</span> <span class="ident">inserts</span> <span class="ident">the</span> <span class="ident">topic</span> <span class="ident">list</span><span class="punct">,</span> <span class="ident">which</span> <span class="ident">includes</span> <span class="ident">all</span> <span class="ident">open</span> <span class="ident">workbooks</span><span class="punct">,</span> <span class="ident">after</span> <span class="ident">the</span> <span class="ident">selection</span><span class="punct">.</span>
<span class="ident">aChan</span> <span class="punct">=</span> <span class="constant">DDEInitiate</span><span class="punct">(</span><span class="constant">App</span><span class="punct">:=&quot;</span><span class="string">Excel</span><span class="punct">&quot;,</span> <span class="constant">Topic</span><span class="punct">:=&quot;</span><span class="string">System</span><span class="punct">&quot;)</span>
<span class="constant">TOPICLIST</span> <span class="punct">=</span> <span class="constant">DDERequest</span><span class="punct">(</span><span class="constant">Channel</span><span class="punct">:=</span><span class="ident">aChan</span><span class="punct">,</span> <span class="constant">Item</span><span class="punct">:=&quot;</span><span class="string">Topics</span><span class="punct">&quot;)</span>
<span class="constant">Selection</span><span class="punct">.</span><span class="ident">InsertAfter</span> <span class="ident">TOPICLIST</span>
<span class="ident">DDETerminate</span> <span class="ident">Channel</span><span class="punct">:=</span><span class="ident">aChan</span>

<span class="constant">End</span> <span class="constant">Sub</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/word" class="tag ">word</a> <a href="/tag/vba" class="tag ">vba</a> <a href="/tag/excel" class="tag ">excel</a> <a href="/tag/DDE" class="tag ">DDE</a>  <!-- (3375) --> by <a href="/user/millerjohneric">millerjohneric</a> on Dec 08, 2006 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post2036"></a>

<div id="post2036">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/2036">Script Excel from Python</a></h3>

		<div class="post-body">A quick and dirty class for working with Excel via COM in Python. By far, not all of the power of Excel is available here, but it's a good start for simple tasks.<br /><br /><pre>
<span class="ident">from</span> <span class="ident">win32com</span><span class="punct">.</span><span class="ident">client</span> <span class="ident">import</span> <span class="ident">constants</span><span class="punct">,</span> <span class="constant">Dispatch</span>
<span class="ident">import</span> <span class="ident">pythoncom</span>
<span class="ident">import</span> <span class="ident">os</span>

<span class="ident">borderTop</span> <span class="punct">=</span> <span class="number">3</span>
<span class="ident">borderBottom</span> <span class="punct">=</span> <span class="number">4</span>
<span class="ident">borderLeft</span> <span class="punct">=</span> <span class="number">1</span>
<span class="ident">borderRight</span> <span class="punct">=</span> <span class="number">2</span>
<span class="ident">borderSolid</span> <span class="punct">=</span> <span class="number">1</span>
<span class="ident">borderDashed</span> <span class="punct">=</span> <span class="number">2</span>
<span class="ident">borderDotted</span> <span class="punct">=</span> <span class="number">3</span>
<span class="ident">colorBlack</span> <span class="punct">=</span> <span class="number">1</span>
<span class="ident">directionUp</span> <span class="punct">=</span> <span class="punct">-</span><span class="number">4162</span>
<span class="ident">directionDown</span> <span class="punct">=</span> <span class="punct">-</span><span class="number">4121</span>
<span class="ident">directionLeft</span> <span class="punct">=</span> <span class="punct">-</span><span class="number">4131</span>
<span class="ident">directionRight</span> <span class="punct">=</span> <span class="punct">-</span><span class="number">4152</span>

<span class="keyword">class </span><span class="class">ExcelDocument(object):</span>
  <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
  Some convenience methods for Excel documents accessed
  through COM.
  </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
  
  <span class="keyword">def </span><span class="method">__init__</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">visible</span><span class="punct">=</span><span class="constant">False</span><span class="punct">):</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span> <span class="punct">=</span> <span class="constant">Dispatch</span><span class="punct">(&quot;</span><span class="string">Excel.Application</span><span class="punct">&quot;)</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">Visible</span> <span class="punct">=</span> <span class="ident">visible</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">sheet</span> <span class="punct">=</span> <span class="number">1</span>
  
  <span class="keyword">def </span><span class="method">new</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">filename</span><span class="punct">=</span><span class="constant">None</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Create a new Excel workbook. If 'filename' specified,
    use the file as a template.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">Workbooks</span><span class="punct">.</span><span class="ident">Add</span><span class="punct">(</span><span class="ident">filename</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">open</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">filename</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Open an existing Excel workbook for editing.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">Workbooks</span><span class="punct">.</span><span class="ident">Open</span><span class="punct">(</span><span class="ident">filename</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">set_sheet</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">sheet</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Set the active worksheet.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">sheet</span> <span class="punct">=</span> <span class="ident">sheet</span>
  
  <span class="keyword">def </span><span class="method">get_range</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">range</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Get a range object for the specified range or single cell.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="keyword">return</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Sheets</span><span class="punct">(</span><span class="ident">self</span><span class="punct">.</span><span class="ident">sheet</span><span class="punct">).</span><span class="ident">Range</span><span class="punct">(</span><span class="ident">range</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">set_value</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">cell</span><span class="punct">,</span> <span class="ident">value</span><span class="punct">='</span><span class="string"></span><span class="punct">'):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Set the value of 'cell' to 'value'.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">(</span><span class="ident">cell</span><span class="punct">).</span><span class="ident">Value</span> <span class="punct">=</span> <span class="ident">value</span>
  
  <span class="keyword">def </span><span class="method">get_value</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">cell</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Get the value of 'cell'.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="ident">value</span> <span class="punct">=</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">(</span><span class="ident">cell</span><span class="punct">).</span><span class="ident">Value</span>
    <span class="ident">if</span> <span class="ident">isinstance</span><span class="punct">(</span><span class="ident">value</span><span class="punct">,</span> <span class="ident">tuple</span><span class="punct">):</span>
      <span class="ident">value</span> <span class="punct">=</span> <span class="punct">[</span><span class="ident">v</span><span class="punct">[</span><span class="number">0</span><span class="punct">]</span> <span class="keyword">for</span> <span class="ident">v</span> <span class="keyword">in</span> <span class="ident">value</span><span class="punct">]</span>
    <span class="keyword">return</span> <span class="ident">value</span>
  
  <span class="keyword">def </span><span class="method">set_border</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">range</span><span class="punct">,</span> <span class="ident">side</span><span class="punct">,</span> <span class="ident">line_style</span><span class="punct">=</span><span class="ident">borderSolid</span><span class="punct">,</span> <span class="ident">color</span><span class="punct">=</span><span class="ident">colorBlack</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Set a border on the specified range of cells or single cell.
    'range' = range of cells or single cell
    'side' = one of borderTop, borderBottom, borderLeft, borderRight
    'line_style' = one of borderSolid, borderDashed, borderDotted, others?
    'color' = one of colorBlack, others?
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="ident">range</span> <span class="punct">=</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">(</span><span class="ident">range</span><span class="punct">).</span><span class="ident">Borders</span><span class="punct">(</span><span class="ident">side</span><span class="punct">)</span>
    <span class="ident">range</span><span class="punct">.</span><span class="ident">LineStyle</span> <span class="punct">=</span> <span class="ident">line_style</span>
    <span class="ident">range</span><span class="punct">.</span><span class="ident">Color</span> <span class="punct">=</span> <span class="ident">color</span>
  
  <span class="keyword">def </span><span class="method">sort</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">range</span><span class="punct">,</span> <span class="ident">key_cell</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Sort the specified 'range' of the activeworksheet by the
    specified 'key_cell'.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="ident">range</span><span class="punct">.</span><span class="ident">Sort</span><span class="punct">(</span><span class="ident">Key1</span><span class="punct">=</span><span class="ident">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">(</span><span class="ident">key_cell</span><span class="punct">),</span> <span class="constant">Order1</span><span class="punct">=</span><span class="number">1</span><span class="punct">,</span> <span class="constant">Header</span><span class="punct">=</span><span class="number">0</span><span class="punct">,</span> <span class="constant">OrderCustom</span><span class="punct">=</span><span class="number">1</span><span class="punct">,</span> <span class="constant">MatchCase</span><span class="punct">=</span><span class="constant">False</span><span class="punct">,</span> <span class="constant">Orientation</span><span class="punct">=</span><span class="number">1</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">hide_row</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">row</span><span class="punct">,</span> <span class="ident">hide</span><span class="punct">=</span><span class="constant">True</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Hide the specified 'row'.
    Specify hide=False to show the row.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">('</span><span class="string">a%s</span><span class="punct">'</span> <span class="punct">%</span> <span class="ident">row</span><span class="punct">).</span><span class="ident">EntireRow</span><span class="punct">.</span><span class="ident">Hidden</span> <span class="punct">=</span> <span class="ident">hide</span>
  
  <span class="keyword">def </span><span class="method">hide_column</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">column</span><span class="punct">,</span> <span class="ident">hide</span><span class="punct">=</span><span class="constant">True</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Hide the specified 'column'.
    Specify hide=False to show the column.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">('</span><span class="string">%s1</span><span class="punct">'</span> <span class="punct">%</span> <span class="ident">column</span><span class="punct">).</span><span class="ident">EntireColumn</span><span class="punct">.</span><span class="ident">Hidden</span> <span class="punct">=</span> <span class="ident">hide</span>
  
  <span class="keyword">def </span><span class="method">delete_row</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">row</span><span class="punct">,</span> <span class="ident">shift</span><span class="punct">=</span><span class="ident">directionUp</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Delete the entire 'row'.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">('</span><span class="string">a%s</span><span class="punct">'</span> <span class="punct">%</span> <span class="ident">row</span><span class="punct">).</span><span class="ident">EntireRow</span><span class="punct">.</span><span class="ident">Delete</span><span class="punct">(</span><span class="ident">Shift</span><span class="punct">=</span><span class="ident">shift</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">delete_column</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">column</span><span class="punct">,</span> <span class="ident">shift</span><span class="punct">=</span><span class="ident">directionLeft</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Delete the entire 'column'.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">('</span><span class="string">%s1</span><span class="punct">'</span> <span class="punct">%</span> <span class="ident">column</span><span class="punct">).</span><span class="ident">EntireColumn</span><span class="punct">.</span><span class="ident">Delete</span><span class="punct">(</span><span class="ident">Shift</span><span class="punct">=</span><span class="ident">shift</span><span class="punct">)</span>
    
  <span class="keyword">def </span><span class="method">fit_column</span><span class="punct">(</span><span class="constant">self</span><span class="punct">,</span> <span class="ident">column</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Resize the specified 'column' to fit all its contents.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">get_range</span><span class="punct">('</span><span class="string">%s1</span><span class="punct">'</span> <span class="punct">%</span> <span class="ident">column</span><span class="punct">).</span><span class="ident">EntireColumn</span><span class="punct">.</span><span class="ident">AutoFit</span><span class="punct">()</span>
  
  <span class="keyword">def </span><span class="method">save</span><span class="punct">(</span><span class="ident">self</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Save the active workbook.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Save</span><span class="punct">()</span>
  
  <span class="keyword">def </span><span class="method">save_as</span><span class="punct">(</span><span class="ident">self</span><span class="punct">,</span> <span class="ident">filename</span><span class="punct">,</span> <span class="ident">delete_existing</span><span class="punct">=</span><span class="constant">False</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Save the active workbook as a different filename.
    If 'delete_existing' is specified and the file already
    exists, it will be deleted before saving.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="keyword">if</span> <span class="ident">delete_existing</span> <span class="keyword">and</span> <span class="ident">os</span><span class="punct">.</span><span class="ident">path</span><span class="punct">.</span><span class="ident">exists</span><span class="punct">(</span><span class="ident">filename</span><span class="punct">):</span>
      <span class="ident">os</span><span class="punct">.</span><span class="ident">remove</span><span class="punct">(</span><span class="ident">filename</span><span class="punct">)</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">SaveAs</span><span class="punct">(</span><span class="ident">filename</span><span class="punct">)</span>
  
  <span class="keyword">def </span><span class="method">print_out</span><span class="punct">(</span><span class="constant">self</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Print the active workbook.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">Application</span><span class="punct">.</span><span class="ident">PrintOut</span><span class="punct">()</span>
  
  <span class="keyword">def </span><span class="method">close</span><span class="punct">(</span><span class="ident">self</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Close the active workbook.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">ActiveWorkbook</span><span class="punct">.</span><span class="ident">Close</span><span class="punct">()</span>
  
  <span class="keyword">def </span><span class="method">quit</span><span class="punct">(</span><span class="ident">self</span><span class="punct">):</span>
    <span class="punct">&quot;</span><span class="string"></span><span class="punct">&quot;&quot;</span><span class="string">
    Quit Excel.
    </span><span class="punct">&quot;&quot;</span><span class="string"></span><span class="punct">&quot;</span>
    <span class="keyword">return</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">app</span><span class="punct">.</span><span class="ident">Quit</span><span class="punct">()</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/python" class="tag ">python</a> <a href="/tag/com" class="tag ">com</a> <a href="/tag/excel" class="tag ">excel</a>  <!-- (13014) --> by <a href="/user/timmorgan">timmorgan</a> on May 15, 2006 <b></b>
	
	
		</div>
  </div>
</div>

	
</div>

<div class="box grey paginator" style="text-align: center; color: #fff"><div style="float: left">
    <span class="disabled">&laquo; Newer Snippets</span></div><div style="float: right"><span class="disabled">Older Snippets &raquo;</span></div>Showing 1-9 of 9 total <a title="RSS 2.0" href="/rss/tag/excel"><span style="border:1px solid;border-color:#FC9 #630 #330 #F96;padding:1px 4px;font:bold 11px verdana,sans-serif;color:#FFF;background:#F60;text-decoration:none;margin:0px">&nbsp;RSS&nbsp;</span></a><br />
<div style="margin-top: 8px; "><form action="#"><select style="width: 250px" onchange="JumpToIt(this)">
 
 <option value="#post4675">Excel VBA : read registry key values on a remote computer using WMI</option>
 
 <option value="#post4518">Excel : Make a query on a Oracle database and return the result (useful for sheet formulas)</option>
 
 <option value="#post4503">VBA procedure to pen an Excel workbook and refresh all datas in the QueryTables and PivotTable objects</option>
 
 <option value="#post4317">Excel object</option>
 
 <option value="#post4215">Create an SQLite Database from an Excel Workbook with Ruby</option>
 
 <option value="#post3613">Detect a field edit in Excel and refresh a Query</option>
 
 <option value="#post3610">Script Excel in Ruby</option>
 
 <option value="#post3112">VBA DDE WORD EXCEL</option>
 
 <option value="#post2036">Script Excel from Python</option>
 
 </select></form>
     </div>

</div>




</div>

 	    <br style="clear: both" />

<div id="footer">
		<p>Snippets originally developed by <a href="http://www.petercooper.co.uk/">Peter Cooper</a> and powered by <a href="http://www.rubyonrails.com/">Ruby On Rails</a>.</p>
        <p>Copyright &copy; 2007 <a href="http://www.dzone.com">DZone, Inc.</a></p>
    <!-- Site Meter -->
	<script type="text/javascript" src="http://sm2.sitemeter.com/js/counter.js?site=sm2snippets">
	</script>
	<noscript>
	<a href="http://sm2.sitemeter.com/stats.asp?site=sm2snippets" target="_top">
	<img src="http://sm2.sitemeter.com/meter.asp?site=sm2snippets" alt="Site Meter" border="0"/></a>
	</noscript>
	<!-- Copyright (c)2006 Site Meter -->
</div>

    </div>
				<script src="/javascripts/prototype.js?1178022196" type="text/javascript"></script>
		<script src="/javascripts/effects.js?1178022196" type="text/javascript"></script>
		<script src="/javascripts/dragdrop.js?1178022196" type="text/javascript"></script>
		<script src="/javascripts/controls.js?1178022196" type="text/javascript"></script>
		<script src="/javascripts/general.js?1178022196" type="text/javascript"></script>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-410289-8";
urchinTracker();
</script>
    <!-- Start Quantcast tag -->
    <script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
    <script type="text/javascript">
    _qacct="p-ebK_XdQH1HeLo";quantserve();</script>
    <noscript>
    <img src="http://pixel.quantserve.com/pixel/p-ebK_XdQH1HeLo.gif" style="display: none" height="1" width="1" alt="Quantcast"/></noscript>
    <!-- End Quantcast tag -->
<!-- Piwik -->
 <script language="javascript" src="http://analytics.dzone.com/piwik.js" type="text/javascript"></script>
  <script type="text/javascript">
  <!--
  piwik_action_name = '';
  piwik_idsite = 2;
  piwik_url = 'http://analytics.dzone.com/piwik.php';
  piwik_log(piwik_action_name, piwik_idsite, piwik_url);
 //-->
  </script><object>
  <noscript><p>Web stats <img src="http://analytics.dzone.com/piwik.php" style="border:0" alt="piwik"/></p>
 </noscript></object></a>
 <!-- /Piwik -->
</body>
</html>

<script language="JavaScript">
<!--

var SymRealOnLoad;
var SymRealOnUnload;
function SymOnUnload()
{
  window.open = SymWinOpen;
  if(SymRealOnUnload != null)
     SymRealOnUnload();
}

function SymOnLoad()
{
  if(SymRealOnLoad != null)
     SymRealOnLoad();
  window.open = SymRealWinOpen;
  if (SymRealOnUnload == null)
  {
     SymRealOnUnload = window.onunload;
     window.onunload = SymOnUnload;
  }
}

function SymInitWinOnload()
{
  if ( SymRealOnLoad == null )
     SymRealOnLoad = window.onload;
   return SymOnLoad;
}

window.onload = SymInitWinOnload();

//-->
</script>

