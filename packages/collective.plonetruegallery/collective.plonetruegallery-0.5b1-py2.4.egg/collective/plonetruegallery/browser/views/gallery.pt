<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="optilux.cinemacontent">

<metal:js fill-slot="javascript_head_slot">
<tal:comment replace="nothing"> Here begins javascript that isn't added if user isn't logged in... By default KSS isn't for anonymous users</tal:comment>
	<script type="text/javascript" 
			tal:attributes="src string:sarissa.js"
			tal:condition="python: here.restrictedTraverse('@@plone_portal_state').anonymous()">
	</script>
	<script type="text/javascript" 
			tal:attributes="src string:${context/++resource++kukit.js}" 
			tal:condition="python: here.restrictedTraverse('@@plone_portal_state').anonymous() and here.restrictedTraverse('@@kss_devel_mode').isoff()">
	</script>
	<script type="text/javascript" 
			tal:attributes="src string:${context/++resource++kukit-devel.js}" 
			tal:condition="python: here.restrictedTraverse('@@plone_portal_state').anonymous() and here.restrictedTraverse('@@kss_devel_mode').ison()">
	</script>
<tal:comment replace="nothing"> End of adding javascript if user isn't logged in... </tal:comment>


	<script type="text/javascript" 
		tal:attributes="src string:${context/++resource++plonetruegallery.resources}/scripts/jquery.jcarousel.js" >
	</script>
	<script type="text/javascript" 
		tal:attributes="src string:${context/++resource++plonetruegallery.resources}/scripts/true-gallery.js" >
	</script>
	<script type="text/javascript" 
	        tal:condition="python: not context.containsSubGalleries()" 
	        tal:content="context/generateJavascript">
    </script>
</metal:js>
<metal:css fill-slot="css_slot">
	<link 	rel="stylesheet" 
		tal:attributes="href string:${context/++resource++plonetruegallery.resources}/css/jquery.jcarousel.css" 	
		media="screen" 
		charset="utf-8" />
	<link 	rel="stylesheet" 
		tal:attributes="href string:${context/++resource++plonetruegallery.resources}/css/truegallery.carousel.css" 	
		media="screen" 
		charset="utf-8" />
	<link 	rel="stylesheet" 
		tal:attributes="href string:${context/++resource++plonetruegallery.resources}/css/truegallery.css" 	
		media="screen" 
		charset="utf-8" />
	<style tal:content="context/generateCSS" tal:condition="python: not context.containsSubGalleries()"/>
</metal:css>
<body>
<metal:main fill-slot="main">
<tal:defs tal:define="images view/firstpage">
    <tal:main-macro metal:define-macro="main">
		<div id="plone-true-gallery"
		     tal:define="image_width context/getWidth;
		                 image_height context/getHeight;
		                 thumbnail_width context/getThumbnailWidth;
		                 thumbnail_height context/getThumbnailHeight;"
		     tal:condition="python: len(images) > 0"
		     tal:attributes="class string:kssattr-imagePage-1">
			<!--
				controllable event so I can choose when to load more images
			-->
			<input id="loadMoreImages" type="button" value="nothing" style="display:none"/>
	        <ul class="carousel jcarousel-skin-truegallery">
	        	<tal:thumbs tal:repeat="image images">
					<li>
					    <img tal:attributes="src image/thumb_url; 
											 width thumbnail_width; 
											 height thumbnail_height;
											 class string:kssattr-index-${repeat/image/index}"/>
					</li>
				</tal:thumbs>
	        </ul>
	        <div class="view">
				<div id="media-guide">
					<ul>
						<li class="first"></li>
						<li class="prev"></li>
						<li class="pause"></li>
						<li class="play"></li>
						<li class="next"></li>
						<li class="last"></li>
					</ul>
				</div>
				
				<tal:first tal:define="image python: images[0]">
					<div tal:attributes="class string:image selected kssattr-link-${image/link} kssattr-index-0">
						<img tal:attributes="src image/image_url" />
						<h2 tal:content="image/title" />
						<p tal:content="image/description" />
					</div>
				</tal:first>
				
				<tal:images tal:repeat="image python: view.firstpage()[1:]">
					<div tal:attributes="class string:image kssattr-link-${image/link} kssattr-index-${repeat/image/number}">
						<img tal:attributes="src image/image_url" />
						<h2 tal:content="image/title" />
						<p tal:content="image/description" />
					</div>
				</tal:images>
	        </div>
			<div class="info">
				<h2></h2>
				<p></p>
				<a target="_blank">click here to view full sized image</a>
			</div>
		</div>
		<div tal:condition="python: len(images) == 0 and not context.containsSubGalleries()">
		    <p>There are no images in this gallery.</p>
		</div>
		<div class="plone-true-gallery-subgalleries" tal:condition="python: context.containsSubGalleries()">
		    <dl>
		    <tal:galleries tal:repeat="gallery context/galleries">
		        <a tal:attributes="href gallery/absolute_url"><dt tal:content="gallery/Title" /></a>
		        <dd tal:content="gallery/Description" />
		    </tal:galleries>
		</div>
    </tal:main-macro>
</tal:defs>
</metal:main>
</body>
</html>

