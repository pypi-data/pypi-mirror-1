<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.3.10: http://docutils.sourceforge.net/" />
<title>freeform: natural interpretation of loosely structured user phrases</title>
<meta name="author" content="Robin Bryce" />
<meta name="copyright" content="Copyright (c) 2006 Wiretooth Ltd. This program is dual-licensed  free software; you can redistribute it and/or modify it under the terms of  the MIT License, or the  Academic Free License v3.0" />
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-09-25 17:49:54 +0200 (Sun, 25 Sep 2005) $
:Revision: $Revision: 3901 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* "! important" is used here to override other ``margin-top`` and
   ``margin-bottom`` styles that are later in the stylesheet or 
   more specific.  See http://www.w3.org/TR/CSS1#the-cascade */
.first {
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

img.borderless {
  border: 0 }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.line-block {
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid thin gray }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid thin black }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="freeform-natural-interpretation-of-loosely-structured-user-phrases">
<h1 class="title">freeform: natural interpretation of loosely structured user phrases</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">Download:</th><td class="field-body"><a class="reference" href="./freeform-0.3.tar.gz">freeform-0.3.tar.gz</a>, <a class="reference" href="./freeform-0.2-1.tar.gz">freeform-0.2-1.tar.gz</a></td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>Robin Bryce</td></tr>
<tr class="field"><th class="docinfo-name">Requires:</th><td class="field-body">python2.4, setuptools is optional</td>
</tr>
<tr><th class="docinfo-name">Copyright:</th>
<td>Copyright (c) 2006 Wiretooth Ltd. This program is dual-licensed 
free software; you can redistribute it and/or modify it under the terms of 
the <a class="reference" href="http://www.opensource.org/licenses/mit-license.php">MIT License</a>, or the  <a class="last reference" href="http://www.opensource.org/licenses/afl-3.0.php">Academic Free License v3.0</a></td></tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Version:</th><td class="field-body">0.3</td>
</tr>
<tr class="field"><th class="field-name">Abstract:</th><td class="field-body">freeform makes it easy to correctly interpret loosely structured
user text input without imposing any syntax requirements on the end user.
This is particularly usefull for providing text based interfaces over
mediums like SMS or instant messaging.</td>
</tr>
</tbody>
</table>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="highlights" name="highlights">highlights</a></h1>
<blockquote>
<ul class="simple">
<li>recognises user input without imposing any syntax requirements on the end 
user.</li>
<li>Corrects finger trouble in a reliable way. (Levenstein edit distance).</li>
<li>Simple, intuitive, and OPTIONAL definition syntax and compiler tool.</li>
<li>Multiple equivalent forms of a phrase can be resolved to a single <cite>command</cite> 
identifier.</li>
<li>Refuses to guess if there are multiple interpretations. Instead it provides
the remaining candidates and the current match data allowing you to chose
based on the specifics of your application domain.</li>
<li>pure python implementation. (pyrex accelerations planned)</li>
<li>no complex external dependencies.</li>
<li>EFFICIENT matching algorithm.</li>
</ul>
</blockquote>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#highlights" id="id1" name="id1">highlights</a></li>
<li><a class="reference" href="#overview" id="id2" name="id2">overview</a></li>
<li><a class="reference" href="#examples" id="id3" name="id3">examples</a></li>
<li><a class="reference" href="#warts" id="id4" name="id4">warts</a></li>
<li><a class="reference" href="#freeformc" id="id5" name="id5">freeformc</a></li>
<li><a class="reference" href="#freeform-match" id="id6" name="id6">freeform.match</a></li>
<li><a class="reference" href="#freeform-formtable" id="id7" name="id7">freeform.formtable</a><ul>
<li><a class="reference" href="#syntax-summary-for-the-compiler" id="id8" name="id8">syntax summary for the compiler</a></li>
</ul>
</li>
<li><a class="reference" href="#freeform-tests" id="id9" name="id9">freeform_tests</a></li>
</ul>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="overview" name="overview">overview</a></h1>
<p>freeform makes it easy to correctly interpret loosely structured user text
input without imposing any syntax requirements on the end user.  This is
particularly usefull for providing text based interfaces over mediums like SMS
or instant messaging. Where ambiguity can't be completely resolved it provides
you with as much help as possible to make the guess correctly in your
application. Typical use: Compile your phrase forms, associating them with a
collective <cite>command</cite> name; prepare the resulting <cite>formtable</cite>; Then use this
table to <cite>match</cite> user entered phrases to your commands. You can then access the
input fields you are interested in using the field names you supplied in your
phrase description. Matching considers the whole phrase for ambiguity
resolution. It uses levenshteins edit distance metric for individual words to
correct for finger trouble.  Backtracking is used to handle cases where the
content of user fields collides with the recognizable <cite>features</cite> of your phrase
forms. See tool.py for example usage &amp; a tool to assist developing your form
descriptions.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="examples" name="examples">examples</a></h1>
<p>The following illustrates simple use.</p>
<p>Given a text file, <strong>example-1.forms</strong>, containing:</p>
<pre class="literal-block">
use_objects_with_set: 
    use {object(s)} on {set(list book,safe,fire,door. menu abcd)},
    {object(s)} on {set(list book,safe,fire,door. menu abcd)}, 
    {set(list book,safe,fire,door. menu abcd)} try {object(s)};
    
put_objects_to: 
    put {object(s)} on {location(list shelf,box,floor. menu abc)}, 
    {object(s)} on {location(list shelf,box,floor. menu ijk)};
</pre>
<p>The following output is from 
<strong>python freeform/tool.py -I data/example-1.forms</strong>:</p>
<pre class="literal-block">
Enter input corresponding to any of the following forms:
use_objects_with_set: KE.use=use WW.object=? KE.on=on LM.set=?
use_objects_with_set: WW.object=? KE.on=on LM.set=?
use_objects_with_set: LM.set=? KE.try=try WW.object=?
put_objects_to: KE.put=put WW.object=? KE.on=on LM.location=?
put_objects_to: WW.object=? KE.on=on LM.location=?

compiled from sources:
use_objects_with_set:
    use {object(s)} on {set(list book,safe,fire,door. menu abcd)},
    {object(s)} on {set(list book,safe,fire,door. menu abcd)},
    {set(list book,safe,fire,door. menu abcd)} try {object(s)};

put_objects_to:
    put {object(s)} on {location(list shelf,box,floor. menu abc)},
    {object(s)} on {location(list shelf,box,floor. menu ijk)};


freeform:apple pear on book
use_objects_with_set: WW.object=[['apple', 'pear']] KE.on=on LM.set=['book']
freeform:use apple pear on book
use_objects_with_set: KE.use=use WW.object=[['apple', 'pear']] KE.on=on LM.set=['book']
freeform:book try apple pear
use_objects_with_set: LM.set=['book'] KE.try=try WW.object=[['apple', 'pear']]
freeform:apple pear on shelf
put_objects_to: WW.object=[['apple', 'pear']] KE.on=on LM.location=['shelf']
freeform:apple pear on shelf
put_objects_to: WW.object=[['apple', 'pear']] KE.on=on LM.location=['shelf']
freeform:apple pear on on shelf
put_objects_to: WW.object=[['apple', 'pear', 'on']] KE.on=on LM.location=['shelf']
freeform:apple pear on a
use_objects_with_set: WW.object=[['apple', 'pear']] KE.on=on LM.set=['a']
freeform:apple pear on i
put_objects_to: WW.object=[['apple', 'pear']] KE.on=on LM.location=['i']
freeform:apple pear on shelf
put_objects_to: WW.object=[['apple', 'pear']] KE.on=on LM.location=['shelf']
freeform: 
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id4" id="warts" name="warts">warts</a></h1>
<blockquote>
<ul class="simple">
<li>using setuptools, which will be excelent once its finished (imv)</li>
</ul>
</blockquote>
<p>This is alpha software, so is setuptools, which is used to extend pythons 
distutils behaviour. If setuptools gives you a problem feel free to ignore the 
setup.py file and run things in place.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id5" id="freeformc" name="freeformc">freeformc</a></h1>
<p>A simple command line tool, with an optional interactive shell, for developing
and testing phrase sources. Instalation is optional this tool can be run in 
place:</p>
<pre class="literal-block">
tar -zxvf freeform-$VER.tar.gz; cd freeform-$VER; python freeform/tool.py --help
</pre>
<p>If you are user of setuptools you can do this:</p>
<pre class="literal-block">
tar -zxvf freeform-$VER.tar.gz; cd freeform-$VER; python setup.py develop; freeformc --help
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="freeform-match" name="freeform-match">freeform.match</a></h1>
<p>The main entry point for the matching engine.</p>
<p>The matching algorithm is implemented by the <cite>match</cite> sub package. Its main entry
points are <cite>freeform.match_sentence</cite> and <cite>freeform.match_command</cite>.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id7" id="freeform-formtable" name="freeform-formtable">freeform.formtable</a></h1>
<p>Implements the compiler tool for constructing the data used by
the matching algorithm. The compiler is implemented by the functions: <cite>compile</cite>,
<cite>compile_source</cite>, <cite>yield_forms</cite>, <cite>yield_fields</cite>. These can be found in
<cite>freeform.formtable</cite>.</p>
<p>The compiler takes your form descriptions, collects them according to the
command name, that you provide for them, and produces output that should be
handed to <cite>create_formtable</cite>. Before performing matches you need to prepare
your formtable by calling <cite>formtable_prepare</cite>.</p>
<p>If you pass in a dictionary and list instance to either <cite>compile</cite> or
<cite>compile_source</cite> then you can accumulate the results from successive files into
the same <cite>formtable</cite>. Your form descriptions are collected under the command
name you give them. Multiple declarations sharing the same command name are
accumulated under the same command.</p>
<p>Strictly speaking you don't need this compiler if you are willing to put
together the input for <cite>formtable.create_formtable</cite> by hand (or using your own tools).</p>
<div class="section">
<h2><a class="toc-backref" href="#id8" id="syntax-summary-for-the-compiler" name="syntax-summary-for-the-compiler">syntax summary for the compiler</a></h2>
<p>[ these notes are a work in progress, YMMV. ]</p>
<p>grammar for describing the input phrases that can be recognized:</p>
<pre class="literal-block">
command =&gt; commandname: [ keyword | {paramword}] , [keyword|{paramword}* ;
{paramword} =&gt; [
        {id} | 
        {id(s)} |
        {id(list one,two,three.)} | 
        {id(menu abc)} |
        {id(list one,two,three. menu abc)}]
</pre>
<p>[see the <cite>MATCH_ xxx</cite> regexes and <cite>yield_ xxx</cite> functions in <cite>formtable.py</cite> for more]</p>
<p>The command description: <tt class="docutils literal"><span class="pre">send_msg_to:</span> <span class="pre">send</span> <span class="pre">{msg(s)}</span> <span class="pre">to</span> <span class="pre">{name},</span> <span class="pre">send</span> <span class="pre">{word(s)}</span>
<span class="pre">{choice(list</span> <span class="pre">fred,barny,flintstone.}</span></tt>; Produces a formtable containing a
single command named <tt class="docutils literal"><span class="pre">send_msg_to</span></tt> that can invoked by one of two phrase
forms.</p>
<p>This one: <tt class="docutils literal"><span class="pre">send</span> <span class="pre">freeform</span> <span class="pre">is</span> <span class="pre">neat</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">download</span> <span class="pre">it</span> <span class="pre">too</span> <span class="pre">to</span> <span class="pre">Mathew</span></tt>; Would
match the first form. The field named <strong>msg</strong> will contain <strong>freeform is neat you
should download it too</strong>. The field named <strong>name</strong> will contain <strong>Mathew</strong>.</p>
<p>This one: <tt class="docutils literal"><span class="pre">send</span> <span class="pre">freeform</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">downloaded</span> <span class="pre">by</span> <span class="pre">barney</span> <span class="pre">barney</span></tt>; Would match
the second form. The field named <strong>msg</strong> will contain <strong>freeform has been
downloaded by barney</strong> and the field identified by <strong>name</strong> will contain
<strong>barney</strong></p>
<p>In the following 'id' is the name you give a particular field such that you can grab
the user values out of the match result.</p>
<p>singular parameter identified by id: <tt class="docutils literal"><span class="pre">{id}</span></tt></p>
<p>a multi valued parameter, separated by whitespace and identified by id: <tt class="docutils literal"><span class="pre">{id(s)}</span></tt></p>
<p>a selection, one of which must match (levenshteins is applied to match each
item): <tt class="docutils literal"><span class="pre">{id(list</span> <span class="pre">apple,pear,bannana.)}</span></tt></p>
<p>a menu, a single character must match one of the characters in the menu:
<tt class="docutils literal"><span class="pre">{id(menu</span> <span class="pre">abc4ef5)}</span></tt></p>
<p>a listmenu, a single character must match one of the characters in the menu OR
a single word must match one of the items in the list: 
<tt class="docutils literal"><span class="pre">{id(list</span> <span class="pre">one,two,three.</span> <span class="pre">menu</span> <span class="pre">abc)}</span></tt></p>
<p>a keyword, which the phrase should contain at the appropriate <cite>logical</cite> position.
Any alphanumeric, additional the prefix characters .- are also allowed, eg
<tt class="docutils literal"><span class="pre">1word</span></tt> <tt class="docutils literal"><span class="pre">word1</span></tt> <tt class="docutils literal"><span class="pre">.word</span></tt> <tt class="docutils literal"><span class="pre">-wo-&amp;%&#64;rd</span></tt> are all legal keywords. pretty much any
string that doesn't contain spaces, start with <cite>{</cite> or contain <cite>;</cite></p>
<p>Note that all matches against keywords and list item entries are loosely 
matched using levenshteins word distance algorithm. Ambiguity is addressed
by considering the whole phrase.</p>
<p>Other field types, for example multiple select, are possible. They are still
TBD. The present set allows for a large number of simple user entry cases.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id9" id="freeform-tests" name="freeform-tests">freeform_tests</a></h1>
<p>The test suite, test_match.py, and test_freeform.py may be run inplace. At 
present they provide for reasonably comprehensive coverage of the features
offered by the matching algorithm and the guts of the compiler tool.</p>
<p>profile_match.py is where the shared bits of profiling &amp; debug code live.</p>
</div>
</div>
</body>
</html>
