<configure xmlns="http://namespaces.zope.org/zope" 
           xmlns:browser="http://namespaces.zope.org/browser"> 

    <!-- Override managerrenderer so it uses the Mlango version for IDashboard.
    This gives us the opportunity to wrap portlet rendering in our drag and drop
    rendering.
    -->
    <adapter
        factory=".portlets.managerrenderer.MlangoPortletManagerRenderer"
        provides="plone.portlets.interfaces.IPortletManagerRenderer"
        for="zope.interface.Interface
             zope.publisher.interfaces.browser.IDefaultBrowserLayer
             zope.publisher.interfaces.browser.IBrowserView
             plone.app.portlets.interfaces.IDashboard"
    />


    <!-- Override edit managerrenderer so it uses the Mlango version for IDashboard.
         This enables filtering on allowed portlets, set by the mlangomanager 'tool'
    -->
    <adapter
        factory=".portlets.managerrenderer.MlangoEditPortletManagerRenderer"
        provides="plone.portlets.interfaces.IPortletManagerRenderer"
        for="zope.interface.Interface
             zope.publisher.interfaces.browser.IDefaultBrowserLayer
             plone.app.portlets.browser.interfaces.IManageDashboardPortletsView
             plone.app.portlets.interfaces.IDashboard"
    />


    <!-- Override default dashboard.pt with our mlangodashboard.pt -->
    <browser:page
        for="Products.CMFCore.interfaces.ISiteRoot"
        name="dashboard"
        permission="plone.app.portlets.ManageOwnPortlets"
        class="plone.app.layout.dashboard.dashboard.DashboardView"
        template="./portlets/browser/templates/mlangodashboard.pt"
        />


    <!-- Add IAnnotatable interface to Assignment, so we can store extra attributes
    on the portlet, like whether a portlet is minimized for a user.    
    -->
    <class class="plone.app.portlets.portlets.base.Assignment">
      <implements interface="zope.annotation.interfaces.IAnnotatable"/>
      <implements interface="plone.portlets.interfaces.IPortletAssignment"/>
    </class>


    <!-- Override manage-group-portlets. This is simply to add our own tab for
    managing the group dashboard.
    -->
    <browser:page
      for="Products.CMFCore.interfaces.ISiteRoot"
      class="plone.app.portlets.browser.manage.ManageGroupPortlets"
      name="manage-group-portlets"
      template="utils/templates/manage-group.pt"
      permission="plone.app.portlets.ManagePortlets"
      />

</configure>
