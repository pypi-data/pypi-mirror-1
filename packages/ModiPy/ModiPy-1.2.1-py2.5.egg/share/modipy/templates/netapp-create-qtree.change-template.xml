<!-- 
     Create a qtree on a NetApp
-->

<changetemplate name="create_netapp_qtree" module='modipy.change_command' type="CommandChange">
<!-- Not sure how to check qtree yet
  <preimpl>
    <command>
      <send>vol status %(volname)s</send>
    </command>

    <condition>results.cmdoutput.find("No volume named '%(volname)s' exists.") >= 0</condition>

  </preimpl>
-->

  <impl>
    <command>
      <send>qtree create /vol/%(volname)s/%(qtree_name)s</send>
    </command>

    <!-- Make sure the qtree name is valid -->
    <condition>results.cmdoutput.find("invalid qtree name") &lt; 0</condition>

    <!-- Make sure the qtree didn't already exist -->
    <condition>results.cmdoutput.find("File exists") &lt; 0</condition>


  </impl>

</changetemplate>

