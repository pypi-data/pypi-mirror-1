# 20100208, http://hakmatak.org/dev
#
# httpd conf file for WSGI setup.
#
# echo -n "hakmatak" | md5sum 
# b07d15c79b26e9463aa63eabe3d9054e
# b07d15c7 is chosen as the default prefix for WSGI URLs below.
# It can be replaced by any valid string you prefer.

#--------------------------
# "webified" DirectoryIndex
#--------------------------

<Directory "/var/www/html/test/data">
  Options FollowSymLinks
  Order allow,deny
  Allow from all
  DirectoryIndex /b07d15c7/index
</Directory>

#----------------------------
# rewrite rules for w10n URLs
#----------------------------

RewriteEngine on
#RewriteLogLevel 9
#RewriteLog /var/log/httpd/rewrite_log

# flags used:
# L: last
# NC: nocase
# NS: nosubreq
# PT: paththrough. You must use this flag if you want to mix directives
#     from different modules which allow URL-to-filename translators
# for details,
# check http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule

##..................
## if a dir seen, don't check further
#
#RewriteCond %{DOCUMENT_ROOT}%{SCRIPT_FILENAME}  -d
#RewriteRule ^.+$ - [L]

RewriteRule ^(.*/[^/]+\.(txt))(/.*)$ /b07d15c7/webify/bytearray!$1!$3 [NC,NS,PT]

#-------------------
# WSGI configuration
#-------------------

LoadModule wsgi_module modules/mod_wsgi.so

# run in daemon mode.
# some reader has problem (hangs forever) in embedded mode.
WSGIDaemonProcess hkmtk user=webifier processes=2 threads=15 python-path=/home/webifier/hakmatak-1.1.0 python-eggs=/home/webifier/.python-eggs

WSGIProcessGroup hkmtk

# For some Linux distributions, restrictive permissions are placed on
# the standard Apache runtime directory such that the directory is not
# readable to others.
# http://code.google.com/p/modwsgi/wiki/ConfigurationIssues
WSGISocketPrefix run/wsgi

# this dir must be readable by apache user
WSGIScriptAlias /b07d15c7/index /home/webifier/hakmatak-1.1.0/hakmatak/wsgi/index.py
WSGIScriptAlias /b07d15c7/webify /home/webifier/hakmatak-1.1.0/hakmatak/wsgi/webify.py
