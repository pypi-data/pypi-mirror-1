# 20100209, http://hakmatak.org/dev, httpd conf for hakmatak WSGI.
#
# b07d15c79b26e9463aa63eabe3d9054e is md5sum of hakmatak
# b07d15c7 is used as the alias. But, it can be any unique string you prefer.

WSGIScriptAlias /b07d15c7 /home/webifier/wsgi/hakmatak

# dir listing with webifiable items
<DirectoryMatch "^/var/www/html/test/data/txt">
  Options FollowSymLinks
  DirectoryIndex /b07d15c7/index.py
</DirectoryMatch>

# rewrite URLs for *.txt to w10n type bytearray
RewriteRule ^(/test/data/txt/.*[^/]+\.(txt))(/.*)$ /b07d15c7/webify.py/bytearray!$1!$3 [NC,NS,PT]

#---------------------
# rewrite engine setup
#---------------------

RewriteEngine on
#RewriteLogLevel 9
#RewriteLog /var/log/httpd/rewrite_log

# flags used:
# L: last
# NC: nocase
# NS: nosubreq
# PT: paththrough. You must use this flag if you want to mix directives
#     from different modules which allow URL-to-filename translators
# for details,
# check http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule

##..................
## if a dir seen, don't check further
#
#RewriteCond %{DOCUMENT_ROOT}%{SCRIPT_FILENAME}  -d
#RewriteRule ^.+$ - [L]

#-----------
# WSGI setup
#-----------

LoadModule wsgi_module modules/mod_wsgi.so

# run in daemon mode.
# some reader has problem (hangs forever) in embedded mode.
#WSGIDaemonProcess hkmtk user=webifier processes=2 threads=15 python-eggs=/home/webifier/.python-eggs
WSGIDaemonProcess hkmtk user=webifier processes=2 threads=15

WSGIProcessGroup hkmtk

# For some Linux distributions, restrictive permissions are placed on
# the standard Apache runtime directory such that the directory is not
# readable to others.
# http://code.google.com/p/modwsgi/wiki/ConfigurationIssues
WSGISocketPrefix run/wsgi
