<html metal:use-macro="here/@@standard_macros/master">
  <body>

    <div metal:fill-slot="content">              

      <div class="oc-headingBlock">
        <h1>Projects on OpenPlans</h1>
        <p class="oc-headingContext">Currently serving <span tal:replace="view/nprojects"/> projects</p>
      </div>
      
      <div id="oc-content-main">
        
        <tal:set_var define="current_search_page string:projects;
			     form_action_url string:${context/portal_url}/projects/searchresults">
          <div metal:use-macro="here/main_macros/search_widget" />
        </tal:set_var>

        <!-- list of recently updated projects. XXX maybe create a macro out of this? Generic for recent content? -->
        <div class="oc-widget oc-widget-feed">
          <h2>Recently updated projects</h2>
          <ul class="oc-feed-list">
            <li class="oc-feed-item oc-clearAfter" tal:repeat="project view/recently_updated_projects">
              <div class="oc-project-logo" tal:condition="project/logo | nothing"> <!-- NOTE once images do exist this div will NOT be conditional but its contents will -->
                <a tal:attributes="href project/absolute_url" tal:condition="project/logo | nothing">
                  <img src="" tal:attributes="src project/image_src | nothing; alt project/Title; title project/Title" tal:condition="project/logo | nothing" />
                </a>
              </div>
              <h3 class="oc-feed-item-title">
                <a href="" tal:attributes="href project/absolute_url" tal:content="nocall: project/title">Project Title</a>
              </h3>
              <p class="oc-feed-item-data oc-discreetText" tal:define="nmembers python: len(project.projectMemberIds())">
                <span tal:replace="nmembers">YY</span> member<span tal:condition="python: nmembers > 1" tal:replace="string:s" />, active since <span tal:replace="python: view.pretty_date(project.CreationDate())">Jan 1937</span>
              </p>
              <p class="oc-feed-item-description" tal:define="desc project/Description">
                <span tal:condition="desc" tal:replace="desc" />
              </p>
            </li>
          </ul>
        </div>
        
      </div><!-- content-main -->
      
      
      <!-- XXX we need to think about how we are going to implement this with dynamic data
           wiki page snippet pulled from a particular location? -->
      <!-- content-sidebar -->
      <div id="oc-content-sidebar">
      	<div class="oc-getstarted oc-boxy">
      	  <h2>Start a project</h2>
      	  <p class="oc-boxy-content">Can&rsquo;t find a project you are interested in? See a need that is not being met? Why not 
	    <a tal:attributes="href string:${view/siteURL}/projects/create">start a new project</a>?
	  </p>
      	</div>
      	<div class="oc-boxy" tal:content="structure python: view.render_static('main_projects_featured_projects.txt')" />
      </div>
    </div><!-- content-fill-slot -->
    
  </body>
</html>
