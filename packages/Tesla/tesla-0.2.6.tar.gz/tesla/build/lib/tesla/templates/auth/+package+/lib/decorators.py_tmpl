from decorator import decorator
from ${package}.lib.auth import redirect_to_login

# Decorator for authenticating individual methods
# Takes single Permission instance 

def authorize(permission):
    def wrapper(func, self, *args, **kw):
        if permission.check():
            return func(self, *args, **kw)
        redirect_to_login()
    return decorator(wrapper)