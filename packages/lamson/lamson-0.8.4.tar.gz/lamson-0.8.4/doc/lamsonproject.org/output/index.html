<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>Lamson: Lamson The Python SMTP Server</title>
	<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" charset="utf-8" />
	<!--[if IE]><link rel="stylesheet" href="/css/style_ie.css" type="text/css" media="all" charset="utf-8" /><![endif]-->
	
</head>

<body>
	
	<div id="serious_black">
		
		<!-- header -->
		<div id="header">
			<div class="wrap clear">
				<!-- logo -->
				<div id="logo">
					<h1><a href="/">Lamson Mail Server</a></h1>
                    <h2>Pipes and aliases are so 1970.</h2>
				</div>
				<!-- / logo -->
				
				<!-- navigation -->
				<div id="nav">
					<a href="/"><span><span><span><span>Home</span></span></span></span></a>
					<a href="/blog/"><span><span><span><span>News</span></span></span></span></a>
					<a href="/download.html"><span><span><span><span>Download</span></span></span></span></a>
					<a href="/docs/"><span><span><span><span>Docs</span></span></span></span></a>
				</div>
				<!-- / navigation -->
			</div>
		</div>
		<!-- / header -->
		
		<!-- middle -->
		<div id="middle">
			<div class="middle-tr">
				<div class="middle-bl">
					<div class="middle-br">
						
						<div class="wrap clear">
							<!-- content -->
                            <div id="content">
                                <h1>Lamson The Python SMTP Server</h1>
                                	<p>We&#8217;ve all been there, mucking around in the sendmail m4 macros trying one more time to get the
damn mailing list to update for the new users.  Every time we say, &#8220;This sucks, I want to rewrite
this stupid thing.&#8221;  Yet, when we&#8217;re done, we simply crawl back to our caves covered in our sendmail
wounds.</p>

	<p>Lamson&#8217;s goal is to put an end to the hell that is &#8220;e-mail application development&#8221;.  Rather than
stay stuck in the 1970&#8217;s, Lamson adopts modern web application framework design and uses a proven
scripting language (Python).</p>

	<p><pre>
def <span class="caps">UNKNOWN</span> (session, message, list, action, host):
  if action  "unsubscribe":
      logging.debug("Ignoring user who doesn't really exist.")
  elif action  &#8220;subscribe&#8221;:
      confirm_address = &#8220;%s-confirm-%d@%s&#8221; % (list, random.randint(0,10000),
              host)
      body = view('confirmation.msg&#8217;).render( list=list,
              confirm_address=confirm_address, action=&#8220;subscribe&#8221;)
      relay.reply(message, confirm_address,
              &#8220;Confirm your subscription to %s&#8221; % list, body)</p>

      return <span class="caps">JOINING</span>
  else:
      body = view('unknown.msg&#8217;, address=message['to&#8217;])
      relay.reply(message, list + &#8220;-noreply@&#8221; + host, &#8220;Invalid command %s&#8221; %
              action, body)
</pre>

	<p>Instead of hideous aliases files (that you never remember to update) 
Lamson uses friendly regular expressions and routing.</p>

<pre>
handlers = [
    (&#34;^([a-z.A-Z0-9]+)-(unsubscribe)@(HOST)$&#34;,
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)-(subscribe)@(HOST)$&#34;,
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)-(pause)@(HOST)$&#34;, 
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)-(unpause)@(HOST)$&#34;, 
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)-(confirm)-([0-9]+)@(HOST)$&#34;, 
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)@(HOST)$&#34;, 
       Conversation(&#39;app.handlers.debate&#39;, unique=True, reload=DEBUG)),
    (&#34;^([a-z.A-Z0-9]+)-(.+)@(HOST)$&#34;, 
       Conversation(&#39;app.handlers.admin&#39;, reload=DEBUG)),
    (&#34;^(.+)@(HOST)$&#34;, ForwardHandler()),
    (&#34;^(.+)@(.+)$&#34;, LogHandler()),
]
</pre>

	<p>Rather than bizarre flat file &#8220;databases&#8221; and hashtable stores, Lamson uses a real
Object-Relation Mapping system (SQLAlchemy) to talk to an <span class="caps">RDBMS</span>.</p>

<pre>
table = Table(table_name, metadata, 
        Column(&#39;id&#39;, Integer, primary_key=True),
        Column(&#39;recipient&#39;, String(50), nullable=False),
        Column(&#39;sender&#39;, String(50), nullable=False),
        Column(&#39;state&#39;, String(50), nullable=False, default=&#34;START&#34;),
        Column(&#39;fsm&#39;, String(50), nullable=False),
        Column(&#34;last_modified&#34;, DateTime,
            default=datetime.datetime.now,
            onupdate=datetime.datetime.now,
            nullable=False)
)
mapper(FSMState, table)
</pre>

	<p>Everything about Lamson is modern, rejecting any part of the gargantuan e-mail standards
that doesn&#8217;t make sense in today&#8217;s world of giant attachments to MS Exchange&#8482; servers
through spam blockers trying their best to defend the world.</p>

	<h2>The 30 Second Introduction</h2>

	<p>If you have Python and easy_install already, then try this out:</p>

<pre>
$ easy_install lamson
$ lamson gen -project mymailserver
$ cd mymailserver
$ lamson syncdb
$ lamson start
$ lamson log -queue run/queue -port 8899
$ nosetests
$ lamson help -for send
$ lamson send -sender me@mydomain.com -to test@test.com \
        -subject &#34;My test.&#34; -body &#34;Hi there.&#34; -port 8823
$ less logs/lamson.log
$ mutt -F muttrc
$ lamson stop -ALL run
</pre>

	<p>You now have a working base Lamson setup ready for you to work on with the following installed:</p>

	<ul>
		<li>Lamson and all dependencies (SQLAlchemy, Mako, nosetests)</li>
		<li>Code for your project in mymailserver.  Look in app/handlers and config/settings.py</li>
		<li>Two initial tests that verify your server is not an open relay and forwards mail in tests/handlers/open_relay_tests.py</li>
		<li>A &#8220;logger&#8221; server running on port 8899 that dumps all of its mail into run/queue</li>
		<li>A config script for mutt (muttrc) that you can use to inspect the run/queue <strong>and</strong> also send mail using Lamson&#8217;s <strong>send</strong> command.</li>
	</ul>

	<h2>Next Steps</h2>

	<p>If you want to write a Lamson application you&#8217;ll have to read the code.  You can grab 
<a href="/download.html">the code</a> and you can read through the <a href="/docs/getting_started.html">quick start</a>
documentation.  After you&#8217;ve gone through that, best thing to do is read the code to
the mailing list example included in the <a href="/releases/">source distribution</a> and read the
rest of the <a href="/docs/">documentation</a> on this site.</p>

	<p>At any point, you can get help for all available Lamson commands with:</p>

	<p><code>
$ lamson help
</code></p>

	<p>You can get individual command help with:</p>

	<p><code>
$ lamson help -for send
</code></p>

	<p>Finally, if you really want to get started using Lamson to implement your dream email
application, but are completely lost, then you can <a href="/contact.html">contact me</a> for help.</p>


							</div>
							<!-- / content -->

							<!-- sidebar -->
							<div id="sidebar">
								<!-- box -->
								<div class="sidebar-nav box">
									<div class="tr">
										<div class="br">

											<h3>Things To Read</h3>
											<ul>
												<li><a href="/blog/">blog with latest news.</a></li>
                                                <li><a href="/feed.xml">rss feed for you.</a></li>
                                                <li><a href="/download.html">download the gear.</a></li>
                                                <li><a href="/docs/getting_started.html">getting started.</a></li>
                                                <li><a href="/docs/">more documentation.</a></li>
                                                <li><a href="/docs/faq.html">frequently asked questions.</a></li>
                                                <li><a href="/lists/">mailing lists to join.</a></li>
                                                <li><a href="/about.html">about lamson.</a></li>
                                                <li><a href="/contact.html">getting help.</a></li>
											</ul>
										</div>
									</div>
								</div>
								<!-- / box -->

								<!-- box -->
								<div class="box">
									<div class="tr">
										<div class="br">

											<h3>Getting Started</h3>
                                            <p>See the <a href="/download.html">download instructions</a> for information
                                            on getting lamson, and read the <a href="/docs/getting_started.html">getting started
                                                instructions</a> to start your own application in less than 10 minutes.
                                            </p>

										</div>
									</div>
								</div>
                                <!-- / box -->

								<!-- box -->
								<div class="box">
									<div class="tr">
										<div class="br">

											<h3>About</h3>
                                            <p>
                                            Lamson is a Python based SMTP (E-Mail) server and application framework that
                                            let's you write e-mail applications the way you'd write modern web applications.
                                            </p>

										</div>
									</div>
								</div>
								<!-- / box -->
							</div>
							<!-- / sidebar -->
						</div>
						
						
					</div>
				</div>
			</div>
		</div>
		<!-- / middle -->
		
		<!-- footer -->
		<div id="footer">
			<div class="wrap">
				<p class="cp">&copy; 2009 <a href="http://zedshaw.com/">Zed A. Shaw</a> <span>//</span> valid xhtml 1.0 strict</p>
				<p>designed by <a href="http://www.renehornig.com/" title="webdesign berlin">hornig</a></p>
			</div>
		</div>
		<!-- / footer -->
		
	</div>

</body>
</html>
