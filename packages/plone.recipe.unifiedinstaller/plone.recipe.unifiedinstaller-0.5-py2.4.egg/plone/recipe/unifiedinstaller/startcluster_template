#!%(shell_cmd)s
#
# ZEO cluster startup script
#

if [ ! -w %(file_storage_dir)s ]; then
    echo "You lack the rights necessary to run this script; Try sudo $0"
    exit 1
fi


if [ -e %(file_storage)s ]
then
	FIRST_TIME="N"
else
	FIRST_TIME="Y"
fi
echo 'Starting ZEO server...'
%(bin_dir)s/%(zeoserver)s start
sleep 1
if [ $FIRST_TIME = "Y" ]
then
	echo 'This is the first start of this instance.'
	echo 'Creating Data.fs and a Plone site.'
	echo 'We only need to do this once, but it takes some time.'
	echo 'Creating Plone site at /Plone in ZODB...'
	%(bin_dir)s/client1 run %(bin_dir)s/mkPloneSite.py 2>> %(location)s/var/log/firststart.log
fi
for client in %(clients)s
do
    sleep 1
    echo Starting $client
    %(bin_dir)s/$client start
done
