<tal:create define="form template.get_api('form');
                    content template.get_api('content')">

  <form i18n:domain="vudo.cmf"
        tal:condition="not form.data.type_id"
        action="add" method="get">

  <div class="field">
    <div class="error">${form.errors.type_id}</div>
    <label for="type_id">Add content</label>
    <span class="help">
      Select the content type that you wish to add.
    </span>
    <select name="type_id" tal:define="types content.get_allowed_types()">
      <option tal:repeat="info types" value="${info.type_id}">
        ${info.metadata.title}
      </option>
    </select>
  </div>
  
    <input type="submit" name="${form.prefix}" value="Add"
           i18n:attributes="value" />
    
  </form>

  <tal:add tal:condition="form.data.type_id">
    <form tal:define="transient form.create_object();
                      form template.get_api('form', transient)"
          metal:use-macro="template.get_macro('edit', transient)" />
  </tal:add>
  
</tal:create>
