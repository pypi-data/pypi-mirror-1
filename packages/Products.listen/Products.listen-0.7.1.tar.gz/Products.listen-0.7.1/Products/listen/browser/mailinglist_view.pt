<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
  <body>
    <div metal:fill-slot="main">
      <div metal:define-macro="body">
          <div id="listen-actions" class="selfclear">
            <form name="search" method="get"
                  id="search-form"
                  tal:attributes="action string:${context/absolute_url}/search">
              <input type="text" name="search_text"
                     tal:attributes="value request/search_text|nothing" />
              <input class="context" type="submit" name="submit" value="Search" />
            </form>
            <a class="listen-post-new-topic"
               tal:attributes="href string:${context/absolute_url}/new_topic">
              <button type="button" class="standalone">Post new topic</button>
            </a>
          </div>

        <script type="text/javascript" src="++resource++obfuscation.js"></script>

        <div id="navigation">
            <tal:threads define="batch context/archive/@@forum_view/getTopics;
				 threads batch/topic_list">

              <div metal:use-macro="here/batch_macros/macros/navigation" />

              <table id="threads-listing" tal:condition="threads">
                <thead>
                  <tr>
                    <th>Subject</th>
                    <th>Started By</th>
                    <th>Replies</th>
                    <th>Last Updated</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr tal:repeat="thread threads" tal:attributes="class python:repeat['thread'].odd() and 'odd' or 'even'">
                    <td> 
                      <a tal:attributes="href thread/url"
                         tal:content="structure thread/brief_subject" />
                    </td>
                    <td tal:define="ms context/portal_membership;
                                    id thread/from_id;
                                    href python:ms.getHomeUrl(id)">
                      <a tal:omit-tag="python: not id or not href"
                         class="author-link"
                         tal:attributes="href href;
					                     title id"
                         tal:content="structure thread/mail_from" />
                    </td>
                    <td tal:content="thread/responses" />
                    <td tal:content="thread/last_post" />
                  </tr>
                  </tbody>
              </table>
              <h5 tal:condition="not:threads">There are currently no messages in this mailing list's archive.</h5>
              <div metal:use-macro="here/batch_macros/macros/navigation" />

            </tal:threads>
        </div>

          <metal:footer_macro define-macro="footer">
            <tal:has_document_byline tal:condition="exists:here/document_byline">
              <div metal:use-macro="here/document_byline/macros/byline">
                Get the byline - contains details about author and
                modification date.
              </div>
            </tal:has_document_byline>
          </metal:footer_macro>
        </div>
    </div>
  </body>
</html>
