<script type="text/javascript" src="++resource++obfuscation.js"></script>
<dl class="portlet listenPortlet"
    i18n:domain="plone"
    tal:define="ml view/mailinglist;
                isAnon ml/portal_membership/isAnonymousUser">

    <dt class="portletHeader selfclear">
        <span class="portletTopLeft" id="list-details-header">About </span> 
        <a tal:attributes="href string:${ml/absolute_url}/edit"
           tal:condition="view/can_edit">edit</a>
        <span class="portletTopRight"></span>
    </dt>
    <dd class="portletItem">
      <dl class="list-details">
        <dt tal:condition="view/description">Description:</dt>
        <dd tal:condition="view/description" 
            tal:content="view/description" />

        <dt>Address:</dt>
        <dd tal:content="structure view/address" />

        <dt tal:condition="view/list_managers">Managers:</dt>
        <dd tal:condition="view/list_managers" 
            tal:content="structure view/list_managers" />

        <dt>List Type:</dt>
        <dd tal:content="view/list_type" />

        <dt>Archive:</dt>
        <dd tal:content="view/archived" />
      </dl>

      <!-- subscription options -->
      <p tal:condition="isAnon"
         id="unsub-instructions"
         i18n:translate="unsub-instructions">
        To unsubscribe from this list send an email to the list with the
        subject
        "<span tal:replace="view/unsubscribe_keyword"
               i18n:name="sunsubscribe_keyword" />"
        and an empty body.
      </p>

      <form name="subscription-form"
            id="subscription-form"
            tal:define="errors view/errors|nothing; isPending view/isPending"
            action="."
            method="post"
            tal:attributes="action string:${ml/absolute_url}/update_subscription">

        <tal:anon condition="isAnon">
          <p id="subscription-satus"
             i18n:translate="">To subscribe to the list enter your email
            in the field below.
          </p>
          <div class="field"
               tal:define="error errors/email_address|nothing"
               tal:attributes="class python:'field' + (error and ' error' or '')">
            <label for="email_address"
                   i18n:translate="label_email">Email Address:</label>
            <span title="Required"
                  i18n:domain="plone"
                  i18n:translate="label_required"
                  i18n:attributes="title title_required;">
              (Required)
            </span>
            <div tal:condition="error" tal:content="error"
                 i18n:translate="">
              The Error
            </div>
            <input type="text"
                   value=""
                   name="email_address"
                   tal:attributes="value request/email_address|nothing" />
          </div>
          <div class="formControls">
            <input type="submit"
                   class="context"
                   name="subscribe_email"
                   value="Subscribe Address"
                   i18n:attributes="value" />
          </div>
        </tal:anon>
        <tal:member define="subscribed view/isSubscribed"
                    condition="python:not isAnon and not isPending">
          <div class="formControls">
            <input type="submit"
                   class="standalone"
                   name="unsubscribe_member"
                   value="Unsubscribe"
                   tal:condition="subscribed"
                   i18n:attributes="value" />

            <input type="submit"
                   class="standalone"
                   name="subscribe_member"
                   value="Subscribe"
                   tal:condition="not:subscribed"
                   i18n:attributes="value" />
          </div>
        </tal:member>
        <p tal:condition="isPending">
          Your subscription request is pending moderation by the list manager.
        </p>
        <input type="hidden" name="nextURL" value=""
               tal:attributes="value request/ACTUAL_URL" />
      </form>
      <!-- end subscription options -->

     <div id="manager_email"
        i18n:translate="manager-email-prompt">
       If you have questions! 
       <div class="formControls">
	       <a tal:attributes="href string:mailto:${ml/manager_email}"><button class="standalone">Write Us</button></a>
	     </div>
     </div>

      <span class="portletBottomLeft"></span>
      <span class="portletBottomRight"></span>
    </dd>
</dl>
