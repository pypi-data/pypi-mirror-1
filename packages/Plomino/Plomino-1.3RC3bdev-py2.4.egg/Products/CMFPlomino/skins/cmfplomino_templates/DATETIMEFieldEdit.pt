<tal:block tal:define="v options/fieldvalue;
                       field options/field;
                       db options/field/getParentDatabase;
                       defaultformat python:db.getDateTimeFormat();
                       fieldformat python:options['field'].getSettings('format');
                       format python:test(not(fieldformat),defaultformat,fieldformat);
                       hm python:('%H' in format);
                       ymd python:('%Y' in format)">

	<tal:block tal:condition="python:test(v)">
		<span>
			<tal:block define="id options/fieldname;
							show_hm hm;
                            show_ymd ymd;
                            inputname options/fieldname;
                            formname string:edit_form;
							inputvalue python:v.strftime('%Y-%m-%d %H:%M');">
				<tal:block metal:use-macro="here/DATETIMETool/macros/calendarDatePickerBoxFormat">
					a calendar, hopefully
				</tal:block>

			</tal:block>
		</span>
	</tal:block>
	<tal:block tal:condition="python:test(not(v))">
		<span>
			<!--<input type="text" tal:attributes="name options/fieldname" />-->
			<tal:block define="id options/fieldname;
							show_hm hm;
                            show_ymd ymd;
                            inputname options/fieldname;
                            formname string:edit_form;
							inputvalue python:'';">
				<tal:block metal:use-macro="here/DATETIMETool/macros/calendarDatePickerBoxFormat">
					a calendar, hopefully
				</tal:block>

			</tal:block>
		</span>
	</tal:block>
</tal:block>
