<html
    xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="here/main_template/macros/master"
    i18n:domain="cmfquestionnaire">
<body>
  <tal:block metal:fill-slot="main">

  <h1 class="documentFirstHeading"
      tal:content="here/Title">
    Title
  </h1>

  <form action="questionnaire_submissions_form"
        class="enable_autofocus"
        name="questionnaire_submissions_form"
        method="post"
        tal:attributes="action string:${here/absolute_url}/${template/id}">

    <input type="hidden"
            name="form.submitted"
            value="1"/>

    <fieldset style="width: 55%; float: right; margin-top: 0;"
              tal:define="tickets here/getTickets"
              tal:condition="here/use_ticket">
      <legend i18n:translate="label_ticket_manage">Ticket Management</legend>

      <tal:block tal:condition="tickets">
      <div class="field">
        <label i18n:translate="label_unused_tickets">Unused tickets</label>
        <div class="formHelp"
             tal:content="python:', '.join(tickets)">Tickets</div>
      </div>

      <input type="submit"
             class="context"
             name="form.button.listTickets"
             value="Printable List"
             i18n:attributes="value"/>

      <input type="submit"
             class="context"
             name="form.button.deleteAllTickets"
             value="Delete All"
             i18n:attributes="value"/>
      </tal:block>

      <div class="field"
           style="margin-top: 1ex">
        <label for="ticketCount"
               i18n:translate="label_count">Count</label>
        <div class="formHelp"
             i18n:translate="help_create_tickets">
          Enter the number of tickets you want to create.
        </div>
        <input type="text"
               id="ticketCount"
               name="ticketCount"
               size="3"/>
      </div>

      <input type="submit"
             class="context"
             name="form.button.createTickets"
             value="Create"
             i18n:attributes="value"/>
    </fieldset>

    <fieldset style="margin-right: 1em"
              tal:define="usedTickets here/getUsedTickets">
      <legend i18n:translate="label_submitted_forms">Submitted Forms</legend>

      <p class="discreet"
         tal:condition="not:usedTickets"
         i18n:translate="label_no_submissions">
        There are no submissions.
      </p>

      <p class="discreet"
         tal:condition="usedTickets">
        <tal:block i18n:translate="label_submission_count">Submission count</tal:block>:
        <span tal:replace="python:len(usedTickets)"/>
      </p>

      <div class="field">
        <tal:block tal:repeat="ticket usedTickets">
        <input type="checkbox"
               name="formIds:list"
               tal:attributes="value ticket"/>
        <a href="#"
           tal:content="ticket"
           tal:attributes="href string:${here/absolute_url}?ticket=${ticket}">ticket</a><br/>
        </tal:block>
      </div>

      <input type="submit"
             class="context"
             name="form.button.deleteForms"
             value="Delete Forms"
             tal:condition="usedTickets"
             i18n:attributes="value"/>
    </fieldset>
    
    <br style="clear: both"/>
  </form>
  </tal:block>
</body>
</html>
