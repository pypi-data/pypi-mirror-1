<html
    xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="here/main_template/macros/master"
    i18n:domain="cmfquestionnaire">
<body>
  <tal:block metal:fill-slot="main">

  <h1 class="documentFirstHeading"
      tal:content="here/Title">
    Title
  </h1>

  <form action="questionnaire_results_form"
        class="enable_autofocus"
        name="questionnaire_results_form"
        method="post"
        tal:attributes="action string:${here/absolute_url}/${template/id}">

    <input type="hidden"
            name="form.submitted"
            value="1"/>

    <tal:block tal:define="questions here/evaluate">
    <fieldset tal:repeat="question questions">
      <p style="padding: 5px"
         tal:content="question/text">Question text</p>

      <div style="float: left; margin-right: 20px">
        <table frame="box">
          <tbody>
            <tr>
              <tal:block tal:repeat="answer question/answers">
              <td style="vertical-align: bottom;
                         height: 170px;
                         text-align: center;
                         font-size: 80%;"
                  tal:define="count python:answer[0];
                              percent python:answer[1];
                              height python:1.5 * percent;">
                <div style="text-align: center"
                     tal:condition="count"
                     tal:content="count">count</div>
                <div tal:attributes="style string:height: ${height}px">
                  <div style="width: 30px; height: 100%;
                              background-color: blue;
                              color: white">
                    <strong tal:condition="python:percent>=10"
                            tal:content="string:${percent}%">percentage</strong>
                  </div>
                </div>
                <div tal:content="repeat/answer/number">answer</div>
              </td>
              </tal:block>
            </tr>
          </tbody>
        </table>
      </div>

      <div style="font-style: italic">
        <p>
          <tal:block i18n:translate="label_answer_count">Answer count</tal:block>:
          <span tal:replace="question/answered">count</span>
        </p>

        <p>
          <tal:block i18n:translate="label_average">Average</tal:block>:
          <span tal:replace="question/average">average</span>
        </p>

        <tal:block tal:repeat="option question/options">
        <span tal:replace="repeat/option/number"/>:
        <span tal:replace="option"/><br />
        </tal:block>
      </div>
    </fieldset>
    </tal:block>

    <tal:block tal:define="comments here/getComments"
               tal:condition="comments">
    <h3 i18n:translate="label_comments">Comments</h3>

    <fieldset tal:repeat="comment here/getComments">
      <legend tal:content="comment/id">id</legend>

      <p tal:content="comment/text">comment</p>
    </fieldset>
    </tal:block>

    <input type="submit"
           name="form.button.getPDFReport"
           value="Get PDF Report"
           class="context"
           tal:condition="here/isPDFAvailable"
           i18n:attributes="value" />

    <input type="submit"
           name="form.button.getXMLDump"
           value="Get as XML"
           class="context"
           i18n:attributes="value" />

    <input type="submit"
           name="form.button.getCSVDump"
           value="Get as CSV"
           class="context"
           i18n:attributes="value" />

    <input type="submit"
           name="form.button.getExcelDump"
           value="Get as Excel"
           class="context"
           tal:condition="here/isXLSAvailable"
           i18n:attributes="value" />

  </form>
  </tal:block>
</body>
</html>
