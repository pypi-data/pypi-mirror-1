<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xml:lang="en" lang="en"
      metal:use-macro="context/prefs_main_template/macros/master"
      i18n:domain="collective.gsa">

<body>

<div metal:fill-slot="prefs_configlet_main"
    tal:define="plone_portal_state context/@@plone_portal_state;">

    <div metal:define-macro="form">

        <div id="viewspace" metal:define-slot="viewspace">

            <metal:block define-macro="header">
                <div metal:use-macro="context/global_statusmessage/macros/portal_message">
                    Portal status message
                </div>
            </metal:block>

            <h1 class="documentFirstHeading"
                i18n:translate="heading_maintenance_tool"
                metal:define-slot="heading">
                GSA Maintenance Tool
            </h1>

            <a href=""
               class="link-parent"
               tal:attributes="href string: $portal_url/plone_control_panel"
               i18n:translate="label_up_to_plone_setup">
                Up to Site Setup
            </a>

            <p i18n:translate="description_gsa_maintenance">
                This view contains GSA related maintenance tools.
            </p>

            <fieldset>
                <legend i18n:translate="heading_gsa_reindex">
                    GSA Reindex
                </legend>
                
                <p i18n:translate="help_gsa_reindex" class="discreet">
                    This tool reindexes all objects and sends feeds to the GSA. This may take a very long time.
                </p>
                
                <form action="."
                    method="POST"
                    tal:attributes="action request/URL">
                    
                    <input type="submit" class="context" value="Reindex" name="collective.gsa.reindex"/>
                    
                </form>
                
            </fieldset>
            
            <fieldset>
                <legend i18n:translate="heading_gsa_purge">
                    Purge queue
                </legend>

                <p i18n:translate="help_gsa_purge" class="discreet">
                    Click the button to purge the GSA queue that should be sent to the GSA.
                    It may happen that GSA would keep refusing to accept the feeds that are in the queue and 
                    it would not allow to index further.
                </p>

                <form action="."
                    method="POST"
                    tal:attributes="action request/URL">

                    <input type="submit" class="context" value="Purge" name="collective.gsa.purge"/>
                </form>
            </fieldset>

        </div>

        <script type="text/javascript"
            tal:define="extra_script view/extra_script | nothing"
            tal:condition="extra_script"
            tal:content="structure extra_script">
        </script>

    </div>

</div>
</body>
</html>
