<dl class="portlet portletDonateWithPayPal"
    i18n:domain="plone.portlet.donatewithpaypal">

    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
        <span tal:content="view/data/donation_title">
           Donations
        </span>
        <span class="portletTopRight"></span>
    </dt>

    <dd class="portletItem odd">
        <form name="_xclick" action="https://www.paypal.com/cgi-bin/webscr" onsubmit="return cleanText()" method="post" style="text-align: center;">
			<input type="hidden" name="cmd" value="_xclick">
			<input type="hidden" name="business" tal:attributes="value view/data/donation_acct" value="me@mybusiness.com">
			<input type="hidden" name="item_name" value="Donation">
			<input type="hidden" name="currency_code" tal:attributes="value view/data/donation_code" value="USD">
			
			<div style="text-align: left;"><label>Amount</label>
				<select id="amountPicker" name="amount" onchange="showText()" style="width:100px;">
					<option tal:repeat="amt view/data/donation_amts" tal:content="amt" tal:attributes="value amt"></option>
				</select>
				<label tal:content="view/data/donation_code" style="font-weight: normal !important;"></label>
						
				<div id="other" style="display: none; margin-top: 10px;">
					<input type="text" id="amountText" style="width: 99px;" />
					<label tal:content="view/data/donation_code" style="font-weight: normal !important;"></label>
				</div>
			</div>

			<input type="image" src="http://www.paypal.com/en_US/i/btn/btn_donate_LG.gif" border="0" style="background: #ffffff none; border: 0; margin-top:10px;" name="submit" alt="Make payments with PayPal - it's fast, free and secure!">						

			<script type="text/javascript" tal:condition="view/data/donation_other">
				<!--
				var i = document.forms['_xclick'].amount.options.length;
				document.forms['_xclick'].amount.options[i] = new Option('Other', 'other');

				function showText() {
					if (document.forms['_xclick'].amount.options[document.forms['_xclick'].amount.selectedIndex].value == "other") {
						document.getElementById('amountText').name = "amount";
						document.getElementById('other').style.display = "block";
						document.getElementById('amountPicker').name = "";
					} else {
						document.getElementById('amountText').name = "";
						document.getElementById('other').style.display = "none";
						document.getElementById('amountPicker').name = "amount";
					}
				}

				function cleanText() {
					if (isNaN(document.getElementById("amountText").value)) {
						alert('Only put numbers in the custom amount box, nothing else.');
						document.getElementById("amountText").focus();					
						return false;
					} else {
						return true;
					}
				}
				//-->
			</script>
		</form>
    </dd>

</dl>
