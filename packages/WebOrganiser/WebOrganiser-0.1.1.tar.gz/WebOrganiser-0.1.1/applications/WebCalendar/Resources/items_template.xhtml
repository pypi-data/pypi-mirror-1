<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
 xmlns:template="http://www.boddie.org.uk/ns/xmltools/template">
<head>
  <title>Items</title>
  <link type="text/css" rel="stylesheet" href="styles/styles.css" />
</head>
<body template:element="items">
  <form action="" method="POST">
    <div class="controls">
      <input name="download" type="submit" value="Download"/>
      <input name="download-all" type="submit" value="Download all"/>
      <input name="new-event" type="submit" value="New event"/>
      <input name="new-to-do" type="submit" value="New to-do item"/>
      <input name="new-card" type="submit" value="New card"/>
    </div>
    <div class="view" template:element="table">
      <table align="center" border="0" cellpadding="5" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th width="10%" class="header" xml:space="preserve">
              <a href="?sort-by=@item-type">Type</a>
              <a href="?sort-by=@item-type&amp;sort-order=descending">(D)</a>
            </th>
            <th class="header" xml:space="preserve">
              <a href="?sort-by=summary/@details">Summary</a>
              <a href="?sort-by=summary/@details&amp;sort-order=descending">(D)</a>
            </th>
            <th class="header" xml:space="preserve">
              <a href="?sort-by=created/@datetime">Created</a>
              <a href="?sort-by=created/@datetime&amp;sort-order=descending">(D)</a>
            </th>
          </tr>
        </thead>

        <!-- Body with hCalendar annotation (translating item types to hCalendar names) -->

        <tbody class="v{translate(@item-type, '-', '')}" template:element="item">

          <!-- Calendar -->

          <tr template:if="@item-type = 'calendar'">
            <!-- Copy this to the item types. -->
            <td width="10%">
              <input name="item={template:this-element()}" value="1" type="checkbox"/>
              <input template:attribute="item-value" name="{template:this-attribute()}" value="{$this-value}" type="hidden"/>
              <a template:attribute="item-type" template:value="$this-value" href="{template:choice(/items/@filtered, '../')}{template:url-encode($this-value)}/">item-type</a>
            </td>
            <!-- End generic section. -->
            <td class="row-header">
              Calendar
            </td>
            <td class="row-header">
              <a template:attribute="name" template:value="$this-value" href="?name={template:url-encode($this-value)}">name</a>
            </td>
          </tr>

          <!-- To-do (with hCalendar annotations within certain column elements) -->

          <tr template:if="@item-type = 'to-do' and (not(related-to) or /items/@related-to)">
            <!-- Copy this to the item types. -->
            <td width="10%">
              <input name="item={template:this-element()}" value="1" type="checkbox"/>
              <input template:attribute="item-value" name="{template:this-attribute()}" value="{$this-value}" type="hidden"/>
              <a template:attribute="item-type" template:value="$this-value" href="{template:choice(/items/@filtered, '../')}../{template:url-encode($this-value)}/">item-type</a>
            </td>
            <!-- End generic section. -->
            <td class="row-header">
              <span template:element="organizer" xml:space="preserve">
                <a template:attribute="uri" template:value="$this-value"
                  href="{template:choice(/items/@filtered, '../')}../person/{template:url-encode(template:url-encode($this-value))}/">uri</a>
              </span>
            </td>
            <td class="row-header">
              <span class="dtstart" title="{$this-value}" template:element="dtstart" template:attribute="datetime" template:value="$this-value">date</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'to-do' and (not(related-to) or /items/@related-to)">
            <td></td>
            <td xml:space="preserve">
              <span class="summary" template:element="summary" template:attribute="details" template:value="$this-value">summary</span>
              <a template:attribute="item-value" href="{template:choice(/items/@filtered, '../')}../to-do/{template:url-encode(template:url-encode($this-value))}/">(Edit)</a>
              <a template:attribute="item-value" href="{template:choice(/items/@filtered, '../')}../related-to/{template:url-encode(template:url-encode($this-value))}/">(Related)</a>
            </td>
            <td>
              <span template:element="created" template:attribute="datetime" template:value="$this-value">created</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'to-do' and (not(related-to) or /items/@related-to)">
            <td></td>
            <td class="message" colspan="2" template:value="$this-value" template:element="description" template:attribute="details">
              Message
            </td>
          </tr>

          <!-- Special hidden to-do entries for the hCalendar format. -->

          <tr style="display: none; visibility: collapse" template:if="@item-type = 'to-do' and (related-to and not(/items/@related-to))">
            <td>
              <span class="dtstart" title="{$this-value}" template:element="dtstart" template:attribute="datetime" template:value="$this-value">date</span>
              <span class="summary" template:element="summary" template:attribute="details" template:value="$this-value">summary</span>
            </td>
          </tr>

          <!-- Event (with hCalendar annotations within certain column elements) -->

          <tr template:if="@item-type = 'event'">
            <!-- Copy this to the item types. -->
            <td width="10%">
              <input name="item={template:this-element()}" value="1" type="checkbox"/>
              <input template:attribute="item-value" name="{template:this-attribute()}" value="{$this-value}" type="hidden"/>
              <a template:attribute="item-type" template:value="$this-value" href="{template:choice(/items/@filtered, '../')}../{template:url-encode($this-value)}/">item-type</a>
            </td>
            <!-- End generic section. -->
            <td class="row-header">
              <span template:element="organizer" xml:space="preserve">
                <a template:attribute="uri" template:value="$this-value"
                  href="{template:choice(/items/@filtered, '../')}../person/{template:url-encode(template:url-encode($this-value))}/">name</a>
              </span>
            </td>
            <td class="row-header" xml:space="preserve">
              <span class="dtstart" title="{$this-value}" template:element="dtstart" template:attribute="datetime" template:value="$this-value">date</span>
              to
              <span class="dtend" title="{$this-value}" template:element="dtend" template:attribute="datetime" template:value="$this-value">date</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'event'">
            <td></td>
            <td xml:space="preserve">
              <span class="summary" template:element="summary" template:attribute="details" template:value="$this-value">summary</span>
              <a template:attribute="item-value" href="{template:choice(/items/@filtered, '../')}../event/{template:url-encode(template:url-encode($this-value))}/">(Edit)</a>
            </td>
            <td>
              <span template:element="created" template:attribute="datetime" template:value="$this-value">created</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'event'">
            <td></td>
            <td class="message" colspan="2" template:value="$this-value" template:element="description" template:attribute="details">
              Message
            </td>
          </tr>

          <!-- Message -->

          <tr template:if="@item-type = 'message'">
            <!-- Copy this to the item types. -->
            <td width="10%">
              <input name="item={template:this-element()}" value="1" type="checkbox"/>
              <input template:attribute="item-value" name="{template:this-attribute()}" value="{$this-value}" type="hidden"/>
              <a template:attribute="item-type" template:value="$this-value" href="{template:choice(/items/@filtered, '../')}../{template:url-encode($this-value)}/">item-type</a>
            </td>
            <!-- End generic section. -->
            <td class="row-header">
              <a template:element="sender" template:attribute="name" template:value="$this-value"
                href="{template:choice(/items/@filtered, '../')}../person/{template:url-encode($this-value)}/">name</a>
            </td>
            <td class="row-header">
              <span template:element="sender" template:attribute="number" template:value="$this-value">number</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'message'">
            <td></td>
            <td>
              Text message
            </td>
            <td>
              <span template:element="created" template:attribute="datetime" template:value="$this-value">created</span>
            </td>
          </tr>
          <tr template:if="@item-type = 'message'">
            <td></td>
            <td class="message" colspan="2" template:value="$this-value" template:element="body" template:attribute="details">
              Message
            </td>
          </tr>

          <!-- Card -->

          <tr template:if="@item-type = 'card'">
            <!-- Copy this to the item types. -->
            <td width="10%">
              <input name="item={template:this-element()}" value="1" type="checkbox"/>
              <input template:attribute="item-value" name="{template:this-attribute()}" value="{$this-value}" type="hidden"/>
              <a template:attribute="item-type" template:value="$this-value" href="{template:choice(/items/@filtered, '../')}../{template:url-encode($this-value)}/">item-type</a>
            </td>
            <!-- End generic section. -->
            <td class="row-header">
              <span template:element="fn" template:attribute-area="details,replace">full name</span>
            </td>
            <td class="row-header">
              <a template:element="email" template:attribute="details" template:value="$this-value"
                href="{template:choice(/items/@filtered, '../')}../person/{template:url-encode(template:url-encode($this-value))}/">e-mail</a>
            </td>
          </tr>
          <tr template:if="@item-type = 'card'">
            <td></td>
            <td xml:space="preserve">
              <a template:element="url" template:attribute="details" template:value="$this-value"
                href="{template:choice(/items/@filtered, '../')}{$this-value}">name</a>
              <a template:attribute="item-value" href="{template:choice(/items/@filtered, '../')}../card/{template:url-encode(template:url-encode($this-value))}/">(Edit)</a>
            </td>
            <td>
              <ul>
                <li template:element="tel">
                  <span template:attribute="type" template:value="$this-value">type</span>:
                  <span template:attribute="details" template:value="$this-value">number</span>
                </li>
              </ul>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </form>
</body>
</html>
