<?xml version="1.0" encoding="iso-8859-1"?>
<D:multistatus xmlns:D="DAV:" xmlns:template="http://www.boddie.org.uk/ns/xmltools/template"
  template:element="items,table">
  <D:response template:if="not(/items/@leaf = 'yes')">
    <D:href template:value="$path"></D:href>
    <D:propstat>
      <D:prop>
        <D:creationdate>20050101</D:creationdate>
        <D:displayname template:value="$path"></D:displayname>
        <D:resourcetype>
          <D:collection/>
        </D:resourcetype>
      </D:prop>
      <D:status>HTTP/1.1 200 OK</D:status>
    </D:propstat>
  </D:response>
  <D:response template:element="item">
    <D:href template:if="not(/items/@filter-type = 'person') or /items/@person"
      template:value="concat($path, template:url-encode(template:url-encode(@item-value)))"></D:href>
    <D:href template:if="/items/@filter-type = 'person' and not(/items/@person)"
      template:value="concat($path, template:url-encode(template:url-encode(email/@details)))"></D:href>
    <D:propstat>
      <D:prop>
        <D:creationdate template:value="created/@datetime"></D:creationdate>
        <D:displayname template:if="@item-type = 'calendar'" template:value="@name"></D:displayname>
        <D:displayname template:if="@item-type = 'event'" template:value="summary/@details"></D:displayname>
        <D:displayname template:if="@item-type = 'to-do'" template:value="summary/@details"></D:displayname>
        <D:displayname template:if="@item-type = 'card'" template:value="fn/@details"></D:displayname>
        <D:displayname template:if="@item-type = 'message'" template:value="body/@details"></D:displayname>
        <D:resourcetype>
          <D:collection template:if="/items/@items-are-containers = 'yes'"/>
        </D:resourcetype>
        <D:getcontenttype template:if="not(/items/@items-are-containers = 'yes') and @item-type = 'calendar'">text/calendar</D:getcontenttype>
        <D:getcontenttype template:if="not(/items/@items-are-containers = 'yes') and @item-type = 'event'">text/calendar</D:getcontenttype>
        <D:getcontenttype template:if="not(/items/@items-are-containers = 'yes') and @item-type = 'to-do'">text/calendar</D:getcontenttype>
        <D:getcontenttype template:if="not(/items/@items-are-containers = 'yes') and @item-type = 'card'">text/x-vcard</D:getcontenttype>
        <D:getcontenttype template:if="not(/items/@items-are-containers = 'yes') and @item-type = 'message'">text/plain</D:getcontenttype>
        <D:getcontentlength template:if="not(/items/@items-are-containers = 'yes')">0</D:getcontentlength>
      </D:prop>
      <D:status>HTTP/1.1 200 OK</D:status>
    </D:propstat>
  </D:response>
</D:multistatus>
