<html xmlns:py="http://genshi.edgewall.org/">
  <head><title>Main :: Projects</title></head>
  <body>
    <div id="metanav" class="nav">
      <ul>
        <li py:if="username" class="first">logged in as $username</li>
        <li py:if="username">
          <a href="$base_url/logout">Logout</a>
        </li>
        <li py:if="not username" class="first">not currently logged in</li>
        <li py:if="not username">
          <a href="$base_url/login">Log In</a>
        </li>
        <li py:if="username"><a href="$base_url/paste">pastebin</a></li>
      </ul>

    </div>
    <div id="main">
      <script>
// <![CDATA[
function toggle_manage() {
    Element.toggleClassName($('manage-projects'), 'hidden');
    var els = Element.getElementsBySelector('project-list', 'INPUT');
    for (var x = 0; x < els.length; x++)
        Element.toggleClassName(els[x], 'hidden');
}
// ]]>
      </script>

      <div class="projects">
        <h2>Projects <a py:if="can_manage_projects" class="manage-link" href="javascript:toggle_manage()">(manage)</a></h2>
        <dl id="project-list">
          <div py:for="project in projects">
            <dt>
              <a href="/pm/p/${project.prjid}">${project.name}</a>
            </dt>
            <dd py:if="project.url">
              <a href="${project.url}">${project.url}</a>
            </dd>
            <dd py:if="project.description">
              ${project.description}
            </dd>
          </div>
        </dl>

        <i py:if="len(projects) == 0">
          There are currently no accessible projects.
        </i>
      </div>

      <div py:if="can_manage_projects" id="manage-projects" class="hidden">
        <div class="create-project">
          <h2>Create New Project</h2>

          <ul>
            <li><a href="/pm/readme">ClueMapper README</a></li>
          </ul>

          <form action="/pm/createproject" method="post">
            <fieldset>
              <legend>Project Info</legend>
              <div class="field project-name">
                <label for="prjid">Project Name</label>
                <p class="helper-note">You can use any characters in any case here,
                  a sensible lowercase url will be generated.</p>
                <input type="text" name="name" />
              </div>

              <div class="field theme">
                <label for="theme">Theme</label>
                <p class="helper-note"></p>
                <select name="theme">
                  <option py:for="theme in themes" value="$theme.themeid">$theme.name</option>
                </select>
              </div>

              <div class="actions">
                <input type="submit" name="submit" value="Create Project" />
              </div>
            </fieldset>
          </form>
        </div>
      </div>

      <span class="version">ClueMapper v$version</span>

      <div class="clear"><!-- clear --></div>
    </div>
  </body>
</html>
