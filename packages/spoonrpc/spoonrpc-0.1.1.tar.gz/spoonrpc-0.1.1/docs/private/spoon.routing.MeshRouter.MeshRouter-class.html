<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>spoon.routing.MeshRouter.MeshRouter</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css"></link>
</head>
<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">

<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="spoon-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <font size="-1"><b class="breadcrumbs">
        <a href="spoon-module.html">Package&nbsp;spoon</a> ::
        <a href="../private/spoon.routing-module.html">Package&nbsp;routing</a> ::
        <a href="../private/spoon.routing.MeshRouter-module.html">Module&nbsp;MeshRouter</a> ::
        Class&nbsp;MeshRouter
      </b></font></br>
    </td>
    <td><table cellpadding="0" cellspacing="0">
      <tr><td align="right"><font size="-2">[<b>show&nbsp;private</b>&nbsp;|&nbsp;hide&nbsp;private]</font></td></tr>
      <tr><td align="right"><font size="-2">[<a href="frames.html"target="_top">frames</a>&nbsp;|&nbsp;<a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html" target="_top">no&nbsp;frames</a>]</font></td></tr>
    </table></td>
</tr></table>

<!-- =========== START OF CLASS DESCRIPTION =========== -->
<h2 class="class">Type MeshRouter</h2>

<pre class="base-tree">
<a href="__builtin__.object-class.html"><code>object</code></a> --+
         |
        <b>MeshRouter</b>
</pre><br />

<hr/>

<p>This class handles LMTYPE_NETWORK messages and LMTYPE_NETWORK_PROTO 
messages. LMTYPE_NETWORK_PROTO is handled as a routing update, and 
LMTYPE_NETWORK will be handled as network traffic to be dealt with or 
routed.</p>
If there is a SingletonMessaging instance already created (e.g. 
through the use of the acceptMsg decorator) and messaging is None
<hr/>


<!-- =========== START OF METHOD SUMMARY =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Method Summary</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><a name="__init__"></a><span class="summary-sig"><span class="summary-sig-name">__init__</span>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>hub</span>,
          <span class=summary-sig-arg>messaging</span>)</span></code>
</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#addTransport" class="summary-sig-name"><code>addTransport</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>t</span>,
          <span class=summary-sig-arg>nodeId</span>)</span></code>
<br />
Handles the routing protocol initilization.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#handleLinkMessage" class="summary-sig-name"><code>handleLinkMessage</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>t</span>,
          <span class=summary-sig-arg>lm</span>)</span></code>
<br />
Called by the SpoonTransportThread when a link message has been 
received for one of our LMTYPEs.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><a name="handleNetworkTraffic"></a><span class="summary-sig"><span class="summary-sig-name">handleNetworkTraffic</span>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>t</span>,
          <span class=summary-sig-arg>obj</span>)</span></code>
</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#handleUpdate" class="summary-sig-name"><code>handleUpdate</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>t</span>,
          <span class=summary-sig-arg>update</span>,
          <span class=summary-sig-arg>localUpdate</span>)</span></code>
<br />
Handles a routing table update, builds the update message and sends it 
out to all except the src of the update.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#removeTransport" class="summary-sig-name"><code>removeTransport</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>t</span>)</span></code>
<br />
Removes the transport from the network.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#sendNetMsg" class="summary-sig-name"><code>sendNetMsg</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>dst</span>,
          <span class=summary-sig-arg>mtype</span>,
          <span class=summary-sig-arg>obj</span>)</span></code>
<br />
Sends a network message to the destination specified.</td></tr>
<tr bgcolor="#e8f0f8" class="group">
  <th colspan="2">&nbsp;&nbsp;&nbsp;&nbsp;Inherited from object</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__delattr__" class="summary-sig-name"><code>__delattr__</code></a>(<span class="summary-sig-vararg">...</span>)</span></code>
<br />
x.__delattr__('name') &lt;==&gt; del x.name</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__getattribute__" class="summary-sig-name"><code>__getattribute__</code></a>(<span class="summary-sig-vararg">...</span>)</span></code>
<br />
x.__getattribute__('name') &lt;==&gt; x.name</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__hash__" class="summary-sig-name"><code>__hash__</code></a>(<span class=summary-sig-arg>x</span>)</span></code>
<br />
x.__hash__() &lt;==&gt; hash(x)</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__new__" class="summary-sig-name"><code>__new__</code></a>(<span class=summary-sig-arg>T</span>,
          <span class=summary-sig-arg>S</span>,
          <span class="summary-sig-vararg">...</span>)</span></code>
<br />
T.__new__(S, ...) -&gt; a new object with type S, a subtype of T</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__reduce__" class="summary-sig-name"><code>__reduce__</code></a>(<span class="summary-sig-vararg">...</span>)</span></code>
<br />
helper for pickle</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__reduce_ex__" class="summary-sig-name"><code>__reduce_ex__</code></a>(<span class="summary-sig-vararg">...</span>)</span></code>
<br />
helper for pickle</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__repr__" class="summary-sig-name"><code>__repr__</code></a>(<span class=summary-sig-arg>x</span>)</span></code>
<br />
x.__repr__() &lt;==&gt; repr(x)</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__setattr__" class="summary-sig-name"><code>__setattr__</code></a>(<span class="summary-sig-vararg">...</span>)</span></code>
<br />
x.__setattr__('name', value) &lt;==&gt; x.name = value</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="__builtin__.object-class.html#__str__" class="summary-sig-name"><code>__str__</code></a>(<span class=summary-sig-arg>x</span>)</span></code>
<br />
x.__str__() &lt;==&gt; str(x)</td></tr>
</table><br />


<!-- =========== START OF INSTANCE VARIABLE SUMMARY =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Instance Variable Summary</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
<td><b><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#hub"><code>hub</code></a></b>: the TransportHub that the router is associated with, should be set at 
init time and never changed.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
<td><b><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#nodes"><code>nodes</code></a></b>: This is the routing table.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
<td><b><a href="../private/spoon.routing.MeshRouter.MeshRouter-class.html#transports"><code>transports</code></a></b>: A set of the transports that are currently active.</td></tr>
</table><br />


<!-- =========== START OF METHOD DETAILS =========== -->
<table class="details" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <th colspan="2">Method Details</th></tr>
</table>

<a name="addTransport"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">addTransport</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>t</span>,
          <span class=sig-arg>nodeId</span>)</span>
  </h3>
  Handles the routing protocol initilization. This involves first 
  exchanging routing tables entirely, then updating our routing table as 
  appropriate. While updating our routing table, we need to construct a 
  routing update message and send it to all transports other than the 
  transport being added.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>t</b></code> -
         The transport being added to the network
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="handleLinkMessage"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">handleLinkMessage</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>t</span>,
          <span class=sig-arg>lm</span>)</span>
  </h3>
  Called by the SpoonTransportThread when a link message has been 
  received for one of our LMTYPEs.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>t</b></code> -
         The transport that it came from
      <dd><code><b>lm</b></code> -
         The LinkMessage that came in.
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="handleUpdate"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">handleUpdate</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>t</span>,
          <span class=sig-arg>update</span>,
          <span class=sig-arg>localUpdate</span>=<span class=sig-default>None</span>)</span>
  </h3>
  Handles a routing table update, builds the update message and sends 
  it out to all except the src of the update.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>t</b></code> -
         The source transport from which the update came (in other 
        words where NOT to send our update)
      <dd><code><b>update</b></code> -
         A dict containing the routing update.
      <dd><code><b>localUpdate</b></code> -
         Only used in the specific case of when creating a new 
        transport. This will include an entry for the node we've just 
        connected to, so that it may be merged into the update sent out 
        to the other nodes.
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="removeTransport"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">removeTransport</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>t</span>)</span>
  </h3>
  Removes the transport from the network. This involves figuring out 
  which nodes are now unreachable (any routes we had over that 
  transport), removing any references to the transport from our routing 
  table, and updating our neighbors about our changed routing table.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>t</b></code> -
         The transport being removed from the network
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="sendNetMsg"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">sendNetMsg</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>dst</span>,
          <span class=sig-arg>mtype</span>,
          <span class=sig-arg>obj</span>)</span>
  </h3>
  Sends a network message to the destination specified. A NetMessage 
  object is constructed from the arguments provided to this method and 
  routed appropriately.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>dst</b></code> -
         The node id of the destination
      <dd><code><b>mtype</b></code> -
         The message type (probably NMTYPE_MESSAGE)
      <dd><code><b>obj</b></code> -
         The object attachment of the NetMessage
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>
<br />


<!-- =========== START OF INSTANCE VARIABLE DETAILS =========== -->
<table class="details" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <th colspan="2">Instance Variable Details</th></tr>
</table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="hub"></a>
<h3>hub</h3>
the TransportHub that the router is associated with, should be set at 
init time and never changed.
</td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="nodes"></a>
<h3>nodes</h3>
This is the routing table. It's a dictionary whose keys are node ids, 
and the values are a tuple consisting of the hop count to the node and 
the transport used to get there.
</td></tr></table>
<table width="100%" class="var-details" bgcolor="#e0e0e0"><tr><td>
<a name="transports"></a>
<h3>transports</h3>
A set of the transports that are currently active.
</td></tr></table>
<br />


<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="spoon-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td align="left"><font size="-2">Generated by Epydoc 2.1 on Sun Nov 26 15:33:58 2006</font></td>
    <td align="right"><a href="http://epydoc.sourceforge.net"
                      ><font size="-2">http://epydoc.sf.net</font></a></td>
  </tr>
</table>
</body>
</html>
