<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>Manager objects</title>
<link rel="stylesheet" href="html4css1.css" type="text/css" />
</head>
<body>
<div class="header">
<a class="reference" href="process-objects.html">Prev</a> &nbsp; &nbsp; &nbsp; &nbsp; <a class="reference" href="processing-ref.html">Up</a> &nbsp; &nbsp; &nbsp; &nbsp; <a class="reference" href="proxy-objects.html">Next</a>
<hr class="header"/>
</div>
<div class="document" id="manager-objects">
<h1 class="title">Manager objects</h1>
<p>The manager classes are defined in the <tt class="docutils literal"><span class="pre">processing.managers</span></tt> module.</p>
<div class="section">
<h1><a id="basemanager" name="basemanager">BaseManager</a></h1>
<p><tt class="docutils literal"><span class="pre">BaseManager</span></tt> is the base class for all manager classes and does not
have any methods which create shared objects.  The only public method
the class has is</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">shutdown()</span></tt></dt>
<dd><p class="first">Stop the process used by the manager.</p>
<p class="last">This can be called multiple times.</p>
</dd>
</dl>
</blockquote>
<p>In addition <tt class="docutils literal"><span class="pre">BaseManager</span></tt> supports the <em>context manager protocol</em>
and has a <tt class="docutils literal"><span class="pre">__del__</span></tt> method to ensure that <tt class="docutils literal"><span class="pre">shutdown()</span></tt> does
eventually get called.</p>
<p>The creation of managers which support arbitrary types is discussed in
<a class="reference" href="#customized-managers">Customized managers</a>.</p>
</div>
<div class="section">
<h1><a id="syncmanager" name="syncmanager">SyncManager</a></h1>
<p><tt class="docutils literal"><span class="pre">SyncManager</span></tt> is a subclass of <tt class="docutils literal"><span class="pre">BaseManager</span></tt> which can be used for
the synchronization of processes.  Objects of this type are returned
by <tt class="docutils literal"><span class="pre">processing.Manager()</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">SyncManager</span></tt> supports a number of additional methods for creating
shared objects, each of which creates a proxy object:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">BoundedSemaphore(value=1)</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">threading.BoundedSemaphore</span></tt> object and
returns a proxy for it.</dd>
<dt><tt class="docutils literal"><span class="pre">Condition(lock=None)</span></tt></dt>
<dd><p class="first">Creates a shared <tt class="docutils literal"><span class="pre">threading.Condition</span></tt> object and returns a
proxy for it.</p>
<p class="last">If <tt class="docutils literal"><span class="pre">lock</span></tt> is supplied then it should be a proxy for a
<tt class="docutils literal"><span class="pre">threading.Lock</span></tt> or <tt class="docutils literal"><span class="pre">threading.RLock</span></tt> object.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">Event()</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">threading.Event</span></tt> object and returns a proxy
for it.</dd>
<dt><tt class="docutils literal"><span class="pre">Lock()</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">threading.Lock</span></tt> object and returns a proxy
for it.</dd>
<dt><tt class="docutils literal"><span class="pre">Namespace()</span></tt></dt>
<dd><p class="first">Creates a shared <tt class="docutils literal"><span class="pre">processing.managers.Namespace</span></tt> object and returns a
proxy for it.</p>
<p class="last">See <a class="reference" href="#namespace-objects">Namespace objects</a>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">Queue(maxsize=0)</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">Queue.Queue</span></tt> object and returns a proxy for
it.</dd>
<dt><tt class="docutils literal"><span class="pre">RLock()</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">threading.RLock</span></tt> object and returns a proxy
for it.</dd>
<dt><tt class="docutils literal"><span class="pre">Semaphore(value=1)</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">threading.Semaphore</span></tt> object and returns a
proxy for it.</dd>
<dt><tt class="docutils literal"><span class="pre">dict()</span></tt>, <tt class="docutils literal"><span class="pre">dict(mapping)</span></tt>, <tt class="docutils literal"><span class="pre">dict(sequence)</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">dict</span></tt> object and returns a proxy for it.</dd>
<dt><tt class="docutils literal"><span class="pre">list()</span></tt>, <tt class="docutils literal"><span class="pre">list(sequence)</span></tt></dt>
<dd>Creates a shared <tt class="docutils literal"><span class="pre">list</span></tt> object and returns a proxy for it.</dd>
</dl>
</blockquote>
<div class="admonition-namespace-objects admonition">
<p class="first admonition-title"><span class="target" id="namespace-objects">Namespace objects</span></p>
<p>A namespace object has no public methods but does have writable
attributes.  Its representation shows the values of its public
attributes (i.e. those attributes whose names do not begin with '_').</p>
<p>However, when using a proxy for a namespace object, attributes
beginning with '_' will be stored on the proxy object and not on
the target:</p>
<pre class="last literal-block">
&gt;&gt;&gt; manager = processing.Manager()
&gt;&gt;&gt; Global = manager.Namespace()
&gt;&gt;&gt; Global.x = 10
&gt;&gt;&gt; Global.y = 'hello'
&gt;&gt;&gt; Global._z = 12.3    # this is an attribute of the proxy
&gt;&gt;&gt; print Global
Namespace(x=10, y='hello')
</pre>
</div>
</div>
<div class="section">
<h1><a id="customized-managers" name="customized-managers">Customized managers</a></h1>
<p>To create one's own manager one creates a subclass <tt class="docutils literal"><span class="pre">BaseManager</span></tt>.</p>
<p>To enable the subclass to create new types of shared objects one adds
instance methods to the subclass using the following function:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">CreatorMethod(callable,</span> <span class="pre">proxytype=None,</span> <span class="pre">exposed=None)</span></tt></dt>
<dd><p class="first">Returns a function with signature <tt class="docutils literal"><span class="pre">func(self,</span> <span class="pre">*args,</span>
<span class="pre">**kwds)</span></tt> which will create a shared object using the manager
<tt class="docutils literal"><span class="pre">self</span></tt> and return a proxy for it.  The shared objects will
be created by evaluating <tt class="docutils literal"><span class="pre">callable(*args,</span> <span class="pre">**kwds)</span></tt> in the
manager process.</p>
<p>The arguments are:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">callable</span></tt></dt>
<dd>The callable used to create a shared object.</dd>
<dt><tt class="docutils literal"><span class="pre">proxytype</span></tt></dt>
<dd><p class="first">The type of the proxy which will be returned by the
returned method.</p>
<p>If <tt class="docutils literal"><span class="pre">proxytype</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> then a new proxy type is
automatically created (or a cached one is reused).</p>
<p class="last">The methods of the shared object which will be exposed via
the proxy are determined by the <tt class="docutils literal"><span class="pre">exposed</span></tt> argument, see
below.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">exposed</span></tt></dt>
<dd><p class="first">The list of names of the methods of the objects returned
by <tt class="docutils literal"><span class="pre">callable</span></tt> which should be exposed via the proxy if
<tt class="docutils literal"><span class="pre">proxytype</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p class="last">If <tt class="docutils literal"><span class="pre">exposed</span></tt> and <tt class="docutils literal"><span class="pre">proxytype</span></tt> are both <tt class="docutils literal"><span class="pre">None</span></tt> then
all public methods <a class="footnote-reference" href="#id2" id="id1" name="id1">[1]</a> of objects returned by
<tt class="docutils literal"><span class="pre">callable</span></tt> will be exposed via their proxies.</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>For example:</p>
<pre class="literal-block">
from processing.managers import BaseManager, CreatorMethod

class FooClass(object):
    def bar(self):
        print 'BAR'
    def baz(self):
        print 'BAZ'

class NewManager(BaseManager):
    Foo = CreatorMethod(FooClass)

if __name__ == '__main__':
    manager = NewManager()
    foo = manager.Foo()
    foo.bar()               # prints 'BAR'
    foo.baz()               # prints 'BAZ'
    manager.shutdown()
</pre>
<p>See <a class="reference" href="../test/test_newtype.py">test_newtype.py</a> for more examples.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1" name="id2">[1]</a></td><td>A public method is one whose name does not begin with '_'.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="process-objects.html">Prev</a> &nbsp; &nbsp; &nbsp; &nbsp; <a class="reference" href="processing-ref.html">Up</a> &nbsp; &nbsp; &nbsp; &nbsp; <a class="reference" href="proxy-objects.html">Next</a>
</div>
</body>
</html>
