<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="DigestoContentTypes">

<head>
    <title></title>
</head>

<body>

    <!-- Selection Widgets -->

    <metal:define define-macro="edit">

        <metal:use use-macro="field_macro|context/widgets/field/macros/edit">

            <metal:fill fill-slot="widget_body"
                        tal:define="view context/@@typestools;
                                    req_kind python: request.get('kind');
                                    req_source python: request.get('source');
                                    vocab python:view.get_vocabulary_for('area_kinds', here, req_kind=req_kind, req_source=req_source, include_current=True);
                                    allowed_kinds python:view.get_vocabulary_for('area_kinds', here,  req_kind=req_kind, req_source=req_source);
                                    vlen python:len(vocab);
                                    selectionview context/@@at_selection_widget;
                                    selection python:selectionview.getSelected(vocab, value);
                                    format python:widget.format;
                                    kind python:request.get('kind') or context.getKind()">

                    <select tal:attributes="name fieldName;
                                            id fieldName;
                                            class string:sourceorkind">

                        <option tal:repeat="item vocab"
                                tal:condition="kind"
                                tal:attributes="value item;
                                                selected python:item in selection and 'selected' or None"
                                tal:content="python:vocab.getValue(item)"
                                i18n:translate=""
                                />
                        <option tal:condition="not: kind"
                                i18n:translate="item_select_source_first"
                                value=""
                                >Select a Source First
                        </option>

                    </select>
                <div id="disallowedkind">
                    <tal:disallowedkind tal:condition="python: kind and kind not in allowed_kinds">
                    <p tal:content="string: Current kind is: ${kind}, and it can't be provided by current source">
                    </p>
                    </tal:disallowedkind>
                </div>
            </metal:fill>

        </metal:use>

    </metal:define>


</body>

</html>
