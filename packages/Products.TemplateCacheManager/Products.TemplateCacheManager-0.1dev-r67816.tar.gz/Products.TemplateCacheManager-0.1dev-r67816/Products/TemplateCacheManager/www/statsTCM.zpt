<div tal:replace="structure here/manage_page_header" />
  <h2 tal:define="manage_tabs_message request/manage_tabs_message | options/manage_tabs_message | nothing;
                  management_view options/management_view|nothing"
        tal:replace="structure here/manage_tabs">
      Tabs
  </h2>
  <p class="form-help">
    Memory usage is approximate. It is based on the pickled value of the 
    cached data. The cache is cleaned up by removing the least frequently 
    accessed entries since the last cleanup operation. The determination 
    is made using the <em>recent hits</em> counter.
  </p>


<tal:report tal:define="cacheReport nocall: context/getCacheReport">
  <tal:block tal:condition="cacheReport" >
  <form method="post" action="manage_invalidate">

    <table width="100%" cellspacing="0" cellpadding="2" border="0">
    <tr class="list-header">
      <td align="left" valign="top" class="list-nav" width="16">
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Context Path', 'context_path')">
	 Context Path
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Template Path', 'template_path')">
         Template Path 
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Hits', 'hits')">
         Hits
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Recent Hits', 'counter')">
         Recent Hits
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Misses', 'misses')">
         Misses
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Memory', 'size')">
         Memory
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Views', 'views')">
         Views
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-nav" tal:content="structure python: context.sort_link('Entries', 'entries')">
         Entries
      </div>
      </td>
    </tr>
    <tal:listing repeat="item cacheReport">
      <tr class="" tal:attributes="class python: test(repeat['item'].odd,'row-normal','row-hilite')">
      <td align="left" valign="top" width="16">
        <input type="checkbox" name="paths:list" value="" 
               tal:attributes="value string:${item/template_path}:${item/context_path}"/>
      </td>
      <td align="left" valign="top">
      <div class="list-item">
      <a href="" tal:content="item/context_path" tal:attributes="href string:${item/context_path}/manage_workspace">context_path</a>
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item">
      <a href="" tal:content="item/template_path" tal:attributes="href string:${item/template_path}/ZCacheable_manage">template_path</a>    
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item" tal:content="item/hits">
        hits
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item" tal:content="item/counter">
        counter
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item" tal:content="item/misses">
        misses
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item" tal:content="item/size">
        size
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item" tal:content="python: ', '.join(item['views'])">
        views
      </div>
      </td>
      <td align="left" valign="top">
      <div class="list-item"  tal:content="item/entries">
           entries
      </div>
      </td>
      </tr>
    </tal:listing>
    
      <tr>
        <td width="16"> </td>
        <td colspan="7">
          <input type="submit" value=" Remove " />
        </td>
      </tr>
    
    </table>

  </form>
</tal:block>
<tal:block tal:condition="not: cacheReport" >
  <p class="form-text">
  <strong>Nothing is in the cache.</strong>
  </p>
</tal:block> 
</tal:report>

<div tal:replace="structure here/manage_page_header" />
