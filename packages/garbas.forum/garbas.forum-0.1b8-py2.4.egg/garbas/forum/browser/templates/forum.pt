
<div tal:replace="structure provider:plone.abovecontenttitle" />

<h1 class="documentFirstHeading" 
    tal:content="context/title">
    Forum title
</h1>

<div tal:replace="structure provider:plone.belowcontenttitle" />
<div tal:replace="structure provider:plone.abovecontentbody" />


<div id="forum-topics">

    <ul class="forum-actions">
        <li tal:condition="view/has_permissions_to_addtopic">
            <div id="forum-topic-add-topic">
                <form method="get" 
                      action="@@add_topic">
                    <input class="context"
                           value="New Topic" 
                           type="submit"
                           i18n:attributes="value add_topic"/>
                </form>
            </div>
        </li>
    </ul>

    <div class="forum-content"
         tal:condition="view/has_topics"
         tal:define="batch view/topics_batch">

        <div class="forum-topic-batch"
             tal:condition="python: batch.next or batch.previous">
            <div metal:use-macro="here/batch_macros/macros/navigation" />
        </div>

        <table class="listing"
               summary="Topics listing">
            <tr>
                <th class="listing_col1" i18n:translate="topics">Topics</th>
                <th class="listing_col2" i18n:translate="replies">Replies</th>
                <th class="listing_col3" i18n:translate="last_post">Last Post</th>
            </tr>
            <tal:item repeat="item batch">
                <tr tal:define="oddrow repeat/item/odd;"
                    tal:attributes="class python:oddrow and 'even' or 'odd'">
                    <td class="listing_col1_context">
                        <img class="listing_status"
                             src="++resource++garbas.forum.images/read_post.gif" />
                        <a class="listing_main_context"
                           tal:attributes="href item/url"
                           tal:content="item/title">Topic Title</a>
                        <div class="documentByLine">
                            <span class="documentAuthor"
                                  i18n:translate="label_by_author">by
                                <a tal:condition="item/author"
                                   tal:attributes="href string:${view/site_url}/author/${item/author};
                                                   class string:author"
                                   tal:content="item/author">author of the topic</a>
                            </span>
                            <span class="documentModified">
                                &mdash;
                                <span i18n:translate="box_created">
                                    created
                                </span>
                                <span tal:replace="python:context.toLocalizedTime(item['created'], long_format=1)">
                                    August 16, 2001 at 23:35:59
                                </span>
                            </span>
                        </div>
                    </td>
                    <td class="listing_col2_context"
                        tal:content="item/replies" />
                    <td class="documentByLine listing_col3_context">
                        <tal:author condition="item/last_author">
                            <span class="documentAuthor"
                                  i18n:translate="label_by_author">by
                                <a tal:condition="item/last_author"
                                   tal:attributes="href string:${view/site_url}/author/${item/last_author};
                                                   class string:author"
                                   tal:content="item/last_author">last author of the topic</a>
                            </span>
                            <a href="#" alt="View the latest post"
                               tal:attributes="href item/last_post_url"
                               i18n:attributes="alt view_latest_post">
                                <img src="++resource++garbas.forum.images/last_post.gif" />
                            </a>
                            <div class="documentModified">
                                <span i18n:translate="on">on</span>
                                <span tal:replace="python:context.toLocalizedTime(item['last_post_date'], long_format=1)">
                                    August 16, 2001 at 23:35:59
                                </span>
                            </div>
                        </tal:author>
                    </td>
                </tr>
            </tal:item>
        </table>

    </div>

</div>


<div id="forum-subforums" 
     tal:condition="view/has_subforums">

    <div class="forum-content"
         tal:repeat="category view/subforums">

        <table class="listing" summary="Subforums listing">
            <tr>
                <th class="listing_col1" tal:content="category/title">Subforum</th>
                <th class="listing_col2" i18n:translate="topics">Topics</th>
                <th class="listing_col2" i18n:translate="posts">Posts</th>
                <th class="listing_col3" i18n:translate="last_post">Last Post</th>
            </tr>

            <tal:items repeat="item category/forums">

                <tr tal:define="oddrow repeat/item/odd;"
                    tal:attributes="class python:oddrow and 'even' or 'odd'">
                    <td class="listing_col1_context">
                        <img class="listing_status"
                             src="++resource++garbas.forum.images/read_post.gif" />
                        <a class="listing_main_context"
                           tal:attributes="href item/url">
                            <span tal:content="item/title">Subforum Title</span>
                            <p class="documentByLine"
                               tal:content="item/description">
                                Description
                            </p>
                        </a>
                    </td>
                    <td class="listing_col2_context" tal:content="item/topics" />
                    <td class="listing_col2_context" tal:content="item/posts" />
                    <td class="documentByLine listing_col3_context"> 
                        <tal:author condition="item/last_author">
                            <span i18n:translate="by">by</span>
                            <a href="#"
                               tal:attributes="href string:${view/site_url}/author/${item/last_author};
                                               class string:author"
                               tal:content="item/last_author">
                               Last Forum Author
                            </a>
                            <a href="#"
                               tal:attributes="href item/last_post_url">
                                <img src="++resource++garbas.forum.images/last_post.gif" />
                            </a>
                            <div class="details">
                                <span i18n:translate="on">on</span> 
                                <span tal:content="python:context.toLocalizedTime(item['last_post_date'], long_format=1)" />
                            </div>
                        </tal:author>    
                    </td>
                </tr>
    
            </tal:items>
        </table>
    </div>

</div>
              
<div tal:replace="structure provider:plone.belowcontentbody" />

