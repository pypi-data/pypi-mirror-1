<configure
   xmlns="http://namespaces.zope.org/zope"
   xmlns:browser="http://namespaces.zope.org/browser"
   xmlns:five="http://namespaces.zope.org/five"
   xmlns:cmf="http://namespaces.zope.org/cmf"
   xmlns:genericsetup="http://namespaces.zope.org/genericsetup"
   xmlns:plone="http://namespaces.plone.org/plone"
   i18n_domain="collective.formcriteria">

  <include package="plone.app.contentmenu" />

  <browser:resource
     name="formcriteria.kss"
     file="formcriteria.kss"
     />

  <browser:viewlet
     layer=".interfaces.IFormCriteriaLayer"
     name="collective.formcriteria.htmlhead"
     manager="plone.app.layout.viewlets.interfaces.IHtmlHeadLinks"
     class=".form.SearchFormHeadView"
     template="form-htmlhead.pt"
     permission="zope2.View" 
     />
  
  <browser:page
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     name="criteria_form"
     class=".form.SearchFormView"
     template="form.pt"
     permission="zope2.View" 
     />

  <browser:menuItem
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     menu="plone_displayviews"
     title="Search Form"
     action="criteria_form"
     description="Renders the expanded criteria search form" />
  
  <browser:page
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     name="formcriteria_macros"
     template="form_macros.pt"
     permission="zope2.View" />

  <plone:portlet
     name="collective.formcriteria.CriteriaFormPortlet"
     interface=".portlet.ICriteriaFormPortlet"
     assignment=".portlet.Assignment"
     renderer=".portlet.Renderer"
     view_permission="zope2.View"
     edit_permission="cmf.ManagePortal"
     addview=".portlet.AddForm"
     editview=".portlet.EditForm" />

  <browser:page
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     name="sort_info"
     class=".sort.SortView"
     permission="zope2.View" />

  <browser:page
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     class=".foldercontents.FolderContentsView"
     name="folder_contents_view"
     template="foldercontents.pt"
     permission="cmf.ListFolderContents" />

  <browser:menuItem
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     menu="plone_displayviews"
     title="Tabular Form"
     action="folder_contents_view"
     description="List items in a tabular form including object buttons" />

  <browser:page
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     class=".grouped.GroupedListingView"
     name="grouped_listing"
     template="grouped.pt"
     permission="cmf.ListFolderContents" />

  <browser:menuItem
     for=".interfaces.IFormTopic"
     layer=".interfaces.IFormCriteriaLayer"
     menu="plone_displayviews"
     title="Grouped Listing"
     action="grouped_listing"
     description="Lists items grouped by the sort used" />

  <browser:page
     for="*"
     layer=".interfaces.IFormCriteriaLayer"
     name="comma_widget"
     class=".comma.CommaWidgetView"
     template="comma.pt"
     permission="zope2.View" />

  <cmf:registerDirectory name="formcriteria"/>

  <genericsetup:registerProfile
     name="default"
     title="Form Criteria"
     description="Add forms for user enterable search criteria to collections/topic/smart folders."
     provides="Products.GenericSetup.interfaces.EXTENSION"
     />
  
  <five:registerPackage package="." initialize=".initialize" />

</configure>
