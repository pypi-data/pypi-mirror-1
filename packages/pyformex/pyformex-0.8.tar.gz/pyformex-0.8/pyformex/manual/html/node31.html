<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="STYLESHEET" href="pyformex.css" type='text/css' />
<link rel="SHORTCUT ICON" href="../favicon.ico" />
<link rel='start' href='http://pyformex.berlios.de' title='pyFormex home Page' />
<link rel="first" href="pyformex.html" title='pyFormex manual' />
<link rel='last' href='about.html' title='About this document...' />
<link rel='help' href='about.html' title='About this document...' />
<link rel="next" href="node32.html" />
<link rel="prev" href="node30.html" />
<link rel="parent" href="node30.html" />
<link rel="next" href="node32.html" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name='aesop' content='information' />
<title>2.4.1 General properties</title>
</head>
<body>
<div class="navigation">
<div id='top-navigation-panel' xml:id='top-navigation-panel'>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="2.4 assigning properties to"
  href="node30.html"><img src='previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="2.4 assigning properties to"
  href="node30.html"><img src='up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="2.4.2 using the set"
  href="node32.html"><img src='next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">pyFormex manual</td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><a rel="index" title="Index"
  href="genindex.html"><img src='index.png'
  border='0' height='32'  alt='Index' width='32' /></a></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="node30.html">2.4 Assigning properties to</a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="node30.html">2.4 Assigning properties to</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="node32.html">2.4.2 Using the set</a>
</div>
<hr /></div>
</div>
<!--End of Navigation Panel-->

<h2><a name="SECTION003410000000000000000"></a>
<a name="sec:general-properties"></a>
<br>
2.4.1 General properties
</h2>

<p>
Now you can start entering property records into the database. A property record is a lot like a Python dict object, and thus it can contain nearly anything. It is implemented however as a <tt class="class">CascadingDict</tt> object, which means that the key values are strings and can also be used as attributes to address the value. Thus, if <tt><small class="SMALL">P</small></tt> is a property record, then a field named <tt><small class="SMALL">key</small></tt> can either be addressed as <tt><small class="SMALL">P['key']</small></tt> or as <tt><small class="SMALL">P.key</small></tt>. This implementation was choosen for the convenience of the user, but has no further advantages over a normal dict object. You should not use any of the methods of Python's dict class as key in a property record: it would override this method for the object.

<p>
The property record has four more reserved (forbidden) keys: <tt><small class="SMALL">kind</small></tt>, <tt><small class="SMALL">tag</small></tt>, <tt><small class="SMALL">set</small></tt>, <tt><small class="SMALL">setname</small></tt> and <tt><small class="SMALL">nr</small></tt>. The <tt><small class="SMALL">kind</small></tt> and <tt><small class="SMALL">nr</small></tt> should never be set nor changed by the user. <tt><small class="SMALL">kind</small></tt> is used internally to distinguish among different kind of property records (see <a href="node34.html#sec:node-properties">2.4.4</a>). It should only be used to extend the <tt class="class">PropertyDB</tt> class with new kinds of properties, e.g. in subclasses. <tt><small class="SMALL">nr</small></tt> will be set automatically to a unique record number. Some application modules use this number for identification and to create automatic names for property sets. 

<p>
The <tt><small class="SMALL">tag</small></tt>, <tt><small class="SMALL">set</small></tt> and <tt><small class="SMALL">setname</small></tt> keys are optional fields and can be set by the user. They should however only be used for the intended purposes explained hereafter, because they have a special meaning for the database methods and application modules.

<p>
The <tt><small class="SMALL">tag</small></tt> field can be used to attach an identification string to the property record. This string can be as complex as the user wants and its interpretation is completely left to the user. The <tt class="class">ProeprtyDB</tt> class just provides an easy way to select the records by their <tt><small class="SMALL">tag</small></tt> name or by a set of tag names. The <tt><small class="SMALL">set</small></tt> and <tt><small class="SMALL">setname</small></tt> fields are treated further in <a href="node32.html#sec:set-and-setname">2.4.2</a>.

<p>
So let's create a property record in our database. The <tt><small class="SMALL">Prop()</small></tt> method does just that. It also returns the property record, so you can directly use it further in your code.
<div class="verbatim"><pre>
&gt;&gt;&gt; Stick = P.Prop(color='green',name='Stick',weight=25, \
        comment='This could be anything: a gum, a frog, a usb-stick,...'})
&gt;&gt;&gt; print Stick

  color = green
  comment = This could be anything: a gum, a frog, a usb-stick,...
  nr = 0
  name = Stick
  weight = 25
</pre></div>
Notice the auto-generated <tt><small class="SMALL">nr</small></tt> field. Here's another example, with a tag:
<div class="verbatim"><pre>
&gt;&gt;&gt; author = P.Prop(tag='author',name='Alfred E Neuman',\
        address=CascadingDict({'street':'Krijgslaan', 'city':'Gent','country':'Belgium'}))
&gt;&gt;&gt; print author

  nr = 1
  tag = author
  name = Alfred E Neuman
  address = 
    city = Gent
    street = Krijgslaan
    country = Belgium
</pre></div>
This example shows that record values can be complex structured objects.
Notice how the <tt class="class">CascadingDict</tt> object is by default printed in a very readible layout, offsetting each lower level dictionary two more postions to the right. 

<p>
The <tt class="class">CascadingDict</tt> has yet another fine characteristic: if an attribute is not found in the toplevel, all values that are instances of <tt class="class">CascadingDict</tt> or <tt class="class">Dict</tt> (but not the normal Python dict) will be searched for the attribute. If needed, this searching is even repeated in the values of the next levels, and further on, thus cascading though all levels of <tt class="class">CascadingDict</tt> structures until the attribute can eventually be found. The cascading does not proceed through values in a <tt class="class">Dict</tt>. An attribute that is not found in any of the lower level dictionaries, will return a <tt><small class="SMALL">None</small></tt> value.

<p>
If you set an attribute of a <tt class="class">CascadingDict</tt>, it is always set in the toplevel. If you want to change lower level attributes, you need to use the full path to it.
<div class="verbatim"><pre>
&gt;&gt;&gt; print author.street
  Krijgslaan
&gt;&gt;&gt; author.street = 'Voskenslaan'
&gt;&gt;&gt; print author.street
  Voskenslaan
&gt;&gt;&gt; print author.address.street
  Krijgslaan
&gt;&gt;&gt; author.address.street = 'Wiemersdreef'
&gt;&gt;&gt; print author.address.street
  Wiemersdreef
&gt;&gt;&gt; author = P.Prop(tag='author',alias='John Doe',\
        address={'city': 'London', 'street': 'Downing Street 10', 'country': 'United Kingdom'})
&gt;&gt;&gt; print author

  nr = 2
  tag = author
  alias = John Doe
  address = {'city': 'London', 'street': 'Downing Street 10', 'country': 'United Kingdom'}
</pre></div>

<p>
In the examples above, we have given a name to the created property records, so that we could address them in the subsequent print and field assigment statements. In most cases however, it will be impractical and unnecessary to give your records a name. They all are recorded in the <tt class="class">PropertyDB</tt> database, and will exist as long as the database variable lives. There should be away though to request selected data from that database. The <tt class="method">getProp()</tt> method returns a list of records satisfying some conditions. The examples below show how it can be used.

<p>
<div class="verbatim"><pre>
&gt;&gt;&gt; for p in P.getProp(rec=[0,2]):
        print p.name
Stick
John Doe
&gt;&gt;&gt;  for p in P.getProp(tag=['author']):
        print p.name
None
John Doe
&gt;&gt;&gt;  for p in P.getProp(attr=['name']):
        print p.nr
0
2
&gt;&gt;&gt;  for p in P.getProp(tag=['author'],attr=['name']):
        print p.name
John Doe
</pre></div>
The first call selects records by number: either a single record number or a list of numbers can be specified. The second method selects records based on the value of their tag field. Again a single tag value or a list of values can be specified. Only those records having a 'tag' filed matching any of the values in the list will be returned. The third selection method is based on the existence of some attribute names in the record. Here, always a list of attribute names is required. Records are returned that posess all the attributes in the list, independent from the value of those attributes. If needed, the user can add a further filtering based on the attribute values. Finally, as is shown in the last example, all methods of record selection can be combined. Each extra condition will narrow the selection further down.

<p>

<div class="navigation">
<div class='online-navigation'>
<p></p><hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="2.4 assigning properties to"
  href="node30.html"><img src='previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="2.4 assigning properties to"
  href="node30.html"><img src='up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="2.4.2 using the set"
  href="node32.html"><img src='next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">pyFormex manual</td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><a rel="index" title="Index"
  href="genindex.html"><img src='index.png'
  border='0' height='32'  alt='Index' width='32' /></a></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="node30.html">2.4 Assigning properties to</a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="node30.html">2.4 Assigning properties to</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="node32.html">2.4.2 Using the set</a>
</div>
</div>
<hr />
<span class="release-info">Release 0.8-a1, documentation updated on 9 June 2009.</span>
</div>
<!--End of Navigation Panel-->

</body>
</html>
