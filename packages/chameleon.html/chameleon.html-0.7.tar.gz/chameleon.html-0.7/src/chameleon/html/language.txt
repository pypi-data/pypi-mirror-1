XSS template language
=====================

This language is used internally by the template compiler.

  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div xss:content="document-content">
  ...      <span>Default content</span>
  ...   </div>
  ... </html>""", content={'document-content': u"Dynamic content"})
  <html>
    <div>Dynamic content</div>
  </html>

If we omit the slot from the passed content argument, the element is
left untouched.
  
  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div xss:content="document-content">
  ...      <span>Default content</span>
  ...   </div>
  ... </html>""", content={})
  <html>
    <div>
       <span>Default content</span>
    </div>
  </html>

If the xss:omit attribute is set, the tag will be replaced by the dynamic content.
  
  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div xss:content="document-content" xss:omit="true">
  ...      <span>Default content</span>
  ...   </div>
  ... </html>""", content={'document-content': u"Dynamic content"})
  <html>
    Dynamic content
  </html>

When the xss:structure attribute is set, the dynamic content is not
escaped.
  
  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div xss:content="document-content" xss:structure="true">
  ...      <span>Default content</span>
  ...   </div>
  ... </html>""", content={'document-content': u"<span>Dynamic content</span>"})
  <html>
    <div><span>Dynamic content</span></div>
  </html>

Attributes may be dynamically applied to elements using the
xss:attributes.

  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div xss:attributes="example">
  ...      Content
  ...   </div>
  ... </html>""", attributes={'example': {'class': 'example-class'}})
  <html>
    <div class="example-class">
       Content
    </div>
  </html>

As a special case, if "class" is a dynamic attribute, it will not
override an existing "class" attribute on the element, but extend it
(concatenate with a space character).
  
  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div id="existing" class="existing-class" xss:attributes="example">
  ...      Content
  ...   </div>
  ...   <span xss:attributes="example">
  ...      Content
  ...   </span>
  ... </html>""", attributes={'example': {'id': 'new', 'class': 'additional-class'}})
  <html>
    <div id="new" class="existing-class additional-class">
       Content
    </div>
    <span id="new" class="additional-class">
       Content
    </span>
  </html>

We can supply multiple dynamic attribute identifiers, separated by a
comma.
  
  >>> print render_xss("""\
  ... <html xmlns="http://www.w3.org/1999/xhtml"
  ...       xmlns:xss="http://namespaces.repoze.org/xss">
  ...   <div id="existing" class="existing-class" xss:attributes="example1, example2">
  ...      Content
  ...   </div>
  ... </html>""", attributes={'example1': {'class': 'foo', 'style': 'bar'},
  ...                         'example2': {'class': 'bar', 'style': 'foo'}})
  <html>
    <div style="foo" id="existing" class="existing-class foo bar">
       Content
    </div>
  </html>
