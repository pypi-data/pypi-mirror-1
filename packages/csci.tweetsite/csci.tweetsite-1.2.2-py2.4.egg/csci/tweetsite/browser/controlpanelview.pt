<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="csci.tweetsite">
<body>
    <div metal:fill-slot="main">
        <tal:main-macro metal:define-macro="main">
        
        <a tal:attributes="href here/aq_parent/absolute_url"> - back - </a>    <br><br>
            
        <div tal:define="subfolders python:sorted(here.objectValues());
                         thisuser   python:str(user);
                         ">
                         
            <table border="0" width="100%" cellpadding=0px cellspacing=0px margin=0px>

                <!-- user table -->
                
                <span tal:condition="python:'Manager' not in user.getRoles()">
                                <h2>Online Feeds:</h2>
                <tr>
                    <td valign="top">
                        <b>Twitter Acc.</b>
                    </td>
                    <td valign="top">
                        <b>Categories</b>
                    </td>
                    <td valign="top">
                        <b>Active</b>
                    </td>
                </tr>
                <span tal:repeat="item subfolders">
                <span tal:condition="python:[x for x in item.permissionsOfRole('Anonymous') if x['name']=='View'][0]['selected'] == 'SELECTED'">  
                <tr tal:condition="python:item.portal_type == 'onlineFeed'"
                    tal:define="localroles python:item.get_local_roles_for_userid(thisuser)">
                    <span tal:condition="python:'Editor' in localroles"
                          tal:define="url         item/absolute_url">
                        <td valign="top">
                            <a tal:attributes="href python:url+'/edit'"><p tal:content="item/feed_username" /></a>    
                        </td>
                        <td valign="top">
                            <span tal:repeat="cat item/categories">
                                <span tal:content="cat" />, 
                            </span>
                        </td>
                        <td valign="top">
                            <span tal:content="item/active_feed" />
                        </td>
                    </span>
                </tr>
                </span>
                </span>
                </span>
                
                
                <!-- manager table -->
                
                <span tal:condition="python:'Manager' in user.getRoles()">
                <b>Manager View:</b>
                <h2>Online Feeds:</h2>
                <tr>
                    <td valign="top">
                        <b>Twitter Acc.</b>
                    </td>
                    <td valign="top">
                        <b>Categories</b>
                    </td>
                    <td valign="top">
                        <b>Premium</b>
                    </td>
                    <td valign="top">
                        <b>Active</b>
                    </td>
                </tr>
                
                <span tal:repeat="item subfolders">
                          
                    <tr tal:condition="python:item.portal_type == 'onlineFeed'"
                        tal:define="premiumlist   here/premiumlist;
                                    feed_username item/feed_username;
                                    absolute_url  item/absolute_url;
                                    description   item/description;
                                    categories    item/categories;
                                    active_feed   item/active_feed;
                                    localroles python:item.get_local_roles_for_userid(thisuser);
                                    url           item/absolute_url">
                        <td valign="top">
                            <a tal:attributes="href python:url+'/edit'"><p tal:content="feed_username" /></a>    
                        </td>
                        <td valign="top">
                            <span tal:repeat="cat categories">
                                <span tal:content="cat" />, 
                            </span>
                        </td>
                        <td valign="top">
                            <span tal:content="python:feed_username in premiumlist" />
                        </td>
                        <td valign="top">
                            <span tal:content="active_feed" />
                        </td>
                    </tr>
                </span>
                </span>
                
                
                
                
                
            </table>
        </div>
     
    
        </tal:main-macro>
    </div>
</body>
</html>
