<!-- dollarId: issue.item,v 1.4 2001/08/03 01:19:43 richard Exp dollar-->
<tal:block metal:use-macro="templates/page/macros/icing">
<title metal:fill-slot="head_title"> 
<span tal:replace="config/TRACKER_NAME" />: 
<span tal:condition="context/id"
       tal:replace="string:Issue ${context/id}: ${context/title}" />
<tal:x tal:condition="not:context/id">New Issue</tal:x> 
</title> 
<td class="page-header-top" metal:fill-slot="body_title">
 <h2>
  Issue<span tal:replace="context/id" />
   <tal:x tal:condition="context/is_edit_ok">Editing</tal:x>
 </h2>
</td>

<td class="content" metal:fill-slot="content">

<span tal:condition="python:not (context.is_view_ok() or context.is_edit_ok())">
You are not allowed to view this page.
</span>

<form method="POST" name="itemSynopsis" onSubmit="return submit_once()"
      enctype="multipart/form-data" tal:condition="context/is_edit_ok"
      tal:attributes="action context/designator">

<input type="hidden" name=":template" value="item">
<input type="hidden" name=":required" value="title,priority">

<table class="form">
<tr>
 <th class="required" nowrap>Title</th>
 <td colspan=3 tal:content="structure python:context.title.field(size=60)">title</td>
</tr>

<tr>
 <th class="required" nowrap>Priority</th>
 <td tal:content="structure context/priority/menu">priority</td>
 <th nowrap>Status</th>
 <td tal:content="structure context/status/menu">status</td>
</tr>

<tr>
 <th nowrap>Superseder</th>
 <td>
  <span tal:replace="structure python:context.superseder.field(showid=1, size=20)" />
  <span tal:replace="structure python:db.issue.classhelp('id,title', property='superseder')" />
  <span tal:condition="context/superseder" tal:repeat="sup context/superseder">
   <br>View: <a tal:attributes="href string:issue${sup/id}"
                tal:content="sup/id"></a>
  </span>
 </td>
 <th nowrap>Nosy List</th>
 <td>
  <span tal:replace="structure context/nosy/field" />
  <span tal:replace="structure
python:db.user.classhelp('username,realname,address', property='nosy', width='600')" /><br>
 </td>
</tr>

<tr>
 <th nowrap>Assigned To</th>
 <td tal:content="structure context/assignedto/menu">assignedto menu</td>
 <th nowrap>Topics</th>
 <td>
  <span tal:replace="structure context/topic/field" />
  <span tal:replace="structure python:db.keyword.classhelp(property='topic')" />
 </td>
</tr>

<tr>
 <th nowrap>Change Note</th>
 <td colspan=3>
  <textarea tal:content="request/form/:note/value | default"
            name=":note" wrap="hard" rows="5" cols="80"></textarea>
 </td>
</tr>

<tr>
 <th nowrap>File</th>
 <td colspan=3><input type="file" name=":file" size="40"></td>
</tr>

<tr>
 <td>&nbsp;</td>
 <td colspan=3 tal:content="structure context/submit">
  submit button will go here
 </td>
</tr>
</table>
</form>

<table class="form" tal:condition="not:context/id">
<tr>
 <td>Note:&nbsp;</td>
 <th class="required">highlighted</th>
 <td>&nbsp;fields are required.</td>
</tr>
</table>

<table class="form" tal:condition="context/is_only_view_ok">
<tr>
 <th nowrap>Title</th><td colspan=3 tal:content="context/title">title</td>
</tr>

<tr>
 <th nowrap>Priority</th><td tal:content="context/priority">priority</td>
 <th nowrap>Status</th><td tal:content="context/status">status</td>
</tr>

<tr>
 <th nowrap>Superseder</th>
 <td>
  <span tal:condition="context/superseder" tal:repeat="sup context/superseder">
   <br>View: <a tal:attributes="href string:issue${sup/id}"
                tal:content="sup/id"></a>
  </span>
 </td>
 <th nowrap>Nosy List</th><td><span tal:replace="context/nosy" /></td>
</tr>

<tr>
 <th nowrap>Assigned To</th><td tal:content="context/assignedto"></td>
 <th nowrap>Topics</th><td tal:content="structure context/topic"></td>
</tr>
</table>

<tal:block tal:condition="python:context.id and context.is_view_ok()">

 <p tal:content="structure string:Created on
  <b>${context/creation}</b> by <b>${context/creator}</b>, last
  changed <b>${context/activity}</b>.">activity info
 </p>

 <table class="messages" tal:condition="context/messages">
  <tr><th colspan="4" class="header">Messages</th></tr>
  <tal:block tal:repeat="msg context/messages/reverse">
   <tr>
    <th><a tal:attributes="href string:msg${msg/id}"
           tal:content="string:msg${msg/id}"></a></th>
    <th tal:content="string:Author: ${msg/author}">author</th>
    <th tal:content="string:Date: ${msg/date}">date</th>
    <th>
     <a tal:condition="context/is_edit_ok"
        tal:attributes="href string:issue${context/id}?:remove:messages=${msg/id}&:action=edit">remove</a>
    </th>
   </tr>
   <tr>
    <td colspan="4" class="content">
     <pre tal:content="structure msg/content/hyperlinked">content</pre>
    </td>
   </tr>
  </tal:block>
 </table>

 <table class="files" tal:condition="context/files">
  <tr><th colspan="2" class="header">Files</th></tr>
  <tr><th>File name</th><th>Uploaded</th></tr>
  <tr tal:repeat="file context/files">
   <td>
    <a tal:attributes="href string:file${file/id}/${file/name}"
       tal:content="file/name">dld link</a>
   </td>
   <td>
    <span tal:content="file/creator">creator's name</span>,
    <span tal:content="file/creation">creation date</span>
   </td>
  </tr>
 </table>

 <tal:block tal:replace="structure context/history" />

</tal:block>

</td>

</tal:block>
