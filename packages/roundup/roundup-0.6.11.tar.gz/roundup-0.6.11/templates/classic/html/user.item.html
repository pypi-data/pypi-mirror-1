<!-- dollarId: user.item,v 1.7 2002/08/16 04:29:04 richard Exp dollar-->
<tal:block metal:use-macro="templates/page/macros/icing">
<title metal:fill-slot="head_title"> 
<span tal:replace="config/TRACKER_NAME" />: 
<span tal:condition="context/id"
      tal:replace="string:User ${context/id}: ${context/username}" />
<tal:x tal:condition="not:context/id">New User</tal:x> 
</title> 
<td class="page-header-top" metal:fill-slot="body_title">
 <h2>
  User<span tal:replace="context/id" />
   <tal:x tal:condition="context/is_edit_ok">Editing</tal:x>
 </h2>
</td>

<td class="content" metal:fill-slot="content">
<span tal:condition="python:not (context.is_view_ok() or context.is_edit_ok())">
You are not allowed to view this page.
</span>

<form method="POST" onSubmit="return submit_once()"
      enctype="multipart/form-data" tal:condition="context/is_edit_ok">

<input type="hidden" name=":template" value="item">
<input type="hidden" name=":required" value="username,address">

<table class="form">
 <tr>
  <th>Name</th>
  <td tal:content="structure context/realname/field">realname</td>
 </tr>
 <tr>
  <th>Login Name</th>
  <td tal:content="structure context/username/field">username</td>
 </tr>
 <tr>
  <th>Login Password</th>
  <td tal:content="structure context/password/field">password</td>
 </tr>
 <tr>
  <th>Confirm Password</th>
  <td tal:content="structure context/password/confirm">password</td>
 </tr>
 <tr tal:condition="python:request.user.hasPermission('Web Roles')">
  <th>Roles</th>
  <td tal:condition="context/id"
      tal:content="structure context/roles/field">roles</td>
  <td tal:condition="not:context/id">
   <input name="roles" tal:attributes="value db/config/NEW_WEB_USER_ROLES">
   (to give the user more than one role, enter a comma,separated,list)
  </td>
 </tr>
 <tr>
  <th>Phone</th>
  <td tal:content="structure context/phone/field">phone</td>
 </tr>
 <tr>
  <th>Organisation</th>
  <td tal:content="structure context/organisation/field">organisation</td>
 </tr>
 <tr>
  <th>Timezone</th>
  <td tal:content="structure context/timezone/field">timezone</td>
 </tr>
 <tr>
  <th>E-mail address</th>
  <td tal:content="structure context/address/field">address</td>
 </tr>
 <tr>
  <th>Alternate E-mail addresses<br>One address per line</th>
  <td tal:content="structure context/alternate_addresses/multiline">alternate_addresses</td>
 </tr>

 <tr>
  <td>&nbsp;</td>
  <td tal:content="structure context/submit">submit button here</td>
 </tr>
</table>
</form>

<table class="otherinfo" tal:condition="python:context.queries and context.is_view_ok()">
 <tr><th colspan="3" class="header">Queries</th></tr>
 <tr><th>Name</th><th colspan="2">Actions</th></tr>
 <tr tal:repeat="query context/queries">
  <td><a tal:attributes="href string:query${query/id}"
         tal:content="query/name"></a></td>
  <td>
   <a tal:attributes="href string:${query/klass}?${query/url}">display</a>   
  </td>
  <td>
   <a tal:attributes="href string:?:remove:queries=${query/id}&:action=edit">remove</a>
  </td>
 </tr>
</table>

<table class="form" tal:condition="context/is_only_view_ok">
 <tr>
  <th colspan=2 class="header" tal:content="context/realname">realname</th>
 </tr>
 <tr>
  <th>Login Name</th>
  <td tal:content="context/username">username</td>
 </tr>
 <tr>
  <th>Phone</th>
  <td tal:content="context/phone">phone</td>
 </tr>
 <tr>
  <th>Organisation</th>
  <td tal:content="context/organisation">organisation</td>
 </tr>
 <tr>
  <th>Timezone</th>
  <td tal:content="context/timezone">timezone</td>
 </tr>
 <tr>
  <th>E-mail address</th>
  <td tal:content="context/address/email">address</td>
 </tr>
</table>

<tal:block tal:condition="python:context.id and context.is_view_ok()"
           tal:replace="structure context/history" />

</td>

</tal:block>
