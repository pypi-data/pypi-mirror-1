/* Generated by Pyrex 0.9.5.1a on Tue Jul  3 23:37:51 2007 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "stdio.h"
#include "string.h"
#include "stdarg.h"
#include "etree_defs.h"
#include "lxml-version.h"
#include "libxml/xmlversion.h"
#include "libxml/encoding.h"
#include "libxml/chvalid.h"
#include "libxml/hash.h"
#include "libxml/tree.h"
#include "libxml/valid.h"
#include "libxml/xmlIO.h"
#include "libxml/xmlsave.h"
#include "libxml/globals.h"
#include "libxml/xmlstring.h"
#include "libxml/xmlmemory.h"
#include "pythread.h"
#include "etree.h"


typedef struct {const char *s; const void **p;} __Pyx_CApiTabEntry; /*proto*/
typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static void __Pyx_ReRaise(void); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from cstd */


/* Declarations from tree */


/* Declarations from python */


/* Declarations from etreepublic */

static PyTypeObject *__pyx_ptype_11etreepublic__Document = 0;
static PyTypeObject *__pyx_ptype_11etreepublic__Element = 0;
static PyTypeObject *__pyx_ptype_11etreepublic_ElementBase = 0;
static PyTypeObject *__pyx_ptype_11etreepublic__ElementTree = 0;
static PyTypeObject *__pyx_ptype_11etreepublic_ElementClassLookup = 0;
static PyTypeObject *__pyx_ptype_11etreepublic_FallbackElementClassLookup = 0;
static PyTypeObject *__pyx_ptype_11etreepublic__ElementTagMatcher = 0;
static PyTypeObject *__pyx_ptype_11etreepublic__ElementIterator = 0;

/* Declarations from pyclasslookup */


struct __pyx_obj_13pyclasslookup__ElementProxy {
  PyObject_HEAD
  struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *__pyx_vtab;
  xmlNode (*_c_node);
  PyObject *_source_proxy;
  PyObject *_dependent_proxies;
};

struct __pyx_vtabstruct_13pyclasslookup__ElementProxy {
  int ((*_assertNode)(struct __pyx_obj_13pyclasslookup__ElementProxy *));
};
static struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *__pyx_vtabptr_13pyclasslookup__ElementProxy;


struct __pyx_obj_13pyclasslookup_PythonElementClassLookup {
  struct LxmlFallbackElementClassLookup __pyx_base;
};

static PyTypeObject *__pyx_ptype_13pyclasslookup__ElementProxy = 0;
static PyTypeObject *__pyx_ptype_13pyclasslookup_PythonElementClassLookup = 0;
static PyObject *__pyx_v_13pyclasslookup_etree;
static PyObject *__pyx_k9;
static struct LxmlElementClassLookup *__pyx_k10;
static struct __pyx_obj_13pyclasslookup__ElementProxy *(__pyx_f_13pyclasslookup__newProxy(struct __pyx_obj_13pyclasslookup__ElementProxy *,xmlNode (*))); /*proto*/
static PyObject *(__pyx_f_13pyclasslookup__freeProxies(struct __pyx_obj_13pyclasslookup__ElementProxy *)); /*proto*/
static PyObject *(__pyx_f_13pyclasslookup__getAttributeValue(xmlNode (*),PyObject *,PyObject *)); /*proto*/
static PyObject *(__pyx_f_13pyclasslookup__lookup_class(PyObject *,struct LxmlDocument *,xmlNode (*))); /*proto*/


/* Implementation of pyclasslookup */

static char (__pyx_k1[]) = "Element tag\n        ";
static char (__pyx_k2[]) = "Text before the first subelement. This is either a string or \n        the value None, if there was no text.\n        ";
static char (__pyx_k3[]) = "Text after this element\'s end tag, but before the next sibling\n        element\'s start tag. This is either a string or the value None, if\n        there was no text.\n        ";
static char (__pyx_k4[]) = "Namespace prefix or None.\n        ";
static char (__pyx_k5[]) = "Original line number as found by the parser or None if unknown.\n        ";

static PyObject *__pyx_n_cetree;
static PyObject *__pyx_n_python;
static PyObject *__pyx_n_tree;
static PyObject *__pyx_n_cstd;
static PyObject *__pyx_n___all__;
static PyObject *__pyx_n___version__;
static PyObject *__pyx_n_PythonElementClassLookup;
static PyObject *__pyx_n_lxml;
static PyObject *__pyx_n_etree;

static PyObject *__pyx_k11p;

static char (__pyx_k11[]) = "Proxy invalidated!";

static int __pyx_f_13pyclasslookup_13_ElementProxy__assertNode(struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_self) {
  int __pyx_r;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":28 */
  #ifndef PYREX_WITHOUT_ASSERTIONS
  if (!(__pyx_v_self->_c_node != NULL)) {
    PyErr_SetObject(PyExc_AssertionError, __pyx_k11p);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; goto __pyx_L1;}
  }
  #endif

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":29 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("pyclasslookup._ElementProxy._assertNode");
  __pyx_r = (-1);
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_3tag___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_3tag___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":35 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":36 */
  __pyx_2 = namespacedName(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.tag.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_4text___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_4text___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":43 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":44 */
  __pyx_2 = textOf(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.text.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_4tail___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_4tail___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":52 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":53 */
  __pyx_2 = tailOf(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.tail.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_dict;

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_6attrib___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_6attrib___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":57 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":58 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_dict); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; goto __pyx_L1;}
  __pyx_3 = collectAttributes(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.attrib.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_6prefix___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_6prefix___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":64 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":65 */
  __pyx_1 = (((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->ns != NULL);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":66 */
    __pyx_1 = (((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->ns->prefix != NULL);
    if (__pyx_1) {

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":67 */
      __pyx_2 = pyunicode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->ns->prefix); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; goto __pyx_L1;}
      __pyx_r = __pyx_2;
      __pyx_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":68 */
  Py_INCREF(Py_None);
  __pyx_r = Py_None;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.prefix.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_10sourceline___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_10sourceline___get__(PyObject *__pyx_v_self) {
  long __pyx_v_line;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":75 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":76 */
  __pyx_v_line = xmlGetLineNo(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":77 */
  __pyx_1 = (__pyx_v_line > 0);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":78 */
    __pyx_2 = PyInt_FromLong(__pyx_v_line); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":80 */
    Py_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.sourceline.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_tag;
static PyObject *__pyx_n_id;

static PyObject *__pyx_k12p;

static char (__pyx_k12[]) = "<Element %s at %x>";

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":83 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_tag); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_id); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_4);
  __pyx_1 = 0;
  __pyx_4 = 0;
  __pyx_3 = PyNumber_Remainder(__pyx_k12p, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.__repr__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_IndexError;

static PyObject *__pyx_k13p;

static char (__pyx_k13[]) = "list index out of range";

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_index); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy___getitem__[] = "Returns the subelement at the given position.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_index) {
  Py_ssize_t __pyx_v_index;
  xmlNode (*__pyx_v_c_node);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_index = PyInt_AsSsize_t(__pyx_arg_index); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":89 */
  __pyx_v_c_node = findChild(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,__pyx_v_index);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":90 */
  __pyx_1 = (__pyx_v_c_node == NULL);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":91 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_IndexError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, __pyx_k13p, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":92 */
  if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; goto __pyx_L1;}
  __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_node)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.__getitem__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___getslice__(PyObject *__pyx_v_self, Py_ssize_t __pyx_v_start, Py_ssize_t __pyx_v_stop); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy___getslice__[] = "Returns a list containing subelements in the given range.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy___getslice__(PyObject *__pyx_v_self, Py_ssize_t __pyx_v_start, Py_ssize_t __pyx_v_stop) {
  xmlNode (*__pyx_v_c_node);
  Py_ssize_t __pyx_v_c;
  PyObject *__pyx_v_result;
  PyObject *__pyx_v_ret;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_result = Py_None; Py_INCREF(Py_None);
  __pyx_v_ret = Py_None; Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":99 */
  __pyx_v_c_node = findChild(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,__pyx_v_start);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":100 */
  __pyx_1 = (__pyx_v_c_node == NULL);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":101 */
    __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":102 */
  __pyx_v_c = __pyx_v_start;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":103 */
  __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; goto __pyx_L1;}
  Py_DECREF(__pyx_v_result);
  __pyx_v_result = __pyx_2;
  __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":104 */
  while (1) {
    __pyx_1 = (__pyx_v_c_node != NULL);
    if (__pyx_1) {
      __pyx_1 = (__pyx_v_c < __pyx_v_stop);
    }
    if (!__pyx_1) break;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":105 */
    __pyx_1 = _isElement(__pyx_v_c_node);
    if (__pyx_1) {

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":106 */
      if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; goto __pyx_L1;}
      __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_node)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; goto __pyx_L1;}
      __pyx_1 = PyList_Append(__pyx_v_result,__pyx_2); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_2 = PyInt_FromLong(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ret);
      __pyx_v_ret = __pyx_2;
      __pyx_2 = 0;

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":108 */
      __pyx_1 = PyObject_IsTrue(__pyx_v_ret); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
      if (__pyx_1) {

        /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":109 */
        __Pyx_ReRaise();
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; goto __pyx_L1;}
        goto __pyx_L6;
      }
      __pyx_L6:;

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":110 */
      __pyx_v_c = (__pyx_v_c + 1);
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":111 */
    __pyx_v_c_node = __pyx_v_c_node->next;
  }

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":112 */
  Py_INCREF(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.__getslice__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_result);
  Py_DECREF(__pyx_v_ret);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static Py_ssize_t __pyx_f_13pyclasslookup_13_ElementProxy___len__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy___len__[] = "Returns the number of subelements.\n        ";
static Py_ssize_t __pyx_f_13pyclasslookup_13_ElementProxy___len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_v_c;
  xmlNode (*__pyx_v_c_node);
  Py_ssize_t __pyx_r;
  int __pyx_1;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":119 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":120 */
  __pyx_v_c = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":121 */
  __pyx_v_c_node = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->children;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":122 */
  while (1) {
    __pyx_1 = (__pyx_v_c_node != NULL);
    if (!__pyx_1) break;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":123 */
    __pyx_1 = _isElement(__pyx_v_c_node);
    if (__pyx_1) {

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":124 */
      __pyx_v_c = (__pyx_v_c + 1);
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":125 */
    __pyx_v_c_node = __pyx_v_c_node->next;
  }

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":126 */
  __pyx_r = __pyx_v_c;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.__len__");
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_13pyclasslookup_13_ElementProxy___nonzero__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_f_13pyclasslookup_13_ElementProxy___nonzero__(PyObject *__pyx_v_self) {
  xmlNode (*__pyx_v_c_node);
  int __pyx_r;
  int __pyx_1;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":130 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":131 */
  __pyx_v_c_node = findChildBackwards(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,0);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":132 */
  __pyx_r = (__pyx_v_c_node != NULL);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.__nonzero__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_get(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_get[] = "Gets an element attribute.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_get(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_v_default = 0;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"key","default",0};
  __pyx_v_default = __pyx_k9;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|O", __pyx_argnames, &__pyx_v_key, &__pyx_v_default)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_key);
  Py_INCREF(__pyx_v_default);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":137 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":138 */
  __pyx_2 = __pyx_f_13pyclasslookup__getAttributeValue(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,__pyx_v_key,__pyx_v_default); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.get");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_default);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_keys(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_keys[] = "Gets a list of attribute names. The names are returned in an\n        arbitrary order (just like for an ordinary Python dictionary).\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_keys(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":144 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":145 */
  __pyx_2 = collectAttributes(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.keys");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_values(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_values[] = "Gets element attributes, as a sequence. The attributes are returned\n        in an arbitrary order.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_values(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":151 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":152 */
  __pyx_2 = collectAttributes(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.values");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_items(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_items[] = "Gets element attributes, as a sequence. The attributes are returned\n        in an arbitrary order.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_items(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":158 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":159 */
  __pyx_2 = collectAttributes(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node,3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.items");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getchildren(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_getchildren[] = "Returns all subelements. The elements are returned in document\n        order.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getchildren(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  xmlNode (*__pyx_v_c_node);
  int __pyx_v_ret;
  PyObject *__pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_result = Py_None; Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":167 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":168 */
  __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; goto __pyx_L1;}
  Py_DECREF(__pyx_v_result);
  __pyx_v_result = __pyx_2;
  __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":169 */
  __pyx_v_c_node = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->children;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":170 */
  while (1) {
    __pyx_1 = (__pyx_v_c_node != NULL);
    if (!__pyx_1) break;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":171 */
    __pyx_1 = _isElement(__pyx_v_c_node);
    if (__pyx_1) {

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":172 */
      if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; goto __pyx_L1;}
      __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_node)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; goto __pyx_L1;}
      __pyx_1 = PyList_Append(__pyx_v_result,__pyx_2); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_v_ret = __pyx_1;

      /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":174 */
      __pyx_1 = __pyx_v_ret;
      if (__pyx_1) {

        /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":175 */
        __Pyx_ReRaise();
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
        goto __pyx_L5;
      }
      __pyx_L5:;
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":176 */
    __pyx_v_c_node = __pyx_v_c_node->next;
  }

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":177 */
  Py_INCREF(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.getchildren");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_result);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getparent(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_getparent[] = "Returns the parent of this element or None for the root element.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getparent(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  xmlNode (*__pyx_v_c_parent);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":183 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":184 */
  __pyx_v_c_parent = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node->parent;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":185 */
  __pyx_1 = (__pyx_v_c_parent == NULL);
  if (!__pyx_1) {
    __pyx_1 = (!_isElement(__pyx_v_c_parent));
  }
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":186 */
    Py_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":188 */
    if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_parent)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.getparent");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getnext(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_getnext[] = "Returns the following sibling of this element or None.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getnext(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  xmlNode (*__pyx_v_c_node);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":194 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":195 */
  __pyx_v_c_node = nextElement(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":196 */
  __pyx_1 = (__pyx_v_c_node != NULL);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":197 */
    if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; goto __pyx_L1;}
    __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_node)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":198 */
  Py_INCREF(Py_None);
  __pyx_r = Py_None;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.getnext");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getprevious(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13pyclasslookup_13_ElementProxy_getprevious[] = "Returns the preceding sibling of this element or None.\n        ";
static PyObject *__pyx_f_13pyclasslookup_13_ElementProxy_getprevious(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  xmlNode (*__pyx_v_c_node);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":204 */
  __pyx_1 = ((struct __pyx_vtabstruct_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->__pyx_vtab)->_assertNode(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)); if (__pyx_1 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":205 */
  __pyx_v_c_node = previousElement(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_c_node);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":206 */
  __pyx_1 = (__pyx_v_c_node != NULL);
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":207 */
    if (!__Pyx_TypeTest(((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
    __pyx_2 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_v_self)->_source_proxy),__pyx_v_c_node)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":208 */
  Py_INCREF(Py_None);
  __pyx_r = Py_None;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._ElementProxy.getprevious");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_f_13pyclasslookup__newProxy(struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_sourceProxy,xmlNode (*__pyx_v_c_node)) {
  struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_el;
  struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  Py_INCREF(__pyx_v_sourceProxy);
  __pyx_v_el = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)Py_None); Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":212 */
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_13pyclasslookup__ElementProxy), 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_el));
  __pyx_v_el = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":213 */
  __pyx_v_el->_c_node = __pyx_v_c_node;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":214 */
  __pyx_2 = __pyx_v_sourceProxy == Py_None;
  if (__pyx_2) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":215 */
    Py_INCREF(((PyObject *)__pyx_v_el));
    Py_DECREF(((PyObject *)__pyx_v_sourceProxy));
    __pyx_v_sourceProxy = __pyx_v_el;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":216 */
    __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; goto __pyx_L1;}
    Py_DECREF(__pyx_v_el->_dependent_proxies);
    __pyx_v_el->_dependent_proxies = __pyx_1;
    __pyx_1 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":217 */
  Py_INCREF(((PyObject *)__pyx_v_sourceProxy));
  Py_DECREF(__pyx_v_el->_source_proxy);
  __pyx_v_el->_source_proxy = ((PyObject *)__pyx_v_sourceProxy);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":218 */
  __pyx_2 = PyList_Append(__pyx_v_sourceProxy->_dependent_proxies,((PyObject *)__pyx_v_el)); if (__pyx_2 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":219 */
  Py_INCREF(((PyObject *)__pyx_v_el));
  __pyx_r = __pyx_v_el;
  goto __pyx_L0;

  __pyx_r = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("pyclasslookup._newProxy");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_el);
  Py_DECREF(__pyx_v_sourceProxy);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup__freeProxies(struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_sourceProxy) {
  struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_el;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_INCREF(__pyx_v_sourceProxy);
  __pyx_v_el = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)Py_None); Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":223 */
  __pyx_1 = __pyx_v_sourceProxy == Py_None;
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":224 */
    __pyx_r = Py_None; Py_INCREF(Py_None);
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":225 */
  __pyx_1 = __pyx_v_sourceProxy->_dependent_proxies == Py_None;
  if (__pyx_1) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":226 */
    __pyx_r = Py_None; Py_INCREF(Py_None);
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":227 */
  __pyx_2 = PyObject_GetIter(__pyx_v_sourceProxy->_dependent_proxies); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
  for (;;) {
    __pyx_3 = PyIter_Next(__pyx_2);
    if (!__pyx_3) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_el));
    __pyx_v_el = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_3);
    __pyx_3 = 0;

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":228 */
    __pyx_v_el->_c_node = NULL;
  }
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":229 */
  if (PySequence_DelSlice(__pyx_v_sourceProxy->_dependent_proxies, 0, PY_SSIZE_T_MAX) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("pyclasslookup._freeProxies");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_el);
  Py_DECREF(__pyx_v_sourceProxy);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup__getAttributeValue(xmlNode (*__pyx_v_c_node),PyObject *__pyx_v_key,PyObject *__pyx_v_default) {
  char (*__pyx_v_c_tag);
  char (*__pyx_v_c_href);
  PyObject *__pyx_v_ns;
  PyObject *__pyx_v_tag;
  PyObject *__pyx_v_result;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  Py_INCREF(__pyx_v_key);
  Py_INCREF(__pyx_v_default);
  __pyx_v_ns = Py_None; Py_INCREF(Py_None);
  __pyx_v_tag = Py_None; Py_INCREF(Py_None);
  __pyx_v_result = Py_None; Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":234 */
  __pyx_1 = getNsTag(__pyx_v_key); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_2 = PyObject_GetIter(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_v_ns);
  __pyx_v_ns = __pyx_1;
  __pyx_1 = 0;
  __pyx_1 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_v_tag);
  __pyx_v_tag = __pyx_1;
  __pyx_1 = 0;
  if (__Pyx_EndUnpack(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":235 */
  __pyx_v_c_tag = _cstr(__pyx_v_tag);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":236 */
  __pyx_3 = __pyx_v_ns == Py_None;
  if (__pyx_3) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":237 */
    __pyx_v_c_href = NULL;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":239 */
    __pyx_v_c_href = _cstr(__pyx_v_ns);
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":240 */
  __pyx_1 = attributeValueFromNsName(__pyx_v_c_node,__pyx_v_c_href,__pyx_v_c_tag); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  Py_DECREF(__pyx_v_result);
  __pyx_v_result = __pyx_1;
  __pyx_1 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":241 */
  __pyx_3 = __pyx_v_result == Py_None;
  if (__pyx_3) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":242 */
    Py_INCREF(__pyx_v_default);
    __pyx_r = __pyx_v_default;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":243 */
  Py_INCREF(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup._getAttributeValue");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_ns);
  Py_DECREF(__pyx_v_tag);
  Py_DECREF(__pyx_v_result);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_default);
  return __pyx_r;
}

static PyObject *__pyx_n___init__;

static int __pyx_f_13pyclasslookup_24PythonElementClassLookup___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_13pyclasslookup_24PythonElementClassLookup___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct LxmlElementClassLookup *__pyx_v_fallback = 0;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"fallback",0};
  __pyx_v_fallback = __pyx_k10;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_fallback)) return -1;
  Py_INCREF((PyObject *)__pyx_v_self);
  Py_INCREF(__pyx_v_fallback);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fallback), __pyx_ptype_11etreepublic_ElementClassLookup, 1, "fallback")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":262 */
  __pyx_1 = PyObject_GetAttr(((PyObject*)__pyx_ptype_11etreepublic_FallbackElementClassLookup), __pyx_n___init__); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self);
  Py_INCREF(((PyObject *)__pyx_v_fallback));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_fallback));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":263 */
  ((struct __pyx_obj_13pyclasslookup_PythonElementClassLookup *)__pyx_v_self)->__pyx_base.__pyx_base._lookup_function = __pyx_f_13pyclasslookup__lookup_class;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("pyclasslookup.PythonElementClassLookup.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_self);
  Py_DECREF(__pyx_v_fallback);
  return __pyx_r;
}

static PyObject *__pyx_f_13pyclasslookup_24PythonElementClassLookup_lookup(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_13pyclasslookup_24PythonElementClassLookup_lookup(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_doc = 0;
  PyObject *__pyx_v_element = 0;
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {"doc","element",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_doc, &__pyx_v_element)) return 0;
  Py_INCREF((PyObject *)__pyx_v_self);
  Py_INCREF(__pyx_v_doc);
  Py_INCREF(__pyx_v_element);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":266 */
  Py_INCREF(Py_None);
  __pyx_r = Py_None;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_self);
  Py_DECREF(__pyx_v_doc);
  Py_DECREF(__pyx_v_element);
  return __pyx_r;
}

static PyObject *__pyx_n_lookup;

static PyObject *__pyx_f_13pyclasslookup__lookup_class(PyObject *__pyx_v_state,struct LxmlDocument *__pyx_v_doc,xmlNode (*__pyx_v_c_node)) {
  struct __pyx_obj_13pyclasslookup_PythonElementClassLookup *__pyx_v_lookup;
  struct __pyx_obj_13pyclasslookup__ElementProxy *__pyx_v_proxy;
  PyObject *__pyx_v_cls;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  Py_INCREF(__pyx_v_state);
  Py_INCREF(__pyx_v_doc);
  __pyx_v_lookup = ((struct __pyx_obj_13pyclasslookup_PythonElementClassLookup *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)Py_None); Py_INCREF(Py_None);
  __pyx_v_cls = Py_None; Py_INCREF(Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":271 */
  Py_INCREF(((PyObject *)((struct __pyx_obj_13pyclasslookup_PythonElementClassLookup *)__pyx_v_state)));
  Py_DECREF(((PyObject *)__pyx_v_lookup));
  __pyx_v_lookup = ((struct __pyx_obj_13pyclasslookup_PythonElementClassLookup *)__pyx_v_state);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":273 */
  if (!__Pyx_TypeTest(Py_None, __pyx_ptype_13pyclasslookup__ElementProxy)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
  __pyx_1 = ((PyObject *)__pyx_f_13pyclasslookup__newProxy(((struct __pyx_obj_13pyclasslookup__ElementProxy *)Py_None),__pyx_v_c_node)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_proxy));
  __pyx_v_proxy = ((struct __pyx_obj_13pyclasslookup__ElementProxy *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":274 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_lookup), __pyx_n_lookup); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_doc));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_doc));
  Py_INCREF(((PyObject *)__pyx_v_proxy));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_proxy));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_cls);
  __pyx_v_cls = __pyx_3;
  __pyx_3 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":275 */
  __pyx_1 = __pyx_f_13pyclasslookup__freeProxies(__pyx_v_proxy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":277 */
  __pyx_4 = __pyx_v_cls != Py_None;
  if (__pyx_4) {

    /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":278 */
    Py_INCREF(__pyx_v_cls);
    __pyx_r = __pyx_v_cls;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":279 */
  __pyx_2 = callLookupFallback(((struct LxmlFallbackElementClassLookup *)__pyx_v_lookup),__pyx_v_doc,__pyx_v_c_node); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("pyclasslookup._lookup_class");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_lookup);
  Py_DECREF(__pyx_v_proxy);
  Py_DECREF(__pyx_v_cls);
  Py_DECREF(__pyx_v_state);
  Py_DECREF(__pyx_v_doc);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_IndexError, "IndexError"},
  {&__pyx_n_PythonElementClassLookup, "PythonElementClassLookup"},
  {&__pyx_n___all__, "__all__"},
  {&__pyx_n___init__, "__init__"},
  {&__pyx_n___version__, "__version__"},
  {&__pyx_n_cetree, "cetree"},
  {&__pyx_n_cstd, "cstd"},
  {&__pyx_n_dict, "dict"},
  {&__pyx_n_etree, "etree"},
  {&__pyx_n_id, "id"},
  {&__pyx_n_lookup, "lookup"},
  {&__pyx_n_lxml, "lxml"},
  {&__pyx_n_python, "python"},
  {&__pyx_n_tag, "tag"},
  {&__pyx_n_tree, "tree"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k11p, __pyx_k11, sizeof(__pyx_k11)},
  {&__pyx_k12p, __pyx_k12, sizeof(__pyx_k12)},
  {&__pyx_k13p, __pyx_k13, sizeof(__pyx_k13)},
  {0, 0, 0}
};
static struct __pyx_vtabstruct_13pyclasslookup__ElementProxy __pyx_vtable_13pyclasslookup__ElementProxy;

static PyObject *__pyx_tp_new_13pyclasslookup__ElementProxy(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_13pyclasslookup__ElementProxy *p = (struct __pyx_obj_13pyclasslookup__ElementProxy *)o;
  *(struct __pyx_vtabstruct_13pyclasslookup__ElementProxy **)&p->__pyx_vtab = __pyx_vtabptr_13pyclasslookup__ElementProxy;
  p->_source_proxy = Py_None; Py_INCREF(Py_None);
  p->_dependent_proxies = Py_None; Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_13pyclasslookup__ElementProxy(PyObject *o) {
  struct __pyx_obj_13pyclasslookup__ElementProxy *p = (struct __pyx_obj_13pyclasslookup__ElementProxy *)o;
  Py_XDECREF(p->_source_proxy);
  Py_XDECREF(p->_dependent_proxies);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_13pyclasslookup__ElementProxy(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_13pyclasslookup__ElementProxy *p = (struct __pyx_obj_13pyclasslookup__ElementProxy *)o;
  if (p->_source_proxy) {
    e = (*v)(p->_source_proxy, a); if (e) return e;
  }
  if (p->_dependent_proxies) {
    e = (*v)(p->_dependent_proxies, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_13pyclasslookup__ElementProxy(PyObject *o) {
  struct __pyx_obj_13pyclasslookup__ElementProxy *p = (struct __pyx_obj_13pyclasslookup__ElementProxy *)o;
  Py_XDECREF(p->_source_proxy);
  p->_source_proxy = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_dependent_proxies);
  p->_dependent_proxies = Py_None; Py_INCREF(Py_None);
  return 0;
}
static PyObject *__pyx_sq_item_13pyclasslookup__ElementProxy(PyObject *o, Py_ssize_t i) {
  PyObject *r;
  PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
  r = o->ob_type->tp_as_mapping->mp_subscript(o, x);
  Py_DECREF(x);
  return r;
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_tag(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_3tag___get__(o);
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_text(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_4text___get__(o);
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_tail(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_4tail___get__(o);
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_attrib(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_6attrib___get__(o);
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_prefix(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_6prefix___get__(o);
}

static PyObject *__pyx_getprop_13pyclasslookup_13_ElementProxy_sourceline(PyObject *o, void *x) {
  return __pyx_f_13pyclasslookup_13_ElementProxy_10sourceline___get__(o);
}

static struct PyMethodDef __pyx_methods_13pyclasslookup__ElementProxy[] = {
  {"get", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_get, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_get},
  {"keys", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_keys, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_keys},
  {"values", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_values, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_values},
  {"items", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_items, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_items},
  {"getchildren", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_getchildren, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_getchildren},
  {"getparent", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_getparent, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_getparent},
  {"getnext", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_getnext, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_getnext},
  {"getprevious", (PyCFunction)__pyx_f_13pyclasslookup_13_ElementProxy_getprevious, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13pyclasslookup_13_ElementProxy_getprevious},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_13pyclasslookup__ElementProxy[] = {
  {"tag", __pyx_getprop_13pyclasslookup_13_ElementProxy_tag, 0, __pyx_k1, 0},
  {"text", __pyx_getprop_13pyclasslookup_13_ElementProxy_text, 0, __pyx_k2, 0},
  {"tail", __pyx_getprop_13pyclasslookup_13_ElementProxy_tail, 0, __pyx_k3, 0},
  {"attrib", __pyx_getprop_13pyclasslookup_13_ElementProxy_attrib, 0, 0, 0},
  {"prefix", __pyx_getprop_13pyclasslookup_13_ElementProxy_prefix, 0, __pyx_k4, 0},
  {"sourceline", __pyx_getprop_13pyclasslookup_13_ElementProxy_sourceline, 0, __pyx_k5, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number__ElementProxy = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  __pyx_f_13pyclasslookup_13_ElementProxy___nonzero__, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence__ElementProxy = {
  __pyx_f_13pyclasslookup_13_ElementProxy___len__, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  __pyx_sq_item_13pyclasslookup__ElementProxy, /*sq_item*/
  __pyx_f_13pyclasslookup_13_ElementProxy___getslice__, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping__ElementProxy = {
  __pyx_f_13pyclasslookup_13_ElementProxy___len__, /*mp_length*/
  __pyx_f_13pyclasslookup_13_ElementProxy___getitem__, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer__ElementProxy = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_13pyclasslookup__ElementProxy = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "pyclasslookup._ElementProxy", /*tp_name*/
  sizeof(struct __pyx_obj_13pyclasslookup__ElementProxy), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_13pyclasslookup__ElementProxy, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  __pyx_f_13pyclasslookup_13_ElementProxy___repr__, /*tp_repr*/
  &__pyx_tp_as_number__ElementProxy, /*tp_as_number*/
  &__pyx_tp_as_sequence__ElementProxy, /*tp_as_sequence*/
  &__pyx_tp_as_mapping__ElementProxy, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer__ElementProxy, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_13pyclasslookup__ElementProxy, /*tp_traverse*/
  __pyx_tp_clear_13pyclasslookup__ElementProxy, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_13pyclasslookup__ElementProxy, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_13pyclasslookup__ElementProxy, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_13pyclasslookup__ElementProxy, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_13pyclasslookup_PythonElementClassLookup(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = __pyx_ptype_11etreepublic_FallbackElementClassLookup->tp_new(t, a, k);
  return o;
}

static void __pyx_tp_dealloc_13pyclasslookup_PythonElementClassLookup(PyObject *o) {
  __pyx_ptype_11etreepublic_FallbackElementClassLookup->tp_dealloc(o);
}

static int __pyx_tp_traverse_13pyclasslookup_PythonElementClassLookup(PyObject *o, visitproc v, void *a) {
  int e;
  e = __pyx_ptype_11etreepublic_FallbackElementClassLookup->tp_traverse(o, v, a); if (e) return e;
  return 0;
}

static int __pyx_tp_clear_13pyclasslookup_PythonElementClassLookup(PyObject *o) {
  __pyx_ptype_11etreepublic_FallbackElementClassLookup->tp_clear(o);
  return 0;
}

static struct PyMethodDef __pyx_methods_13pyclasslookup_PythonElementClassLookup[] = {
  {"lookup", (PyCFunction)__pyx_f_13pyclasslookup_24PythonElementClassLookup_lookup, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_PythonElementClassLookup = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_PythonElementClassLookup = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_PythonElementClassLookup = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_PythonElementClassLookup = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_13pyclasslookup_PythonElementClassLookup = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "pyclasslookup.PythonElementClassLookup", /*tp_name*/
  sizeof(struct __pyx_obj_13pyclasslookup_PythonElementClassLookup), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_13pyclasslookup_PythonElementClassLookup, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_PythonElementClassLookup, /*tp_as_number*/
  &__pyx_tp_as_sequence_PythonElementClassLookup, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_PythonElementClassLookup, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_PythonElementClassLookup, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  "Element class lookup based on a subclass method.\n\n    To use it, inherit from this class and override the method\n\n        lookup(self, document, node_proxy)\n\n    to lookup the element class for a node. The first argument is the opaque\n    document instance that contains the Element. The second arguments is a\n    lightweight Element proxy implementation that is only valid during the\n    lookup. Do not try to keep a reference to it. Once the lookup is done, the\n    proxy will be invalid.\n\n    If you return None from this method, the fallback will be called.\n    ", /*tp_doc*/
  __pyx_tp_traverse_13pyclasslookup_PythonElementClassLookup, /*tp_traverse*/
  __pyx_tp_clear_13pyclasslookup_PythonElementClassLookup, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_13pyclasslookup_PythonElementClassLookup, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_13pyclasslookup_24PythonElementClassLookup___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_13pyclasslookup_PythonElementClassLookup, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initpyclasslookup(void); /*proto*/
PyMODINIT_FUNC initpyclasslookup(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("pyclasslookup", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;};
  __pyx_v_13pyclasslookup_etree = Py_None; Py_INCREF(Py_None);
  __pyx_vtabptr_13pyclasslookup__ElementProxy = &__pyx_vtable_13pyclasslookup__ElementProxy;
  *(void(**)())&__pyx_vtable_13pyclasslookup__ElementProxy._assertNode = (void(*)())__pyx_f_13pyclasslookup_13_ElementProxy__assertNode;
  __pyx_type_13pyclasslookup__ElementProxy.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_13pyclasslookup__ElementProxy) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_13pyclasslookup__ElementProxy.tp_dict, __pyx_vtabptr_13pyclasslookup__ElementProxy) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "_ElementProxy", (PyObject *)&__pyx_type_13pyclasslookup__ElementProxy) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; goto __pyx_L1;}
  __pyx_ptype_13pyclasslookup__ElementProxy = &__pyx_type_13pyclasslookup__ElementProxy;
  __pyx_ptype_11etreepublic_FallbackElementClassLookup = __Pyx_ImportType("lxml.etree", "FallbackElementClassLookup", sizeof(struct LxmlFallbackElementClassLookup)); if (!__pyx_ptype_11etreepublic_FallbackElementClassLookup) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; goto __pyx_L1;}
  __pyx_type_13pyclasslookup_PythonElementClassLookup.tp_base = __pyx_ptype_11etreepublic_FallbackElementClassLookup;
  if (PyType_Ready(&__pyx_type_13pyclasslookup_PythonElementClassLookup) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "PythonElementClassLookup", (PyObject *)&__pyx_type_13pyclasslookup_PythonElementClassLookup) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  __pyx_ptype_13pyclasslookup_PythonElementClassLookup = &__pyx_type_13pyclasslookup_PythonElementClassLookup;
  __pyx_ptype_11etreepublic__Document = __Pyx_ImportType("lxml.etree", "_Document", sizeof(struct LxmlDocument)); if (!__pyx_ptype_11etreepublic__Document) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 27; goto __pyx_L1;}
  __pyx_ptype_11etreepublic__Element = __Pyx_ImportType("lxml.etree", "_Element", sizeof(struct LxmlElement)); if (!__pyx_ptype_11etreepublic__Element) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 30; goto __pyx_L1;}
  __pyx_ptype_11etreepublic_ElementBase = __Pyx_ImportType("lxml.etree", "ElementBase", sizeof(struct LxmlElementBase)); if (!__pyx_ptype_11etreepublic_ElementBase) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; goto __pyx_L1;}
  __pyx_ptype_11etreepublic__ElementTree = __Pyx_ImportType("lxml.etree", "_ElementTree", sizeof(struct LxmlElementTree)); if (!__pyx_ptype_11etreepublic__ElementTree) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 37; goto __pyx_L1;}
  __pyx_ptype_11etreepublic_ElementClassLookup = __Pyx_ImportType("lxml.etree", "ElementClassLookup", sizeof(struct LxmlElementClassLookup)); if (!__pyx_ptype_11etreepublic_ElementClassLookup) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 41; goto __pyx_L1;}
  __pyx_ptype_11etreepublic__ElementTagMatcher = __Pyx_ImportType("lxml.etree", "_ElementTagMatcher", sizeof(struct LxmlElementTagMatcher)); if (!__pyx_ptype_11etreepublic__ElementTagMatcher) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_ptype_11etreepublic__ElementIterator = __Pyx_ImportType("lxml.etree", "_ElementIterator", sizeof(struct LxmlElementIterator)); if (!__pyx_ptype_11etreepublic__ElementIterator) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 154; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":11 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  Py_INCREF(__pyx_n_PythonElementClassLookup);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_n_PythonElementClassLookup);
  if (PyObject_SetAttr(__pyx_m, __pyx_n___all__, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":14 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_INCREF(__pyx_n_etree);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_n_etree);
  __pyx_2 = __Pyx_Import(__pyx_n_lxml, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_etree); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_DECREF(__pyx_v_13pyclasslookup_etree);
  __pyx_v_13pyclasslookup_etree = __pyx_1;
  __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":16 */
  __pyx_3 = import_etree(__pyx_v_13pyclasslookup_etree); if (__pyx_3 == (-1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; goto __pyx_L1;}

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":18 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_13pyclasslookup_etree, __pyx_n___version__); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n___version__, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":134 */
  Py_INCREF(Py_None);
  __pyx_k9 = Py_None;

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":261 */
  if (!__Pyx_TypeTest(Py_None, __pyx_ptype_11etreepublic_ElementClassLookup)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}
  Py_INCREF(Py_None);
  __pyx_k10 = ((struct LxmlElementClassLookup *)Py_None);

  /* "/home/sbehnel/source/Python/lxml/lxml-1.3/RELEASE-DIR/lxml-1.3.2/src/lxml/pyclasslookup.pyx":268 */
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("pyclasslookup");
}

static char *__pyx_filenames[] = {
  "pyclasslookup.pyx",
  "etreepublic.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if ((none_allowed && obj == Py_None) || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, obj->ob_type->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static void __Pyx_ReRaise(void) {
    PyThreadState *tstate = PyThreadState_Get();
    PyObject *type = tstate->exc_type;
    PyObject *value = tstate->exc_value;
    PyObject *tb = tstate->exc_traceback;
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    PyErr_Restore(type, value, tb);
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
    PyObject *pycobj = 0;
    int result;
    
    pycobj = PyCObject_FromVoidPtr(vtable, 0);
    if (!pycobj)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", pycobj) < 0)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
    long size) 
{
    PyObject *py_module_name = 0;
    PyObject *py_class_name = 0;
    PyObject *py_name_list = 0;
    PyObject *py_module = 0;
    PyObject *result = 0;
    
    py_module_name = PyString_FromString(module_name);
    if (!py_module_name)
        goto bad;
    py_class_name = PyString_FromString(class_name);
    if (!py_class_name)
        goto bad;
    py_name_list = PyList_New(1);
    if (!py_name_list)
        goto bad;
    Py_INCREF(py_class_name);
    if (PyList_SetItem(py_name_list, 0, py_class_name) < 0)
        goto bad;
    py_module = __Pyx_Import(py_module_name, py_name_list);
    if (!py_module)
        goto bad;
    result = PyObject_GetAttr(py_module, py_class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    goto done;
bad:
    Py_XDECREF(result);
    result = 0;
done:
    Py_XDECREF(py_module_name);
    Py_XDECREF(py_class_name);
    Py_XDECREF(py_name_list);
    return (PyTypeObject *)result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
