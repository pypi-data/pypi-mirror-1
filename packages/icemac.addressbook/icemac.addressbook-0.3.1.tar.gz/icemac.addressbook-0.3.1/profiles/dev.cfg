[buildout]
extends = base.cfg
parts = ${buildout:base-parts} coverage-test coverage-report eggdeps omelette importchecker test_z3cpt

[site.zcml]
prepend_zcml =
append_zcml = <include file="dev_profiling.zcml" />
              <include file="dev_admin_user.zcml" />
              <include file="default_skin.zcml" />

[app]
eggs += z3c.profiler
        stxnext.pdb

[test]
eggs += stxnext.pdb

[use_z3cpt]
PREFER_Z3C_PT = True
CHAMELEON_DEBUG = True

[test_z3cpt]
recipe = zc.recipe.testrunner
eggs = icemac.addressbook [test]
working-directory = ${buildout:directory}/src/icemac/addressbook
defaults = ['-c', '-t', 'rootfolder.txt', '-1']
environment = use_z3cpt

[coverage-test]
recipe = zc.recipe.testrunner
eggs = icemac.addressbook [test]
defaults = ['--tests-pattern', '^f?tests$', '-v', '-c', '--coverage', '../../coverage']

[coverage-report]
recipe = zc.recipe.egg
eggs = z3c.coverage
scripts = coverage=coverage-report
arguments = ('coverage', 'coverage/report')

[eggdeps]
recipe = zc.recipe.egg
eggs = gtkeggdeps
       icemac.addressbook [test]

[omelette]
recipe = collective.recipe.omelette
eggs = ${app:eggs}
       icemac.addressbook [test]

[importchecker]
recipe = zc.recipe.egg
eggs = importchecker
arguments = "${buildout:directory}/src"
