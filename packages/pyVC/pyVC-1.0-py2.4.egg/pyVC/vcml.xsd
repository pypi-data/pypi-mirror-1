<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:element name="config" type="configType"/>
  <xsd:complexType name="configType">
    <xsd:sequence>
      <xsd:element name="network" type="networkType" minOccurs="1" maxOccurs="unbounded"/>
      <xsd:element name="disk" type="diskType" minOccurs="0" maxOccurs="unbounded"/>
      <xsd:element name="helpers" type="helpersType" minOccurs="0" maxOccurs="1"/>
    </xsd:sequence>
    <xsd:attribute name="realhost" type="xsd:string" use="optional"/>
  </xsd:complexType>
  <xsd:complexType name="networkType">
    <xsd:sequence>
      <xsd:element name="host" type="hostType" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
    <xsd:attribute name="name" type="xsd:string" use="required"/>
    <xsd:attribute name="type" type="networkTypeType" use="required"/>
    <xsd:attribute name="subnet" type="subnetType" use="optional"/>
    <xsd:attribute name="dns_servers" type="ipAddrsType" use="optional"/>
    <xsd:attribute name="realhosts" type="xsd:string" use="optional"/>
    <xsd:attribute name="hub" type="xsd:boolean" use="optional"/>
    <xsd:attribute name="address" type="ipAddrType" use="optional"/>
    <xsd:attribute name="port" type="xsd:integer" use="optional"/>
  </xsd:complexType>
  <xsd:simpleType name="networkTypeType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="vde1"/>
      <xsd:enumeration value="multicast"/>
      <xsd:enumeration value="user"/>
      <xsd:enumeration value="tap"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="diskReferenceType">
    <xsd:attribute name="name" type="xsd:string" use="required"/>
  </xsd:complexType>
  <xsd:complexType name="diskType">
    <xsd:attribute name="name" type="xsd:string" use="required"/>
    <xsd:attribute name="type" type="diskTypeType" use="required"/>
    <xsd:attribute name="imagefile" type="xsd:string" use="optional"/>
  </xsd:complexType>
  <xsd:simpleType name="diskTypeType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="image"/>
      <xsd:enumeration value="nfs"/>
      <xsd:enumeration value="physical"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="helpersType">
    <xsd:sequence>
      <xsd:element name="interface" type="interfaceHelperType" minOccurs="0" maxOccurs="unbounded"/>
      <xsd:element name="dhcp" type="dhcpHelperType" minOccurs="0" maxOccurs="unbounded"/>
      <xsd:element name="router" type="routerHelperType" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="interfaceHelperType">
    <xsd:attribute name="addrs" type="ipAddrsType" use="optional"/>
    <xsd:attribute name="networks" type="xsd:string" use="optional"/>
    <xsd:attribute name="realhost" type="xsd:string" use="optional"/>
  </xsd:complexType>
  <xsd:complexType name="dhcpHelperType">
    <xsd:attribute name="networks" type="xsd:string" use="optional"/>
  </xsd:complexType>
  <xsd:complexType name="routerHelperType">
    <xsd:attribute name="networks" type="xsd:string" use="optional"/>
  </xsd:complexType>
  <xsd:complexType name="hostType">
    <xsd:sequence>
      <xsd:element name="interface" type="interfaceType" minOccurs="0" maxOccurs="unbounded"/>
      <xsd:element name="disk" type="diskReferenceType" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
    <xsd:attribute name="name" type="xsd:string" use="required"/>
    <xsd:attribute name="type" type="hostTypeType" use="required"/>
    <xsd:attribute name="addrs" type="ipAddrsType" use="optional"/>
    <xsd:attribute name="memory" type="xsd:integer" use="optional"/>
    <xsd:attribute name="macaddr" type="xsd:string" use="optional"/>
    <xsd:attribute name="vmgroup" type="xsd:integer" use="optional"/>
    <xsd:attribute name="kernel" type="xsd:string" use="optional"/>
    <xsd:attribute name="kernelargs" type="xsd:string" use="optional"/>
    <xsd:attribute name="initrd" type="xsd:string" use="optional"/>
    <xsd:attribute name="graphic" type="xsd:boolean" use="optional"/>
    <xsd:attribute name="snapshot" type="xsd:boolean" use="optional"/>
    <xsd:attribute name="realhost" type="xsd:string" use="optional"/>
    <xsd:attribute name="vlan" type="xsd:integer" use="optional"/>
  </xsd:complexType>
  <xsd:simpleType name="hostTypeType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="qemu"/>
      <xsd:enumeration value="uml"/>
      <xsd:enumeration value="xen"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="interfaceType">
    <xsd:attribute name="addrs" type="ipAddrType" use="optional"/>
    <xsd:attribute name="network" type="xsd:string" use="optional"/>
    <xsd:attribute name="vlan" type="xsd:integer" use="optional"/>
  </xsd:complexType>
  <xsd:simpleType name="ipAddrType">
    <xsd:restriction base="xsd:string">
      <xsd:pattern value="((1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]).){3}(1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="ipAddrsType">
    <xsd:restriction base="xsd:string">
      <xsd:pattern value="((1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]).){3}(1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])(,((1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]).){3}(1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]))*"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="subnetType">
    <xsd:restriction base="xsd:string">
      <xsd:pattern value="((1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]).){3}(1?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])/(3[0-1]|[0-2]?[0-9])"/>
    </xsd:restriction>
  </xsd:simpleType>
</xsd:schema>
