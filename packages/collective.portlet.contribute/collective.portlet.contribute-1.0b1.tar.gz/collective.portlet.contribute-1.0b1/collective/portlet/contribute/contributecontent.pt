<div tal:condition="view/data/omit_border"
     tal:attributes="class string:portletContributeContent ${view/css_class}"
     tal:content="structure view/data/text" />
<dl tal:condition="not:view/data/omit_border"
    tal:attributes="class string:portlet portletContributeContent ${view/css_class}"
    i18n:domain="collective.portlet.contribute">

    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
        <span tal:content="view/data/header" />
        <span class="portletTopRight"></span>
    </dt>

    <dd class="portletItem odd">
        <div tal:replace="structure view/data/text" />
        
        <div class="add-buttons"
            tal:define="addable_types view/addable_types"
            tal:condition="addable_types">
            
            <form method="post"
                  tal:condition="python:len(addable_types) == 1"
                  tal:define="info python:addable_types[0]"
                  tal:attributes="action string:${context/@@plone_portal_state/portal_url}/@@contribute_portlet_redirect;
                                  class string:portlet-add-${info/id}">
                
                <div class="formControls" style="text-align:center">
                    <button type="submit" class="context" name="to"
                        tal:attributes="value info/action"
                        onclick="window.location.href=this.value; return false;">
                        <span tal:omit-tag="" i18n:translate="label_add">
                            Add <span i18n:name="typeid" i18n:translate="" 
                                        tal:content="info/title" tal:omit-tag="" />
                        </span>
                    </button>
                </div>
            </form>
            
            <form method="post" class="portlet-add-multiple"
                tal:condition="python:len(addable_types) > 1"
                tal:attributes="action string:${context/@@plone_portal_state/portal_url}/@@contribute_portlet_redirect;">
                
                <div class="field">
                    <select name="to" onchange="window.location.href=this.options[this.selectedIndex].value">
                        <option value="" i18n:translate="label_select">Add a new...</option>
                        <option
                            tal:repeat="info addable_types"
                            tal:attributes="value info/action; title info/description"
                            tal:content="info/title" />
                    </select>
                </div>
                
                <noscript>
                    <div class="formControls">
                        <input
                            name="form.button.Add" 
                            type="submit"
                            class="context"
                            value="Add"
                            i18n:attributes="value" />
                    </div>
                </noscript>
            </form>
            
        </div>
        
        <tal:corners condition="not:view/has_footer">
            <span class="portletBottomLeft"></span>
            <span class="portletBottomRight"></span>
        </tal:corners>
    </dd>
    
    <dd class="portletFooter" tal:condition="view/has_footer">
        <span class="portletBottomLeft"></span>
        <span>
           <a tal:omit-tag="not:view/has_link"
              tal:attributes="href view/data/more_url"
              tal:content="view/data/footer"
              />
        </span>
        <span class="portletBottomRight"></span>
    </dd>

</dl>
