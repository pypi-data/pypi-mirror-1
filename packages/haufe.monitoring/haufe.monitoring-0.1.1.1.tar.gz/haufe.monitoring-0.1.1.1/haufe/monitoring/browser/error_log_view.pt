<html>
    <head>
        <link rel="stylesheet" href="/++resource++haufe.monitoring/styles.css" type="text/css" >
        <script type="text/javascript" src="/++resource++haufe.monitoring/jquery.tools.min.js"></script>

        <script type="text/javascript">    
            function onload() {
                $('input[rel]').overlay();
            }

            function backToMain() {
                window.location.href = '/@@monitor';
            }
        </script>
    </head>
    <body onload="onload()"
          tal:define="results view/collect_error_logs">
        <h1>Error logs</h1>
        
        <div class="warning" tal:condition="not: results">No error log entries found</div>

        <table tal:condition="results">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Instance</th>
                    <th>User</th>
                    <th>Exception</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tal:loop repeat="data results" >
                    <tr>
                        <td class="date-spec" valign="top">
                            <span tal:content="structure data/time_str" />
                        </td>
                        <td class="host-spec" valign="top">
                            <span tal:content="string:${data/host}:${data/port}" />
                        </td>
                        <td class="user-spec" valign="top">
                            <span tal:content="data/username" />
                        </td>
                        <td valign="top">
                            <span tal:content="string:${data/type} - ${data/value}" />
                        </td>
                        <td class="action" valign="top">
                            <input type="button" tal:attributes="rel string:#details-${repeat/data/number}" value="Details" />
                            <div class="overlay" tal:attributes="id string:details-${repeat/data/number}" tal:content="structure data/tb_html" />
                        </td>
                    </tr>
                </tal:loop>
            </tbody>
        </table>
        <input type="button" onclick="backToMain()" value="Back to main view" />

    </body>
</html>
