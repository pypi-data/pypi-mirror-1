<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="upfrontcontacts">

<body>

<metal:block fill-slot="top_slot"
    tal:define="dummy python:request.set('disable_border', 0)" />

<div metal:fill-slot="main">

<style type="text/css" tal:condition="exists: portal/upfrontcontacts.css"
    tal:content="structure string:<!-- @import url($portal_url/upfrontcontacts.css); -->">
</style>

    <div metal:use-macro="here/document_actions/macros/document_actions">
        Document actions (print, sendto etc)
    </div>

    <h1 tal:content="object_title" class="documentFirstHeading">
        Title or id
    </h1>

    <a href=""
        class="link-parent"
        tal:define="parent_url python:here.navigationParent(here, template_id)"
        tal:condition="parent_url"
        tal:attributes="href parent_url"
        i18n:translate="go_to_parent_url">
    Up one level
    </a>

    <p class="documentDescription"
        tal:content="here/Description"
        tal:condition="here/Description">
        Description
    </p>

    <div class="SectionHeader">
        <a href="createObject?type_name=Organisation">Add a new organisation</a>
        (then you can add people to that organisation)
    </div>

    <div id="organisation_list"
        tal:define="Batch python:modules['Products.CMFPlone'].Batch">
        <table class="contacts" tal:repeat="company_and_people here/get_companies_and_people">
            <tal:batch tal:define="organisation python:company_and_people[0]"
                tal:repeat="batch_start python:range(0, len(company_and_people), 3)">
            <tal:row tal:define="batch python:Batch(company_and_people, 3, batch_start)">
            <tr class="top">
                <tal:cell tal:repeat="obj batch">
                <td class="organisation" tal:condition="python:obj.portal_type == 'Organisation'">
                    <h1 tal:content="obj/Title">Organisation Name</h1>
                    <p tal:condition="obj/getPhysicalAddressAsString"
                       tal:content="obj/getPhysicalAddressAsString">
                        Address, City, Country
                    </p>
                    <p>
                        <span tal:condition="obj/getPhone" class="item"><span class="label">O:</span>
                            <span tal:replace="obj/getPhone">+27 21 888 0000</span> 
                        </span>
                        <span class="item"><span class="label">F:</span>
                            <span tal:replace="obj/getFax">+27 21 888 0000</span> 
                        </span>
                    </p>
                    <p class="admin" style="line-height: 14px; border-top: 1px dotted #dcdcdc; margin-top: 5px; padding-top: 2px;">
                        <a href="#" class="admin" tal:attributes="href string:${obj/getURL}/base_edit">Edit</a> this organisation<br />
                        <a href="#" tal:attributes="href string:add_person?organisation_uid=${obj/UID}" class="admin">Add person</a> to this organisation<br />
                    </p>
                </td>
                <td class="nopeople" colspan="2" tal:condition="python:len(company_and_people) == 1">
                    <a href="#" class="admin" tal:attributes="href string:add_person?organisation_uid=${obj/UID}">Add the first person</a> to <span tal:replace="organisation/Title">Organisation</span><br/>
                </td>

                <td class="person" tal:condition="python:obj.portal_type == 'Person'">
                    <h1 tal:content="obj/Title">Roch√© Compaan</h1>
                        
                    <p><a href="mailto:user@domain.com"
                        tal:attributes="href string:mailto::${obj/getEmail}"
                        tal:content="obj/getEmail">user@domain.com</a></p>
                    <p tal:condition="obj/getBusinessPhone"><span class="label">O:</span>
                        <span tal:replace="obj/getBusinessPhone">1324</span></p>
                    <p tal:condition="obj/getMobilePhone"><span class="label">M:</span>
                        <span tal:replace="obj/getMobilePhone">123</span></p>
                    <p tal:condition="obj/getHomePhone"><span class="label">H:</span>
                        <span tal:replace="obj/getHomePhone">1234</span></p>
                    <p tal:condition="obj/getBusinessFax"><span class="label">F:</span>
                        <span tal:replace="obj/getBusinessFax">1234</span></p>

                    <p class="admin" style="border-top: 1px dotted #efefef; margin-top: 5px; padding-top: 2px;">
                        <a href="#" class="admin" tal:attributes="href string:${obj/getURL}/base_edit">Edit</a>
                    </p>
                </td>
                </tal:cell>
                <tal:blank tal:condition="python:len(batch) < 3">
                    <tal:block tal:repeat="i python:range(3 - len(batch))">
                        <td class="blank">&nbsp;</td>
                    </tal:block>
                </tal:blank>

            </tr>
            </tal:row>
            </tal:batch>
        </table>
    </div>

</div>
</body>
</html>
