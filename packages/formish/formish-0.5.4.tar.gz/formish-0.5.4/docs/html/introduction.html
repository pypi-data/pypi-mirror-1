<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>About Formish &mdash; Formish v1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '',
          VERSION:     '1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Formish v1 documentation" href="index.html" />
    <link rel="next" title="Using Formish within Restish" href="restish.html" />
    <link rel="prev" title="Welcome to Formish&#8217;s documentation!" href="index.html" /> 


  <link media="screen" href="_static/css/screen.css" type="text/css" rel="stylesheet" />
  <link media="screen" href="_static/css/images.css" type="text/css" rel="stylesheet" />
  <link media="screen" href="_static/css/sIFR-screen.css" type="text/css" rel="stylesheet" />
  <link media="print" href="_static/css/sIFR-print.css" type="text/css" rel="stylesheet" />  
  <script type="text/javascript" src="_static/js/sifr.js" ></script>
  <script type="text/javascript" src="_static/js/sifr-config.js" ></script> 
  <script type="text/javascript" src="_static/js/sifr-debug.js" ></script> 

  </head>
  <body id="sphinx">
    <div id="wrapper">
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="restish.html" title="Using Formish within Restish"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Formish&#8217;s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Formish v1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div id="header">
      <div id="logo"><img src="_static/images/logo/ish.io.png" /></div>
      <div id="overview"><a href="http://ish.io/projects/show/formish">Overview</a></div>
    </div>

<div id="main">
    <div  class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="about-formish">
<h1>About Formish<a class="headerlink" href="#about-formish" title="Permalink to this headline">¶</a></h1>
<p>Formish is a templating language agnostic form generation and handling library.</p>
<div class="section" id="introduction-a-simple-form">
<h2>Introduction - A Simple Form<a class="headerlink" href="#introduction-a-simple-form" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-schema">
<h3>Creating a schema<a class="headerlink" href="#creating-a-schema" title="Permalink to this headline">¶</a></h3>
<p>First of all we need to create a data schema to define what types of data we want in the form. Schema&#8217;s use the &#8216;Schemaish&#8217; package which lets you define structures against which you can validate/convert data. Lets take a look at the structure of a Form instance to begin with</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">schemaish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfield&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">attrs</span>
<span class="go">[(&#39;myfield&#39;, &lt;schemaish.attr.String object at 0x...&gt;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-form">
<h3>Creating a form<a class="headerlink" href="#creating-a-form" title="Permalink to this headline">¶</a></h3>
<p>So we now have a single field in our schema which is defined as a string. We can now create a form from this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">formish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="attributes-of-a-form">
<h4>Attributes of a form<a class="headerlink" href="#attributes-of-a-form" title="Permalink to this headline">¶</a></h4>
<p>And what can we do with the form? Well at the moment we have a form name and some fields</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;formish&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">form</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">field</span>
<span class="gp">...</span>
<span class="go">&lt;formish.forms.Field object at 0x...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="attributes-of-a-field">
<h4>Attributes of a field<a class="headerlink" href="#attributes-of-a-field" title="Permalink to this headline">¶</a></h4>
<p>And what about our field? Well it&#8217;s now become a form field, which means it has a few extra attributes to do with creating things like classes, ids, etc.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;myfield&#39;</span>
</pre></div>
</div>
<p>Obviously the name is what we have it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">widget</span>
<span class="go">&lt;bound widget name=&quot;myfield&quot;, widget=&quot;Input&quot;, type=&quot;String&quot;&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">title</span>
<span class="go">&#39;Myfield&#39;</span>
</pre></div>
</div>
<p>The title, if not specified in the schema field, is derived from the form name by converting camel case into capitalised words.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">cssname</span>
<span class="go">&#39;formish-myfield&#39;</span>
</pre></div>
</div>
<p>This is the start of the templating stuff.. The cssname is an identifier that can be inserted into forms, used for ids and class names.</p>
</div>
</div>
<div class="section" id="how-to-create-html">
<h3>How to create HTML<a class="headerlink" href="#how-to-create-html" title="Permalink to this headline">¶</a></h3>
<p>We create our HTML by calling the form as follows..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">()</span>
<span class="go">&#39;...&lt;form id=&quot;formish&quot; action=&quot;&quot; class=&quot;formish-form&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; accept-charset=&quot;utf-8&quot;&gt;...&#39;</span>
</pre></div>
</div>
<p>I&#8217;ve skipped the majority of this output as it&#8217;s probably better shown formatted</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;formish&quot;</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">class=</span><span class="s">&quot;formish-form&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="na">accept-charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;_charset_&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;__formish_form__&quot;</span> <span class="na">value=</span><span class="s">&quot;formish&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield&quot;</span><span class="nt">&gt;</span>Myfield<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;actions&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">id=</span><span class="s">&quot;formish-action-submit&quot;</span> <span class="na">name=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="what-s-in-the-html">
<h3>What&#8217;s in the HTML<a class="headerlink" href="#what-s-in-the-html" title="Permalink to this headline">¶</a></h3>
<p>Firstly we have the form setup itself. The form name/id can be set by passing it into the Form as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">named_form</span> <span class="o">=</span> <span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;myformname&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Otherwise the form defaults to &#8216;formish&#8217;.</p>
<p>The method at the moment is always &#8216;post&#8217; but a future release will implement get forms also. The final two attributes, enctype and accept-charset make the form behave in as consistent a way as possible. Defaulting to content type of &#8216;utf-8&#8217; and handling the form data accoring to <a class="reference external" href="http://www.ietf.org/rfc/rfc2388.txt">http://www.ietf.org/rfc/rfc2388.txt</a> &#8216;multipart/form-data&#8217;.</p>
<div class="section" id="the-form-html-element">
<h4>The form html element<a class="headerlink" href="#the-form-html-element" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="c">&lt;!-- The Form --&gt;</span>
<span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;formish&quot;</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="na">accept-charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>The first hidden field is &#8216;_charset_ which is a hack to help mozilla handle charsets as described here <a class="reference external" href="https://bugzilla.mozilla.org/show_bug.cgi?id=18643">https://bugzilla.mozilla.org/show_bug.cgi?id=18643</a>. The second is the name of the form, used after submission to work out which form has been returned.</p>
</div>
<div class="section" id="the-form-configuration-attributes">
<h4>The form configuration attributes<a class="headerlink" href="#the-form-configuration-attributes" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="c">&lt;!-- Form Configuration Attributes --&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;_charset_&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;__formish_form__&quot;</span> <span class="na">value=</span><span class="s">&quot;formish&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>The field itself has an id, using the form name, field name and the suffix &#8216;-field&#8217; to help with javascript, css, etc. There are also a bunch of classes that allow global css to be applied to different widget types or schema types.</p>
<p>The label points at the field, which in this case is the only input field. In the case of a date parts widget (three input boxes), the label&#8217;s for attribute would point at the first field.</p>
<p>The &#8216;input&#8217;s div is a container that holds the widget itself, in this case just a single input field with an id for the label to point at.</p>
</div>
<div class="section" id="the-input-field-s">
<h4>The input field(s)<a class="headerlink" href="#the-input-field-s" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="c">&lt;!-- The String Field --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield&quot;</span><span class="nt">&gt;</span>Myfield<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="the-action-s">
<h4>The action(s)<a class="headerlink" href="#the-action-s" title="Permalink to this headline">¶</a></h4>
<p>Finally, the actions block contains all of the submit buttons - in this case just a single input with the default &#8216;submit&#8217; value.</p>
<div class="highlight-html"><div class="highlight"><pre>  <span class="c">&lt;!-- The Action(s) --&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;actions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">id=</span><span class="s">&quot;formish-action-submit&quot;</span> <span class="na">name=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="processing-the-submitted-form">
<h3>Processing the Submitted Form<a class="headerlink" href="#processing-the-submitted-form" title="Permalink to this headline">¶</a></h3>
<p>Once the form is submitted, we can get the data by calling &#8216;validate&#8217;. In order to simulate this, we&#8217;re going to create a request object by hand using webob..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">webob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">webob</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;http://localhost/&#39;</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;REQUEST_METHOD&#39;</span><span class="p">:</span> <span class="s">&#39;POST&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;myvalue&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">{&#39;myfield&#39;: u&#39;myvalue&#39;}</span>
</pre></div>
</div>
<p>And that is our simple form overview complete.</p>
</div>
</div>
<div class="section" id="introduction-a-slightly-more-complex-form">
<h2>Introduction - A Slightly More Complex Form<a class="headerlink" href="#introduction-a-slightly-more-complex-form" title="Permalink to this headline">¶</a></h2>
<p>OK, We&#8217;re going to put a more things together for this..</p>
<ul class="simple">
<li>A custom form name</li>
<li>Different schema types</li>
<li>different widgets</li>
<li>Form errors</li>
</ul>
<div class="section" id="creating-the-form">
<h3>Creating the form<a class="headerlink" href="#creating-the-form" title="Permalink to this headline">¶</a></h3>
<p>For our contrived example, we&#8217;ll build a simple registration form.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">schemaish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;firstName&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;surname&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;dateOfBirth&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;streetNumber&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;country&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;termsAndConditions&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Boolean</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, we&#8217;ve got strings, an integer, a data and a boolean.</p>
<p>We could also have built the schema using a declarative style</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MySchema</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">firstName</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">surname</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">dateOfBirth</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">streetNumber</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">country</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">termsAndConditions</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Boolean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">MySchema</span><span class="p">())</span>
</pre></div>
</div>
<p>By default, all of the fields use input boxes with the date asking for isoformat and the boolean asking for True or False. We want to make the form a little friendlier though.</p>
<p>We&#8217;ll start with the date widget. Date parts uses three input boxes instead of a single input and, by default, is in US month first format. We&#8217;re in the UK so we change dayFirst to True</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;dateOfBirth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">DateParts</span><span class="p">(</span><span class="n">dayFirst</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we&#8217;ll make the country a select box. To do this we pass a series of options to the SelectChoice widget.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">SelectChoice</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;UK&#39;</span><span class="p">,</span><span class="s">&#39;US&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If we wanted different values for our options we would pass each option in as a tuple of (&#8216;value&#8217;,&#8217;label&#8217;). We could also set a label for the field that appears when there is no input value. This is called the &#8216;none_option&#8217;. The none_options defaults to (&#8216;&#8217;, &#8216;&#8211;choose&#8211;&#8217;) so we could change it to (&#8216;&#8217;,&#8217;Pick a Country&#8217;). Here is an example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;UK&#39;</span><span class="p">,</span><span class="s">&#39;I live in the UK&#39;</span><span class="p">),(</span><span class="s">&#39;US&#39;</span><span class="p">,</span><span class="s">&#39;I live in the US&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">none_option</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;Where do you live&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">SelectChoice</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span> <span class="n">none_option</span><span class="o">=</span><span class="n">none_option</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we&#8217;d like a checkbox for the Boolean value</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;termsAndConditions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="how-does-this-form-work">
<h3>How does this form work?<a class="headerlink" href="#how-does-this-form-work" title="Permalink to this headline">¶</a></h3>
<p>Well let&#8217;s give it some default values and look at what we get.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;firstName&#39;</span><span class="p">:</span> <span class="s">&#39;Tim&#39;</span><span class="p">,</span> <span class="s">&#39;surname&#39;</span><span class="p">:</span> <span class="s">&#39;Parkin&#39;</span><span class="p">,</span> <span class="s">&#39;dateOfBirth&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mf">1966</span><span class="p">,</span><span class="mf">12</span><span class="p">,</span><span class="mf">18</span><span class="p">),</span> <span class="s">&#39;streetNumber&#39;</span><span class="p">:</span> <span class="mf">123</span><span class="p">,</span> <span class="s">&#39;country&#39;</span><span class="p">:</span> <span class="s">&#39;UK&#39;</span><span class="p">,</span> <span class="s">&#39;termsAndConditions&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
</pre></div>
</div>
<p>If we create the form now, we get the following fields. One thing to note is that most widgets within Formish use strings to serialise their values into forms. The exception here is the date parts widget.</p>
<div class="section" id="string-fields">
<h4>String fields<a class="headerlink" href="#string-fields" title="Permalink to this headline">¶</a></h4>
<p>This is the same as our first example but note that the label for firstName has been expanded into &#8216;First Name&#8217;.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-firstName-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-firstName&quot;</span><span class="nt">&gt;</span>First Name<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-firstName&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;firstName&quot;</span> <span class="na">value=</span><span class="s">&quot;Tim&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-surname-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-surname&quot;</span><span class="nt">&gt;</span>Surname<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-surname&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;surname&quot;</span> <span class="na">value=</span><span class="s">&quot;Parkin&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="date-field">
<h4>Date Field<a class="headerlink" href="#date-field" title="Permalink to this headline">¶</a></h4>
<p>The date field splits the date into three parts, each part indicated using dotted notation.</p>
<div id="formish-dateOfBirth-field" class="field date dateparts">
  <label for="formish-dateOfBirth">Date Of Birth</label>
  <div class="inputs">
    <input id="formish-dateOfBirth" type="text" name="dateOfBirth.day" value="18" size="2" /> /
    <input id="formish-dateOfBirth-month" type="text" name="dateOfBirth.month" value="12" size="2" /> /
    <input id="formish-dateOfBirth-year" type="text" name="dateOfBirth.year" value="1966" size="4" />
  </div>
</div><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field date dateparts&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-dateOfBirth&quot;</span><span class="nt">&gt;</span>Date Of Birth<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.day&quot;</span> <span class="na">value=</span><span class="s">&quot;18&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span> /
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-month&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.month&quot;</span> <span class="na">value=</span><span class="s">&quot;12&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span> /
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-year&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.year&quot;</span> <span class="na">value=</span><span class="s">&quot;1966&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="integer-field">
<h4>Integer Field<a class="headerlink" href="#integer-field" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-streetNumber-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field integer input&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-streetNumber&quot;</span><span class="nt">&gt;</span>Street Number<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-streetNumber&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;streetNumber&quot;</span> <span class="na">value=</span><span class="s">&quot;123&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="select-field">
<h4>Select Field<a class="headerlink" href="#select-field" title="Permalink to this headline">¶</a></h4>
<p>This uses the &#8216;none_option&#8217; value to show &#8216;Where do you live&#8217; by default but because we have set a default value, &#8216;I live in the UK&#8217; is selected.</p>
<div id="formish-country-field" class="field string selectchoice">
  <label for="formish-country">Country</label>
  <div class="inputs">
    <select id="formish-country" name="country">
      <option value="">Where do you live</option>
      <option value="UK" selected="selected" >I live in the UK</option>
      <option value="US" >I live in the US</option>
    </select>
  </div>
</div><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-country-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string selectchoice&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-country&quot;</span><span class="nt">&gt;</span>Country<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;formish-country&quot;</span> <span class="na">name=</span><span class="s">&quot;country&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Where do you live<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;UK&quot;</span> <span class="na">selected=</span><span class="s">&quot;selected&quot;</span> <span class="nt">&gt;</span>I live in the UK<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;US&quot;</span> <span class="nt">&gt;</span>I live in the US<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="boolean-field">
<h4>Boolean Field<a class="headerlink" href="#boolean-field" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-termsAndConditions-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field boolean checkbox&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-termsAndConditions&quot;</span><span class="nt">&gt;</span>Terms And Conditions<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-termsAndConditions&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name=</span><span class="s">&quot;termsAndConditions&quot;</span> <span class="na">value=</span><span class="s">&quot;True&quot;</span> <span class="na">checked=</span><span class="s">&quot;checked&quot;</span>  <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Processing the submitted form<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Repeating the creation of a request using webob, setting some input values and validating gives us:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">webob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">webob</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;http://localhost/&#39;</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;REQUEST_METHOD&#39;</span><span class="p">:</span> <span class="s">&#39;POST&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;firstName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Tim&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;surname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Parkin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;streetNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;123&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;dateOfBirth.day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;18&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;dateOfBirth.month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;13&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;dateOfBirth.year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;1966&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;UK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;termsAndConditions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;True&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">...formish.validation.FormError: Tried to access data but conversion from request failed with 1 errors</span>
</pre></div>
</div>
<p>The observant amongst you will notice I put a month of 13 in which has triggered a FormError.</p>
<p>Let&#8217;s look at some of the error states on the form now</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">errors</span>
<span class="go">{&#39;dateOfBirth&#39;: ConvertError(&#39;Invalid date: month must be in 1..12&#39;,)}</span>
</pre></div>
</div>
<p>The form has a dictionary of errors on it that map to the field names.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s">&#39;dateOfBirth&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">error</span>
<span class="go">ConvertError(&#39;Invalid date: month must be in 1..12&#39;,)</span>
</pre></div>
</div>
<p>The dateOfBirth field shows it&#8217;s own error.</p>
</div>
<div class="section" id="showing-the-errors">
<h3>Showing the errors<a class="headerlink" href="#showing-the-errors" title="Permalink to this headline">¶</a></h3>
<p>The whole form is now in an error state and we can interrogate it about the errors. The form will also render itself with these errors.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">classes</span>
<span class="go">&#39;field date dateparts error&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces the following - note the error &#8216;span&#8217; below the form field.</p>
<div id="formish-dateOfBirth-field" class="field date dateparts error">
  <label for="formish-dateOfBirth">Date Of Birth</label>
  <div class="inputs">
    <input id="formish-dateOfBirth" type="text" name="dateOfBirth.day" value="18" size="2" /> /
    <input id="formish-dateOfBirth-month" type="text" name="dateOfBirth.month" value="13" size="2" /> /
    <input id="formish-dateOfBirth-year" type="text" name="dateOfBirth.year" value="1966" size="4" />
  </div>
  <span class="error">Invalid date: month must be in 1..12</span>
</div><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field date dateparts error&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-dateOfBirth&quot;</span><span class="nt">&gt;</span>Date Of Birth<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.day&quot;</span> <span class="na">value=</span><span class="s">&quot;18&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span> /
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-month&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.month&quot;</span> <span class="na">value=</span><span class="s">&quot;13&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span> /
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-dateOfBirth-year&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;dateOfBirth.year&quot;</span> <span class="na">value=</span><span class="s">&quot;1966&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;error&quot;</span><span class="nt">&gt;</span>Invalid date: month must be in 1..12<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Calling the &#8216;form()&#8217; will render the whole form including the error messages.</p>
<p>Let&#8217;s see what happens if we have an invalid integer - we&#8217;ll fix the month first</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;dateOfBirth.month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;12&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;streetNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;aa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">...formish.validation.FormError: Tried to access data but conversion from request failed with 1 errors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s">&#39;streetNumber&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">error</span>
<span class="go">ConvertError(&#39;Not a valid number&#39;,)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Finally, lets see what valid data gives us..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;streetNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;123&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">{&#39;termsAndConditions&#39;: True, &#39;surname&#39;: u&#39;Parkin&#39;, &#39;firstName&#39;: u&#39;Tim&#39;, &#39;country&#39;: u&#39;UK&#39;, &#39;dateOfBirth&#39;: datetime.date(1966, 12, 18), &#39;streetNumber&#39;: 123}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>Validation in Formish uses simple callable validators that raise exceptions if validation fails (Either a formish.FieldValidationError or a validatish.Invalid exception.</p>
<div class="section" id="how-validators-work">
<h3>How Validators Work<a class="headerlink" href="#how-validators-work" title="Permalink to this headline">¶</a></h3>
<p>There is a library of validators called Validatish that has most of the typical examples you might need. Let&#8217;s take a look at a simple integer validator.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">is_string</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;must be a string&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">basestring</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">Invalid</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>the String validater get&#8217;s called and raises an exception if the value is not an instance of &#8216;basestring&#8217;. Lets take a look at another validator</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Actual validators should not raise errors when None is passed. This is to make sure non-required fields don&#8217;t raise errors if they are left empty.</p>
</div>
<p>Here we have an integer validator. This tries to convert the value to an integer and if it fails, raises an exception.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">is_integer</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;must be an integer&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">Invalid</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">Invalid</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s see this one in action</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfield&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">validator</span><span class="o">=</span><span class="n">validatish</span><span class="o">.</span><span class="n">is_integer</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">webob</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;http://localhost/&#39;</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;REQUEST_METHOD&#39;</span><span class="p">:</span> <span class="s">&#39;POST&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;aa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">...formish.validation.FormError: Tried to access data but conversion from request failed with 1 errors</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">errors</span>
<span class="go">{&#39;myfield&#39;: ConvertError(&#39;Not a valid number&#39;,)}</span>
</pre></div>
</div>
<p>Whilst it is perfectly acceptable to use functions for validation, our main library uses classes to aid type checking (for example to find out if our field is required for css styling) and in order to pass validator configuration.</p>
<p>The validatish library is split up into two main modules, validate and validator. Validate contains the functions that do the actual validation. Validators are class wrappers around the functions.</p>
<p>For example, here is our required validation function and validator</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">is_required</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Invalid</span><span class="p">(</span><span class="s">&quot;is required&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Required</span><span class="p">(</span><span class="n">Validator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Checks that the value is not empty &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">validate</span><span class="o">.</span><span class="n">is_required</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>The Required validator is sub-classing Validator but this is just an interface class (i.e. just documents the necessary methods - in this case just __call__)</p>
<p>So the validator is a callable and it uses the python &#8216;non_zero&#8217; check so see if we have a value. Obviously we have to let zero through because if we&#8217;re asking for an integer, zero is a valid answer; However, an empty string, empty list or None is invalid.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Required validator must be sub-classed if you want to create your own required validator. This is to ensure that formish inserts the appropriate css to mark up the required form fields</p>
</div>
</div>
</div>
<div class="section" id="file-uploads">
<h2>File Uploads<a class="headerlink" href="#file-uploads" title="Permalink to this headline">¶</a></h2>
<div class="section" id="short-version">
<h3>Short Version<a class="headerlink" href="#short-version" title="Permalink to this headline">¶</a></h3>
<p>We handle files for you so that all you have to do is process the file handle given to you.. Here is an example using the default filehandlers..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfile&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">File</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">from</span> <span class="nn">formish</span> <span class="k">import</span> <span class="n">filehandler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">FileUpload</span><span class="p">(</span><span class="n">filehandler</span><span class="o">=</span><span class="n">filehandler</span><span class="o">.</span><span class="n">TempFileHandlerWeb</span><span class="p">())</span>
</pre></div>
</div>
<div class="section" id="what-does-this-produce">
<h4>What does this produce?<a class="headerlink" href="#what-does-this-produce" title="Permalink to this headline">¶</a></h4>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-myfile-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field type fileupload&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfile&quot;</span><span class="nt">&gt;</span>Myfile<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfile-remove&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name=</span><span class="s">&quot;myfile.remove&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfile-id&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;myfile.name&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfile-default&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;myfile.default&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfile&quot;</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">name=</span><span class="s">&quot;myfile.file&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>and looks like</p>
<div id="formish-myfile-field" class="field type fileupload">
  <label for="formish-myfile">Myfile</label>
  <div class="inputs">
    <input id="formish-myfile-remove" type="checkbox" name="myfile.remove" value="true" />
    <input id="formish-myfile-id" type="hidden" name="myfile.name" value="" />
    <input id="formish-myfile-default" type="hidden" name="myfile.default" value="" />
    <input id="formish-myfile" type="file" name="myfile.file" />
  </div>
</div><p>The checkbox is included to allow you to remove a file if necessary.</p>
</div>
<div class="section" id="how-does-this-return-a-file-to-me">
<h4>How does this return a file to me?<a class="headerlink" href="#how-does-this-return-a-file-to-me" title="Permalink to this headline">¶</a></h4>
<p>You will get a schemaish.type.File object back which looks like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">File</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mimetype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mimetype</span><span class="o">=</span><span class="n">mimetype</span>
</pre></div>
</div>
<p>Where file is a file like object, filename is the original filename and the mimetype is worked out from the file suffix. All you have to do is <tt class="docutils literal"><span class="pre">.read()</span></tt> from the file attribute to get the contents.</p>
</div>
</div>
<div class="section" id="longer-version">
<h3>Longer Version<a class="headerlink" href="#longer-version" title="Permalink to this headline">¶</a></h3>
<p>File uploads are quite often the most difficult aspect of form handling. Formish has tried to make some pragmatic decisions that should ease this process for you. The first of these decisions is what type of data to use to store a file. Because we are using webob, files that arrive in formish do so in FieldStorage representation.</p>
<div class="section" id="upload-file-temporary-storage">
<h4>Upload File Temporary Storage<a class="headerlink" href="#upload-file-temporary-storage" title="Permalink to this headline">¶</a></h4>
<p>Formish tries to ensure that fields are &#8216;symmetric&#8217;. i.e. what goes in comes back out in the same format). For text fields this is quite simple but for a file upload things are a little more difficult. What formish does is to use a temporary store in order to save the file in a secure location for access later. You can implement this store if you wish, using sessions or databaseses, etc. Here is the signature for a filehandler..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FileHandlerMinimal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Example of File handler for formish file upload support. &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">store_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to store a file &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_path_for_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to get a path for a file on disk &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>As you can see, the two important things are a method to store the file and a method to get the file back off disk given the filename.</p>
<p>Our tempfile handler implements this as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TempFileHandler</span><span class="p">(</span><span class="n">FileHandlerMinimal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    File handler using python tempfile module to store file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">store_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
        <span class="n">fileno</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span><span class="n">fs</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">fileno</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempprefix</span><span class="p">()</span>
        <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">filename</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="o">+</span><span class="mf">1</span><span class="p">):]</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">filename</span>

    <span class="k">def</span> <span class="nf">get_path_for_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempprefix</span><span class="p">()</span>
        <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/</span><span class="si">%s%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We also implement a <tt class="docutils literal"><span class="pre">get_mimetype</span></tt> method that helps in building the schemaish.type.File</p>
</div>
<p>We typically want to access the file again from our widget however (especially in the case of image uploads!). Formish extends the TempFileHandler with a get_url_for_file method as follows..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TempFileHandlerWeb</span><span class="p">(</span><span class="n">TempFileHandler</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_url</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">resource_root</span><span class="o">=</span><span class="s">&#39;/filehandler&#39;</span><span class="p">,</span><span class="n">urlfactory</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_url</span> <span class="o">=</span> <span class="n">default_url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource_root</span> <span class="o">=</span> <span class="n">resource_root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">urlfactory</span> <span class="o">=</span> <span class="n">urlfactory</span>

    <span class="k">def</span> <span class="nf">get_url_for_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">urlfactory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">urlfactory</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_root</span><span class="p">,</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p>This needs configuring with a resource root (where to find files), a default_url (if we have no file, what to use - useful to showing missing images) and a urlfactory (how to convert a object into a url representation).</p>
</div>
<div class="section" id="so-what-happens-when-a-file-is-uploaded">
<h4>So what happens when a file is uploaded?<a class="headerlink" href="#so-what-happens-when-a-file-is-uploaded" title="Permalink to this headline">¶</a></h4>
<p>If we&#8217;re using the TempFileHandlerWeb handler the following steps take place.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">we&#8217;ll presume that the first form submit has a missing field and so the form gets redisplayed.</p>
</div>
<p>The first time a file is uploaded, formish takes the FieldStorage object and copies the contents of the file to a tempfile using it&#8217;s <tt class="docutils literal"><span class="pre">store_file</span></tt> method.</p>
<p>When the form page is redisplayed, the widget uses the handlers <tt class="docutils literal"><span class="pre">get_url_for_file`</span></tt> method to work out a url for the file. The file can then be displayed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We&#8217;re not covering how the file is actually displayed. This is framework specific but we&#8217;ll give an example for restish after this section.</p>
</div>
<p>When the users completes the corrections to the form and resubmits, formish processes the file. It first checks to see if the file is new (the widget stores a reference to the old file so it can check) and if it isn&#8217;t new, it returns a schema.type.File object with None for all of the attributes.</p>
<p>If there is no file (i.e. no file was submitted on a clean form or a file was removed using the checkbox) then a None is returned.</p>
<p>If the file is new or has changed, formish generates the schemaish.type.File object from the data stored in the temporary file.</p>
</div>
<div class="section" id="what-else-can-i-configure">
<h4>What else can I configure?<a class="headerlink" href="#what-else-can-i-configure" title="Permalink to this headline">¶</a></h4>
<p>The formish <tt class="docutils literal"><span class="pre">FileUpload</span></tt> widget takes the following arguments</p>
<dl class="method">
<dt id="formish.widgets.FileUpload.__init__">
<!--[formish.widgets.FileUpload.__init__]--><tt class="descclassname">FileUpload.</tt><tt class="descname">__init__</tt><big>(</big><em>filehandler</em>, <em>show_image_preview=False</em>, <em>allow_clear=True</em>, <em>css_class=None</em>, <em>originalurl=None</em><big>)</big><a class="headerlink" href="#formish.widgets.FileUpload.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>filehandler</em> &#8211; <p>filehandler is any object with the following methods:</p>
<dl class="docutils">
<dt>storeFile(self, f)</dt>
<dd>where f is a file instance</dd>
<dt>getUrlForFile(self, data)</dt>
<dd>where data is the form item data or a path to a temporary file
and is expected to return a URL to access the persisted or
temporary data.</dd>
</dl>
</li>
<li><em>show_image_preview</em> &#8211; a boolean that, if set, will include an image
thumbnail with the widget</li>
<li><em>css_class</em> &#8211; extra css classes to apply to the widget</li>
<li><em>originalurl</em> &#8211; a default url to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="sequences">
<h2>Sequences<a class="headerlink" href="#sequences" title="Permalink to this headline">¶</a></h2>
<p>Formish also handles sequences in fields, the basic example of this is the checkbox and the multi-select. However formish can also handle sequences in text areas and also sequences in separate fields.</p>
<div class="section" id="checkbox-multi-choice">
<h3>Checkbox Multi Choice<a class="headerlink" href="#checkbox-multi-choice" title="Permalink to this headline">¶</a></h3>
<p>Now we&#8217;ve talked through the basics.. I&#8217;ll skip a lot of the detail and just demonstrate the process..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfield&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">())</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;myfield&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2</span><span class="p">,</span><span class="mf">4</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">CheckboxMultiChoice</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">4</span><span class="p">])</span>
</pre></div>
</div>
<p>Let&#8217;s take a look at the html that produced..</p>
<div id="formish-myfield-field" class="field sequence checkboxmultichoice">
  <label for="formish-myfield">Myfield</label>
  <div class="inputs">
    <input id="formish-myfield-0" name="myfield" type="checkbox" value="1" />
    <label for="formish-myfield-0">1</label>
    <br />
    <input id="formish-myfield-1" name="myfield" type="checkbox" value="2" checked="checked" />
    <label for="formish-myfield-1">2</label>
    <br />
    <input id="formish-myfield-2" name="myfield" type="checkbox" value="3" />
    <label for="formish-myfield-2">3</label>
    <br />
    <input id="formish-myfield-3" name="myfield" type="checkbox" value="4" checked="checked" />
    <label for="formish-myfield-3">4</label>
    <br />
  </div>
</div><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field sequence checkboxmultichoice&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield&quot;</span><span class="nt">&gt;</span>Myfield<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-0&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield-0&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-1&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span> <span class="na">checked=</span><span class="s">&quot;checked&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield-1&quot;</span><span class="nt">&gt;</span>2<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-2&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield-2&quot;</span><span class="nt">&gt;</span>3<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-3&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">value=</span><span class="s">&quot;4&quot;</span> <span class="na">checked=</span><span class="s">&quot;checked&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield-3&quot;</span><span class="nt">&gt;</span>4<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="select-multi-choice">
<h3>Select Multi Choice<a class="headerlink" href="#select-multi-choice" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not implemented yet</p>
</div>
</div>
<div class="section" id="text-area-sequence">
<h3>Text Area Sequence<a class="headerlink" href="#text-area-sequence" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it&#8217;s easier to enter information directly into a textarea</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">TextArea</span><span class="p">()</span>
</pre></div>
</div>
<p>Which produces a simple text area as html. When it processes this textarea, it uses the csv module to get the data (it also uses it to put the default data onto the form). By default, the conversion uses commas for a simple sequence. e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;myfield&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">7</span><span class="p">]}</span>
</pre></div>
</div>
<div id="formish-myfield-field" class="field sequence textarea">
  <label for="formish-myfield">Myfield</label>
  <div class="inputs">
    <textarea id="formish-myfield" name="myfield">1,3,5,7</textarea>
  </div>
</div><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-myfield-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field sequence textarea&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-myfield&quot;</span><span class="nt">&gt;</span>Myfield<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">&quot;formish-myfield&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span><span class="nt">&gt;</span>1,3,5,7<span class="nt">&lt;/textarea&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>However you can change this behaviour by passing the Textarea widget a converter_option dictionary value .. e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">TextArea</span><span class="p">(</span><span class="n">converter_options</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;delimiter&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">})</span>
</pre></div>
</div>
  <textarea id="formish-myfield" name="myfield">1
3
5
7</textarea><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">&quot;formish-myfield&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span><span class="nt">&gt;</span>1\n3\n5\n7<span class="nt">&lt;/textarea&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="text-area-sequence-of-sequences">
<h3>Text Area Sequence of Sequences<a class="headerlink" href="#text-area-sequence-of-sequences" title="Permalink to this headline">¶</a></h3>
<p>You can also use a textarea to represent a sequence of sequences...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfield&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;myfield&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">2</span><span class="p">,</span><span class="mf">4</span><span class="p">],[</span><span class="mf">6</span><span class="p">,</span><span class="mf">8</span><span class="p">]]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">TextArea</span><span class="p">()</span>
</pre></div>
</div>
<p>In this case, the default delimiter is a comma and is used on a row by row basis.</p>
  <textarea id="formish-myfield" name="myfield">2,4
6,8</textarea><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">&quot;formish-myfield&quot;</span> <span class="na">name=</span><span class="s">&quot;myfield&quot;</span><span class="nt">&gt;</span>2,4\n6,8<span class="nt">&lt;/textarea&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-input-fields">
<h3>Multiple Input Fields<a class="headerlink" href="#multiple-input-fields" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This code hasn&#8217;t settled down yet, please check for updates.</p>
</div>
<p>If you just pass a sequence to a form without any widgets, a jquery powered sequence editor will be used. This will allow you to add and remove the fields within the sequence. Check the &#8216;testish&#8217; application for more details.</p>
</div>
</div>
<div class="section" id="nested-form-structures">
<h2>Nested Form Structures<a class="headerlink" href="#nested-form-structures" title="Permalink to this headline">¶</a></h2>
<p>Formish also allows you to create sub-sections in forms that can contain any other valid form part. We&#8217;ll use an address and name section to expand out registration form.</p>
<div class="section" id="a-structure-of-structures">
<h3>A Structure of Structures<a class="headerlink" href="#a-structure-of-structures" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyName</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">firstName</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">surname</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyAddress</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">streetNumber</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">country</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MySchema</span><span class="p">(</span><span class="n">schemaish</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">MyName</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">address</span> <span class="o">=</span> <span class="n">MyAddress</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">termsAndConditions</span> <span class="o">=</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Boolean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">MySchema</span><span class="p">())</span>
</pre></div>
</div>
<p>This will create the following</p>
<form id="formish" action="" method="post" enctype="multipart/form-data" accept-charset="utf-8">
  <input type="hidden" name="_charset_" />
  <input type="hidden" name="__formish_form__" value="formish" />
  <fieldset id="formish-name-field" class="field myname sequencedefault sequencecontrols">
    <legend>Name</legend>
    <div id="formish-name-firstName-field" class="field string input">
      <label for="formish-name-firstName">First Name</label>
      <div class="inputs">
        <input id="formish-name-firstName" type="text" name="name.firstName" value="" />
      </div>
    </div>
    <div id="formish-name-surname-field" class="field string input">
      <label for="formish-name-surname">Surname</label>
      <div class="inputs">
        <input id="formish-name-surname" type="text" name="name.surname" value="" />
      </div>
    </div>
  </fieldset>
  <fieldset id="formish-address-field" class="field myaddress sequencedefault sequencecontrols">
    <legend>Address</legend>
    <div id="formish-address-streetNumber-field" class="field integer input">
      <label for="formish-address-streetNumber">Street Number</label>
      <div class="inputs">
        <input id="formish-address-streetNumber" type="text" name="address.streetNumber" value="" />
      </div>
    </div>
    <div id="formish-address-country-field" class="field string input">
      <label for="formish-address-country">Country</label>
      <div class="inputs">
        <input id="formish-address-country" type="text" name="address.country" value="" />
      </div>
    </div>
  </fieldset>
  <div id="formish-termsAndConditions-field" class="field boolean input">
    <label for="formish-termsAndConditions">Terms And Conditions</label>
    <div class="inputs">
      <input id="formish-termsAndConditions" type="text" name="termsAndConditions" value="" />
    </div>
  </div>
  <div class="actions">
    <input type="submit" id="formish-action-submit" name="submit" value="Submit" />
  </div>
</form><div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;formish&quot;</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="na">accept-charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;_charset_&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;__formish_form__&quot;</span> <span class="na">value=</span><span class="s">&quot;formish&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;fieldset</span> <span class="na">id=</span><span class="s">&quot;formish-name-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field myname sequencedefault sequencecontrols&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;legend&gt;</span>Name<span class="nt">&lt;/legend&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-name-firstName-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-name-firstName&quot;</span><span class="nt">&gt;</span>First Name<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-name-firstName&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;name.firstName&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-name-surname-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-name-surname&quot;</span><span class="nt">&gt;</span>Surname<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-name-surname&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;name.surname&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/fieldset&gt;</span>
  <span class="nt">&lt;fieldset</span> <span class="na">id=</span><span class="s">&quot;formish-address-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field myaddress sequencedefault sequencecontrols&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;legend&gt;</span>Address<span class="nt">&lt;/legend&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-address-streetNumber-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field integer input&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-address-streetNumber&quot;</span><span class="nt">&gt;</span>Street Number<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-address-streetNumber&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;address.streetNumber&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-address-country-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field string input&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-address-country&quot;</span><span class="nt">&gt;</span>Country<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-address-country&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;address.country&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/fieldset&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;formish-termsAndConditions-field&quot;</span> <span class="na">class=</span><span class="s">&quot;field boolean input&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;formish-termsAndConditions&quot;</span><span class="nt">&gt;</span>Terms And Conditions<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;inputs&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;formish-termsAndConditions&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;termsAndConditions&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;actions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">id=</span><span class="s">&quot;formish-action-submit&quot;</span> <span class="na">name=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<p>This data will come back in dictionary form.. i.e.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;firstName&#39;</span><span class="p">:</span><span class="s">&#39;Tim&#39;</span><span class="p">,</span> <span class="s">&#39;surname&#39;</span><span class="p">:</span><span class="s">&#39;Tim&#39;</span><span class="p">},</span> <span class="s">&#39;address&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;streetNumber&#39;</span><span class="p">:</span> <span class="mf">123</span><span class="p">,</span> <span class="s">&#39;country&#39;</span><span class="p">:</span> <span class="s">&#39;UK&#39;</span><span class="p">},</span> <span class="s">&#39;termsAndConditions&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="other-combinations">
<h3>Other Combinations<a class="headerlink" href="#other-combinations" title="Permalink to this headline">¶</a></h3>
<p>Formish will also let you build up a sequence of structures and will use it&#8217;s jquery javascript to allow you to dynamically add and remove sections. This also works when recursively nested so it is perfectly possibly to have a list of addresses, each of which has a list of phone numbers.</p>
</div>
<div class="section" id="tuples">
<h3>Tuples<a class="headerlink" href="#tuples" title="Permalink to this headline">¶</a></h3>
<p>A tuple can be used to create a list that has different types in it. For instance, if we used the Sequence of Sequence example above, we have no control over how many items are in each row. Using a Sequence of Tuples allows us to define the length of the row and also the types of the items in the row.</p>
<p>Lets see how that works.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="s">&#39;myfield&#39;</span><span class="p">,</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Integer</span><span class="p">(),</span> <span class="n">schemaish</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">formish</span><span class="o">.</span><span class="n">Form</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">=</span><span class="n">formish</span><span class="o">.</span><span class="n">TextArea</span><span class="p">()</span>
</pre></div>
</div>
<p>You will now get a textarea that will return validation messages if it is unable to convert to integers or strings and that will output appropriately typed data.</p>
</div>
</div>
<div class="section" id="class-documentation">
<h2>Class Documentation<a class="headerlink" href="#class-documentation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="form-class">
<h3>Form Class<a class="headerlink" href="#form-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="formish.forms.Form">
<!--[formish.forms.Form]-->class <tt class="descclassname">formish.forms.</tt><tt class="descname">Form</tt><big>(</big><em>structure</em>, <em>name=None</em>, <em>defaults=None</em>, <em>errors=None</em>, <em>action_url=None</em>, <em>renderer=None</em><big>)</big><a class="headerlink" href="#formish.forms.Form" title="Permalink to this definition">¶</a></dt>
<dd><p>The definition of a form</p>
<p>The Form type is the container for all the information a form needs to
render and validate data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Variable name:</th><td class="field-body">The name of the form, used to namespace classes and ids</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">Variable defaults:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Property to allow getting and setting of defaults</td>
</tr>
<tr class="field"><th class="field-name">Variable error:</th><td class="field-body">Used to indicate a non field specific error on the form. None
if no error</td>
</tr>
</tbody>
</table>
<p>Create a new form instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>structure</em> (schemaish.Structure) &#8211; Schema Structure attribute to bind to the the form</li>
<li><em>name</em> (str &#8220;valid html id&#8221;) &#8211; Optional form name used to identify multiple forms on the same page</li>
<li><em>defaults</em> (dict) &#8211; Default values for the form</li>
<li><em>errors</em> (dict) &#8211; Errors to store on the form for redisplay</li>
<li><em>action_url</em> (string &#8220;url or path&#8221;) &#8211; Use if you don&#8217;t want the form to post to itself</li>
<li><em>renderer</em> (callable) &#8211; Something that returns a form serialization when called</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="formish.forms.Form.action">
<!--[formish.forms.Form.action]--><tt class="descname">action</tt><big>(</big><em>request</em>, <em>*args</em><big>)</big><a class="headerlink" href="#formish.forms.Form.action" title="Permalink to this definition">¶</a></dt>
<dd><p>Find and call the action callback for the action found in the request</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>request</em> (webob.Request) &#8211; request which is used to find the action and also passed through to
the callback</li>
<li><em>args</em> &#8211; list of arguments Pass through to the callback</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="formish.forms.Form.add_action">
<!--[formish.forms.Form.add_action]--><tt class="descname">add_action</tt><big>(</big><em>callback</em>, <em>name='submit'</em>, <em>label=None</em><big>)</big><a class="headerlink" href="#formish.forms.Form.add_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an action callable to the form</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>callback</em> (callable) &#8211; A function to call if this action is triggered</li>
<li><em>name</em> (string) &#8211; The identifier for this action</li>
<li><em>label</em> (string) &#8211; Use this label instead of the form.name for the value of
the action (for buttons, the value is used as the text on the button)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Form.fields">
<!--[formish.forms.Form.fields]--><tt class="descname">fields</tt><a class="headerlink" href="#formish.forms.Form.fields" title="Permalink to this definition">¶</a></dt>
<dd>Return a generator that yields all of the fields at the top level of
the form (e.g. if a field is a subsection or sequence, it will be up to
the application to iterate that field&#8217;s fields.</dd></dl>

<dl class="method">
<dt id="formish.forms.Form.validate">
<!--[formish.forms.Form.validate]--><tt class="descname">validate</tt><big>(</big><em>request</em>, <em>failure_callable=None</em>, <em>success_callable=None</em><big>)</big><a class="headerlink" href="#formish.forms.Form.validate" title="Permalink to this definition">¶</a></dt>
<dd>Get the data without raising exceptions and then validate the data. If
there are errors, raise them; otherwise return the data</dd></dl>

<dl class="method">
<dt id="formish.forms.Form.__call__">
<!--[formish.forms.Form.__call__]--><tt class="descname">__call__</tt><big>(</big><big>)</big><a class="headerlink" href="#formish.forms.Form.__call__" title="Permalink to this definition">¶</a></dt>
<dd>Calling the Form generates a serialisation using the form&#8217;s renderer</dd></dl>

</dd></dl>

</div>
<div class="section" id="field-class">
<h3>Field Class<a class="headerlink" href="#field-class" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="formish.forms.Field">
<!--[formish.forms.Field]-->class <tt class="descclassname">formish.forms.</tt><tt class="descname">Field</tt><big>(</big><em>name</em>, <em>attr</em>, <em>form</em><big>)</big><a class="headerlink" href="#formish.forms.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a schema field type that includes form information.</p>
<p>The Schema Type Atribute does not have any bindings to the form library, it can be
used on it&#8217;s own. We bind the Schema Attribute to a Field in order to include form
related information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">Method __call__:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a serialisation for this field using the form&#8217;s renderer - read only</p>
</td>
</tr>
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>name</em> &#8211; Name for the field</li>
<li><em>attr</em> (schemaish.attr.*) &#8211; Schema attr to bind to the field</li>
<li><em>form</em> (formish.Form instance.) &#8211; The form the field belongs to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="formish.forms.Field.title">
<!--[formish.forms.Field.title]--><tt class="descname">title</tt><a class="headerlink" href="#formish.forms.Field.title" title="Permalink to this definition">¶</a></dt>
<dd>The Field schema&#8217;s title</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.description">
<!--[formish.forms.Field.description]--><tt class="descname">description</tt><a class="headerlink" href="#formish.forms.Field.description" title="Permalink to this definition">¶</a></dt>
<dd>The Field schema&#8217;s description</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.cssname">
<!--[formish.forms.Field.cssname]--><tt class="descname">cssname</tt><a class="headerlink" href="#formish.forms.Field.cssname" title="Permalink to this definition">¶</a></dt>
<dd>cssname identifier for the field</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.classes">
<!--[formish.forms.Field.classes]--><tt class="descname">classes</tt><a class="headerlink" href="#formish.forms.Field.classes" title="Permalink to this definition">¶</a></dt>
<dd>Works out a list of classes that should be applied to the field</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.value">
<!--[formish.forms.Field.value]--><tt class="descname">value</tt><a class="headerlink" href="#formish.forms.Field.value" title="Permalink to this definition">¶</a></dt>
<dd>Convert the request_data to a value object for the form or None.</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.required">
<!--[formish.forms.Field.required]--><tt class="descname">required</tt><a class="headerlink" href="#formish.forms.Field.required" title="Permalink to this definition">¶</a></dt>
<dd>Does this field have a Not Empty validator of some sort</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.error">
<!--[formish.forms.Field.error]--><tt class="descname">error</tt><a class="headerlink" href="#formish.forms.Field.error" title="Permalink to this definition">¶</a></dt>
<dd>Lazily get the error from the form.errors when needed</dd></dl>

<dl class="attribute">
<dt id="formish.forms.Field.widget">
<!--[formish.forms.Field.widget]--><tt class="descname">widget</tt><a class="headerlink" href="#formish.forms.Field.widget" title="Permalink to this definition">¶</a></dt>
<dd>return the fields widget bound with extra params.</dd></dl>

<dl class="method">
<dt id="formish.forms.Field.__call__">
<!--[formish.forms.Field.__call__]--><tt class="descname">__call__</tt><big>(</big><big>)</big><a class="headerlink" href="#formish.forms.Field.__call__" title="Permalink to this definition">¶</a></dt>
<dd>returns a serialisation for this field using the form&#8217;s renderer</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">About Formish</a><ul>
<li><a class="reference external" href="#introduction-a-simple-form">Introduction - A Simple Form</a><ul>
<li><a class="reference external" href="#creating-a-schema">Creating a schema</a></li>
<li><a class="reference external" href="#creating-a-form">Creating a form</a><ul>
<li><a class="reference external" href="#attributes-of-a-form">Attributes of a form</a></li>
<li><a class="reference external" href="#attributes-of-a-field">Attributes of a field</a></li>
</ul>
</li>
<li><a class="reference external" href="#how-to-create-html">How to create HTML</a></li>
<li><a class="reference external" href="#what-s-in-the-html">What&#8217;s in the HTML</a><ul>
<li><a class="reference external" href="#the-form-html-element">The form html element</a></li>
<li><a class="reference external" href="#the-form-configuration-attributes">The form configuration attributes</a></li>
<li><a class="reference external" href="#the-input-field-s">The input field(s)</a></li>
<li><a class="reference external" href="#the-action-s">The action(s)</a></li>
</ul>
</li>
<li><a class="reference external" href="#processing-the-submitted-form">Processing the Submitted Form</a></li>
</ul>
</li>
<li><a class="reference external" href="#introduction-a-slightly-more-complex-form">Introduction - A Slightly More Complex Form</a><ul>
<li><a class="reference external" href="#creating-the-form">Creating the form</a></li>
<li><a class="reference external" href="#how-does-this-form-work">How does this form work?</a><ul>
<li><a class="reference external" href="#string-fields">String fields</a></li>
<li><a class="reference external" href="#date-field">Date Field</a></li>
<li><a class="reference external" href="#integer-field">Integer Field</a></li>
<li><a class="reference external" href="#select-field">Select Field</a></li>
<li><a class="reference external" href="#boolean-field">Boolean Field</a></li>
</ul>
</li>
<li><a class="reference external" href="#id1">Processing the submitted form</a></li>
<li><a class="reference external" href="#showing-the-errors">Showing the errors</a></li>
</ul>
</li>
<li><a class="reference external" href="#validation">Validation</a><ul>
<li><a class="reference external" href="#how-validators-work">How Validators Work</a></li>
</ul>
</li>
<li><a class="reference external" href="#file-uploads">File Uploads</a><ul>
<li><a class="reference external" href="#short-version">Short Version</a><ul>
<li><a class="reference external" href="#what-does-this-produce">What does this produce?</a></li>
<li><a class="reference external" href="#how-does-this-return-a-file-to-me">How does this return a file to me?</a></li>
</ul>
</li>
<li><a class="reference external" href="#longer-version">Longer Version</a><ul>
<li><a class="reference external" href="#upload-file-temporary-storage">Upload File Temporary Storage</a></li>
<li><a class="reference external" href="#so-what-happens-when-a-file-is-uploaded">So what happens when a file is uploaded?</a></li>
<li><a class="reference external" href="#what-else-can-i-configure">What else can I configure?</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#sequences">Sequences</a><ul>
<li><a class="reference external" href="#checkbox-multi-choice">Checkbox Multi Choice</a></li>
<li><a class="reference external" href="#select-multi-choice">Select Multi Choice</a></li>
<li><a class="reference external" href="#text-area-sequence">Text Area Sequence</a></li>
<li><a class="reference external" href="#text-area-sequence-of-sequences">Text Area Sequence of Sequences</a></li>
<li><a class="reference external" href="#multiple-input-fields">Multiple Input Fields</a></li>
</ul>
</li>
<li><a class="reference external" href="#nested-form-structures">Nested Form Structures</a><ul>
<li><a class="reference external" href="#a-structure-of-structures">A Structure of Structures</a></li>
<li><a class="reference external" href="#other-combinations">Other Combinations</a></li>
<li><a class="reference external" href="#tuples">Tuples</a></li>
</ul>
</li>
<li><a class="reference external" href="#class-documentation">Class Documentation</a><ul>
<li><a class="reference external" href="#form-class">Form Class</a></li>
<li><a class="reference external" href="#field-class">Field Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html" title="previous chapter">Welcome to Formish&#8217;s documentation!</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="restish.html" title="next chapter">Using Formish within Restish</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/introduction.txt">Show Source</a></li>
            </ul>
          <h3>Quick search</h3>
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="restish.html" title="Using Formish within Restish"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Formish&#8217;s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Formish v1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, Tim Parkin, Matt Goodall.
    </div>
  </div> 
  </div>
  </body>
</html>