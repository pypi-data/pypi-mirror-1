<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link href="/CSS/server/style.css" rel="stylesheet" type="text/css" />
<!--title--><title>
Incoming Form Data Handler
</title>
</head>


<body>
<div id="container">

<hr />

<div id="content">

<!--content-->

<p>
<h4>A General Handling of Form Data
</h4><p>
This incoming handler does not replace CGI scripts but it obviates the
need for many of them.  If the page-generator needs the form itself,
you need a CGI script.  Otherwise, incoming should be sufficient.
<p>
If "incoming" is a key in the cgi.form, ming.cgi expects these keys in 
the form data:
<ul>
<li>file - must be a entry in FILES
<li>page - valid ming.cgi page target
</ul>
<p>
It will use these USER CONSTS in Constants.py:
<ul>
<li>FILES_DIR = "../data/files" # Must be read/write dir for the webserver
<li>FILE_MAXLINES = 1000   # Upper limit on file length
<li>INCOMING_MAX = 64*1024 # 64 kb
<li>FILES = "3.files" # Lists filenames accessible in FILES_DIR, lives in cgi-bin
</ul>
<p>
FILES contains name only, one on each line, no paths.
If form's file is in FILES, ming.cgi reads up FILES_DIR+os.sep+file
It then opens it for writing and writes a datestamp of the form 
<blockquote>
stamp|xxxxxxxxx.xxx
</blockquote>
where the Xs are time in seconds converted to string, followed by
<blockquote>
key|form[key].value()\n
</blockquote>
for all keys but file, page, incoming, submit, and debug.
(It only writes after testing sizes against INCOMING_MAX.)
Then it writes "---\n" and closes the file.
<p>
Finally, it opens form["page"].value() in the client browser.
<p>
So, you can have a page with a form.  It's incoming value triggers
both the writing of the data and the triggering of the page which
uses the data.  
<p>
It is useful to have an empty dir with single-page subdirs for
these page targets.  I have, for example, /singles/thanks dir with
a key file and a thankyou file.  It thanks you for filling out a
form and links back to a useful page.
<p>
Files are truncated at FILE_MAXLINES.  So your code must handle abrupt
truncation.  I use try-except clauses.


<!--content end-->

</div>			   



<div id="footer">

<center>

<table width=75% border=0 height=128>

<tr align=center>

<td colspan=3>

<tr align=center valign="top">

<td align="left" width="33%">

<a href="http://www.fsf.org">

<img src="/img/ming/fsf.jpg" border="0" alt="Free Software Foundation"> </a>

<br><small>GPL'D Software</small>



<td align="center" width="33%">

<a href="http://">

<img src="/img/ming/logo.jpg"  alt="billy-bob ming" border="0"></a>

<br><small>Our Founders</small>



<td align="right" width="33%">

<a href="http://creativecommons.org/licenses/by-nc-nd/2.5/">

<img alt="Creative Commons License" src="/img/ming/somerights.jpg" align="middle" border="0"></a>

<br><small>Copyrighted Works</small>



</table>

</div>

       

</div>            

</body>

</html>
