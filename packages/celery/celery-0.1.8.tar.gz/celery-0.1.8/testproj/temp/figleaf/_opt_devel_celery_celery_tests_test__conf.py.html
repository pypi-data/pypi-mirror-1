source file: <b>/opt/devel/celery/testproj/../celery/tests/test_conf.py</b><br>


file stats: <b>29 lines, 28 executed: 96.6% covered</b>
<pre>
<font color="green">   1. import unittest</font>
<font color="green">   2. from celery import conf</font>
<font color="green">   3. from django.conf import settings</font>
<font color="black">   4. </font>
<font color="red">   5. SETTING_VARS = (</font>
<font color="black">   6.     (&quot;CELERY_AMQP_CONSUMER_QUEUE&quot;, &quot;AMQP_CONSUMER_QUEUE&quot;,</font>
<font color="green">   7.         &quot;DEFAULT_AMQP_CONSUMER_QUEUE&quot;),</font>
<font color="black">   8.     (&quot;CELERY_AMQP_ROUTING_KEY&quot;, &quot;AMQP_ROUTING_KEY&quot;,</font>
<font color="green">   9.         &quot;DEFAULT_AMQP_ROUTING_KEY&quot;),</font>
<font color="black">  10.     (&quot;CELERY_AMQP_EXCHANGE&quot;, &quot;AMQP_EXCHANGE&quot;,</font>
<font color="green">  11.         &quot;DEFAULT_AMQP_EXCHANGE&quot;),</font>
<font color="black">  12.     (&quot;CELERYD_CONCURRENCY&quot;, &quot;DAEMON_CONCURRENCY&quot;,</font>
<font color="green">  13.         &quot;DEFAULT_DAEMON_CONCURRENCY&quot;),</font>
<font color="black">  14.     (&quot;CELERYD_PID_FILE&quot;, &quot;DAEMON_PID_FILE&quot;,</font>
<font color="green">  15.         &quot;DEFAULT_DAEMON_PID_FILE&quot;),</font>
<font color="black">  16.     (&quot;CELERYD_EMPTY_MSG_EMIT_EVERY&quot;, &quot;EMPTY_MSG_EMIT_EVERY&quot;,</font>
<font color="green">  17.         &quot;DEFAULT_EMPTY_MSG_EMIT_EVERY&quot;),</font>
<font color="black">  18.     (&quot;CELERYD_QUEUE_WAKEUP_AFTER&quot;, &quot;QUEUE_WAKEUP_AFTER&quot;,</font>
<font color="green">  19.         &quot;DEFAULT_QUEUE_WAKEUP_AFTER&quot;),</font>
<font color="black">  20.     (&quot;CELERYD_LOG_FILE&quot;, &quot;DAEMON_LOG_FILE&quot;,</font>
<font color="green">  21.         &quot;DEFAULT_DAEMON_LOG_FILE&quot;),</font>
<font color="black">  22.     (&quot;CELERYD_DAEMON_LOG_FORMAT&quot;, &quot;LOG_FORMAT&quot;,</font>
<font color="green">  23.         &quot;DEFAULT_LOG_FMT&quot;),</font>
<font color="black">  24.     (&quot;CELERY_TASK_META_USE_DB&quot;, &quot;TASK_META_USE_DB&quot;,</font>
<font color="green">  25.         &quot;DEFAULT_TASK_META_USE_DB&quot;),</font>
<font color="black">  26. )</font>
<font color="black">  27. </font>
<font color="black">  28. </font>
<font color="green">  29. class TestConf(unittest.TestCase):</font>
<font color="black">  30. </font>
<font color="green">  31.     def assertDefaultSetting(self, setting_name, result_var, default_var):</font>
<font color="green">  32.         if hasattr(settings, setting_name):</font>
<font color="green">  33.             self.assertEquals(getattr(conf, result_var),</font>
<font color="green">  34.                               getattr(settings, setting_name),</font>
<font color="green">  35.                               &quot;Overwritten setting %s is written to %s&quot; % (</font>
<font color="green">  36.                                   setting_name, result_var))</font>
<font color="black">  37.         else:</font>
<font color="green">  38.             self.assertEqual(getattr(conf, default_var),</font>
<font color="green">  39.                              getattr(conf, result_var),</font>
<font color="green">  40.                              &quot;Default setting %s is written to %s&quot; % (</font>
<font color="green">  41.                                  default_var, result_var))</font>
<font color="black">  42. </font>
<font color="green">  43.     def test_configuration_cls(self):</font>
<font color="green">  44.         for setting_name, result_var, default_var in SETTING_VARS:</font>
<font color="green">  45.             self.assertDefaultSetting(setting_name, result_var, default_var)</font>
<font color="green">  46.         self.assertTrue(isinstance(conf.DAEMON_LOG_LEVEL, int))</font>
</pre>

