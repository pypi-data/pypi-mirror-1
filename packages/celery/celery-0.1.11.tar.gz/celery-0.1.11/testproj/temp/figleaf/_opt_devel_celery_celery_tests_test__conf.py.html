source file: <b>/opt/devel/celery/testproj/../celery/tests/test_conf.py</b><br>


file stats: <b>43 lines, 42 executed: 97.7% covered</b>
<pre>
<font color="green">   1. import unittest</font>
<font color="green">   2. from celery import conf</font>
<font color="green">   3. from django.conf import settings</font>
<font color="black">   4. </font>
<font color="black">   5. </font>
<font color="red">   6. SETTING_VARS = (</font>
<font color="green">   7.     (&quot;CELERY_AMQP_CONSUMER_QUEUE&quot;, &quot;AMQP_CONSUMER_QUEUE&quot;,</font>
<font color="green">   8.         &quot;DEFAULT_AMQP_CONSUMER_QUEUE&quot;),</font>
<font color="green">   9.     (&quot;CELERY_AMQP_ROUTING_KEY&quot;, &quot;AMQP_ROUTING_KEY&quot;,</font>
<font color="green">  10.         &quot;DEFAULT_AMQP_ROUTING_KEY&quot;),</font>
<font color="green">  11.     (&quot;CELERY_AMQP_EXCHANGE&quot;, &quot;AMQP_EXCHANGE&quot;,</font>
<font color="green">  12.         &quot;DEFAULT_AMQP_EXCHANGE&quot;),</font>
<font color="green">  13.     (&quot;CELERYD_CONCURRENCY&quot;, &quot;DAEMON_CONCURRENCY&quot;,</font>
<font color="green">  14.         &quot;DEFAULT_DAEMON_CONCURRENCY&quot;),</font>
<font color="green">  15.     (&quot;CELERYD_PID_FILE&quot;, &quot;DAEMON_PID_FILE&quot;,</font>
<font color="green">  16.         &quot;DEFAULT_DAEMON_PID_FILE&quot;),</font>
<font color="green">  17.     (&quot;CELERYD_EMPTY_MSG_EMIT_EVERY&quot;, &quot;EMPTY_MSG_EMIT_EVERY&quot;,</font>
<font color="green">  18.         &quot;DEFAULT_EMPTY_MSG_EMIT_EVERY&quot;),</font>
<font color="green">  19.     (&quot;CELERYD_QUEUE_WAKEUP_AFTER&quot;, &quot;QUEUE_WAKEUP_AFTER&quot;,</font>
<font color="green">  20.         &quot;DEFAULT_QUEUE_WAKEUP_AFTER&quot;),</font>
<font color="green">  21.     (&quot;CELERYD_LOG_FILE&quot;, &quot;DAEMON_LOG_FILE&quot;,</font>
<font color="green">  22.         &quot;DEFAULT_DAEMON_LOG_FILE&quot;),</font>
<font color="green">  23.     (&quot;CELERYD_DAEMON_LOG_FORMAT&quot;, &quot;LOG_FORMAT&quot;,</font>
<font color="green">  24.         &quot;DEFAULT_LOG_FMT&quot;),</font>
<font color="green">  25.     (&quot;CELERY_TASK_META_USE_DB&quot;, &quot;TASK_META_USE_DB&quot;,</font>
<font color="green">  26.         &quot;DEFAULT_TASK_META_USE_DB&quot;),</font>
<font color="black">  27. )</font>
<font color="black">  28. </font>
<font color="green">  29. </font>
<font color="green">  30. class TestConf(unittest.TestCase):</font>
<font color="green">  31. </font>
<font color="green">  32.     def assertDefaultSetting(self, setting_name, result_var, default_var):</font>
<font color="green">  33.         if hasattr(settings, setting_name):</font>
<font color="green">  34.             self.assertEquals(getattr(conf, result_var),</font>
<font color="green">  35.                               getattr(settings, setting_name),</font>
<font color="green">  36.                               &quot;Overwritten setting %s is written to %s&quot; % (</font>
<font color="green">  37.                                   setting_name, result_var))</font>
<font color="green">  38.         else:</font>
<font color="green">  39.             self.assertEqual(getattr(conf, default_var),</font>
<font color="green">  40.                              getattr(conf, result_var),</font>
<font color="green">  41.                              &quot;Default setting %s is written to %s&quot; % (</font>
<font color="green">  42.                                  default_var, result_var))</font>
<font color="green">  43. </font>
<font color="green">  44.     def test_configuration_cls(self):</font>
<font color="green">  45.         for setting_name, result_var, default_var in SETTING_VARS:</font>
<font color="green">  46.             self.assertDefaultSetting(setting_name, result_var, default_var)</font>
<font color="green">  47.         self.assertTrue(isinstance(conf.DAEMON_LOG_LEVEL, int))</font>
</pre>

