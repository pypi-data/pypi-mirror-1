from datetime import datetime, timedelta
import time
import hashlib

from routes import url_for
from pylons import config
from {{package}}.model import *
from {{package}}.tests import *

class TestLoginController(TestController):

    def setUp(self):
        TestModel.setUp(self)
    
    
    def tearDown(self):
        TestModel.tearDown(self)
        # Session.close()
    
    
    def test_admin_signin(self):
        """Ensure that signin is successful"""
        response = self.app.post(
                        url_for(
                            controller='login', action='signin'),
                            params={'login':u'admin',
                                    'password':"admin"})
        
        print(response)
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/demo/privindex'
    

    def test_admin_signout(self):
        """Ensure that signout is successful."""
        response = self.app.get(url_for(controller='login', action='signout'))
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/login/index'
    

    def test_unauthorised_model_access_is_prohibited(self):
        """Unauthorised GET access is prohibited."""
        response = self.app.get(
                        url=url_for(
                            controller='demo', action='privindex'))
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/login/index'
    
