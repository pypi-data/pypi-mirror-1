<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="qi.Goban">
      
<head>
   <metal:top fill-slot="top_slot">
	<tal:border define="dummy python:request.set('disable_border', True)" />
   </metal:top>
</head>
<body>
	
	<div metal:fill-slot="main"
         tal:define="numGames view/num_games;
                     pss modules/Products/PythonScripts/standard;">

        <div tal:replace="structure provider:plone.abovecontenttitle" />

        <h1 class="documentFirstHeading" i18n:translate="title_recent_games">
          Recent games in
          <span i18n:name="title" tal:replace="here/Title">title</span>
        </h1>

        <div tal:replace="structure provider:plone.belowcontenttitle" />

        <a href=""
           class="link-parent"
           tal:attributes="href context/absolute_url"
           i18n:translate="label_go_to_view_url">
           Return to <span i18n:name="name" tal:content="context/Title" />
        </a>

        <div tal:replace="structure provider:plone.abovecontentbody" />

        <p class="discreet"
             i18n:translate="label_no_recent_games"
             tal:condition="not: numGames">
        No games found.
        </p>


        <tal:haveGames condition="numGames">
          
          <p i18n:translate="label_recentGamesDescription">
            The following games have been recently modified.
          </p>
          
          <p class="discreet" tal:condition="not:isAnon"
             i18n:translate="label_newGamesMarkedWith">
            Games marked with
            <img i18n:name="star" src="++resource++qi.Goban.images/new_game.gif" />
            have been modified since your last log-in.
          </p>

          <tal:games define="Batch python:modules['Products.CMFPlone.PloneBatch'].Batch;
                             b_start python:request.get('b_start',0);
                             batch python:Batch(view.results(), 20, int(b_start), orphan=1);">
            <table class="listing">
                <thead>
                    <tr>
                         <th i18n:translate="label_title">Title</th>
		                <th i18n:translate="label_blackPlayer">
		                Black</th>
		                <th i18n:translate="label_whitePlayer">
		                White</th>
		                <th i18n:translate="label_datePlayed">
		                Played on</th>
		                <th i18n:translate="label_place">Place</th>
		                <th i18n:translate="label_handicap">
		                Handicap</th>

                     </tr>
                </thead>
        
                <tbody>
                    <tal:showGames tal:repeat="game batch">
                
                    <tr tal:define="oddrow repeat/game/odd;
                                    revstate game/review_state_normalized;"
                        tal:attributes="class python:(oddrow and 'odd' or 'even')">
                        <td>
                            <img src="++resource++qi.Goban.images/new_game.gif" 
                                 tal:condition="game/is_new" />
                            <a href=""
                               tal:attributes="href game/absolute_url;
                                               class string:state-${revstate}">
                              <img src="" tal:condition="python:revstate == 'locked'"
                                          tal:replace="structure here/lock_icon.gif" />
                                <span tal:replace="game/Title">This is a title</span>
                            </a>

                            <div class="discreet" i18n:translate="label_byAuthor">
                                   by <tal:author i18n:name="author"
                                           content="game/creator" />
                            </div>
                        </td>
					  <td>
						<span  tal:content="game/blackPlayer | nothing"/>
	                    <div class="discreet" tal:content="game/blackRating | nothing"/>
	                  </td>
	                  <td>
		 				<span tal:content="game/whitePlayer | nothing"/>
		     			<div class="discreet" tal:content="game/whiteRating | nothing"/>
	                  </td>
	                <td tal:content="game/datePlayed | nothing"></td>
	                  <td tal:content="game/place | nothing"></td>
	                  <td tal:content="game/handicap | nothing"></td>
                    </tr>
                
                    </tal:showGames>
                </tbody>
            </table>
            
            <!-- Navigation -->
            <div metal:use-macro="here/batch_macros/macros/navigation" />
            
          </tal:games>
        </tal:haveGames>

        <div tal:replace="structure provider:plone.belowcontentbody" />


    </div>
</body>
</html>
