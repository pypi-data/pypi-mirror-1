<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="ploneboard">

<tal:block metal:fill-slot="top_slot">
   <tal:block tal:define="dummy python:request.set('disable_border',1)" />
</tal:block>

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="errors python:request.get('errors', {})">


<div class="configlet">
  
   <h1>Ploneboard configuration: Manage transforms</h1>

   <a class="link-parent" href="prefs_ploneboard_form" i18n:translate="up_to_ploneboard_prefs">
     Return to Ploneboard settings
   </a>

    <div class="documentDescription" i18n:translate="description_ploneboard_config_transforms"> 
    Here you can configure which transforms are active in Ploneboard comments.
    </div>

    <fieldset>
        <legend i18n:translate="legend_transforms">Existing transforms</legend>
        <table class="listing" tal:define="transforms here/portal_ploneboard/getTransforms">
          <th i18n:translate="transform_name">Transform name</th>
          <th i18n:translate="enabled">Enabled?</th>
          <th i18n:translate="data_provider">Data provider</th>
          <th i18n:translate="action">Action</th>
            <tr tal:repeat="transform transforms">
                <tal:block tal:define="transform_name python: transform[0]; transform_status python: transform[2]; ">
                    <form class="group"
                        name="edit_form"
                        action=""
                        method="post"
                        enctype="multipart/form-data"
                        tal:attributes="action template/getId" >
                        <input type="hidden" name="form.submitted" value="1" />
                        <input type="hidden" name="transform_name" value="" tal:attributes="value transform_name" />
                        <td tal:content="transform_name"></td>
                        <td class="listingCheckbox"><input type="checkbox" name="transform_status" tal:attributes="checked python:test(int(transform_status), 'checked', nothing)"/></td>
                        <td>
                            <span tal:condition="python: here.portal_ploneboard.hasDataProvider(transform_name)" tal:omit-tag="">
                              <a href="#"
                                i18n:translate="manage"
                                tal:attributes="href string: prefs_manage_dataprovider?transform_name=${transform_name}">Manage</a>
                            </span>
                        </td>
                        <td style="font-size: 120%; padding-top: 1em;">
                            <input class="standalone" type="submit" name="form.button.Update" value="Update" 
                            />&nbsp;<input class="destructive" type="submit" name="form.button.Remove" value="Remove" i18n:attributes="value remove" />
                        </td>
                    </form>
                </tal:block>
            </tr>
        </table>
    </fieldset>

    <form name="edit_form"
          action=""
          method="post"
          enctype="multipart/form-data"
          tal:attributes="action template/getId" >

        <fieldset>
            <legend i18n:translate="legend_add_transform">Add transform</legend>
            <input type="hidden" name="form.submitted" value="1" />
            
            <div class="field">
                <label i18n:translate="transform_name">Transform name</label>
                <input type="text" name="transform_name"/>
            </div>
            
            <div class="field">
                <label i18n:translate="module_name">Module</label>
                <input type="text" name="module_name"/>
            </div>
                        
            <div class="formControls">
                <input class="context" type="submit" name="form.button.Add" value="Add" i18n:attributes="value add"/>
            </div>
        </fieldset>
    </form>
</div>


</div>
</body>
</html>
