<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/main_template/macros/master"
  i18n:domain="on.sales">
  <body>

    <!--
    This is the top level SalesArea view, intended for viewing nested
    SalesAreas in the following fashion:

    * We use the title, description and outermost area delivers the title
    -->
    <metal:css fill-slot="css_slot">
      <style type="text/css" media="all"
	tal:content="string: @import url(${context/++resource++on-sales.css});"></style>
    </metal:css>
    
    <metal:main fill-slot="main">
      <tal:main-macro metal:define-macro="main">

        <div tal:replace="structure provider:plone.abovecontenttitle" />

	  <div class="map">
	    <!-- IMPORTANT: leave the space in -->
	    <span tal:content="structure python: here.getField('map').tag(here, alt=' ')" />
	  </div>
	  <h1 class="areaFirstHeading">
            <span metal:use-macro="python:context.widget('title', mode='view')" />
	  </h1>

	  <div tal:replace="structure provider:plone.belowcontenttitle" />

	    <div class="documentDescription">
	      <span metal:use-macro="python:context.widget('description', mode='view')" />
	    </div>

	    <div tal:replace="structure provider:plone.abovecontentbody" />


	      <div class="info">
		<label 
		  class="label" tal:condition="context/haveSalesAgent"
		  for="parent-fieldname-responsible_salesagent" i18n:translate="label_salesagent">
		  Responsible&nbsp;for&nbsp;your&nbsp;Area:</label><br />
		<br />
		  <div tal:repeat="agent context/getSalesAgents">
		    <span tal:define="oddrow repeat/agent/odd;
                                      evenrow repeat/agent/even">

                    <div tal:condition="oddrow" class="odd">
                      <a href="#" tal:attributes="href string:${agent/id}/view">
                        <div class="agentinfo odd" tal:content="agent/name" />
		      </a>
		    </div>
                    <div tal:condition="evenrow" class="even">
		    <a href="#" tal:attributes="href string:${agent/id}/view">
		      <div  class="agentinfo" tal:content="agent/name" />
		    </a>
                   </div>
                   </span>
		  </div>
		  <div class="clearer"></div>
		    <a tal:attributes="href string:@@Email_Form"
		      href="#">
		       <img tal:attributes="src string:/${context/virtual_url_path}/++resource++on.sales.images/Flugpost-k.gif"  src="#"
			alt="Sales Enquiry" title="Sales Enquiry"
			i18n:translate="alt title" />
		    </a>

		    <hr />

		      <!-- display the list of areas -->

		      <div class="arealist"
			tal:define="subareas context/getSalesAreaTree"
			tal:condition="subareas"
			tal:repeat="area subareas">

			<!-- now list one area at a time -->

			<div tal:condition="python: area['level'] == 0 and area['map']"
			     tal:content="python:None">what objects are these?</div>

			<!-- show the map: -->
		      <div class="mapLevel1"
			     tal:condition="python: area['level'] == 0 and area['map']">
			  <img src="#" alt="#" title="#" with="#" class="#"
			    tal:attributes="src      python: area['id']+'/map_mini';
			                    title    area/title;
			                    alt      area/title;
			                    width    python: 80;
			                    class    python: 'area_mini_image'+str(area['level'])"
			    />
			</div>
			<b><a href="#" tal:attributes="href string: ${area/id}${area/view}">
			<div class="#" id="#"
			  tal:define="level area/level"
			  tal:attributes="class python: 'salesarea-div salesarea-title-' + str(level);
			                  id python: 'salesarea-container-' + str(level)"
			  tal:content="area/title">Title</div>
			</a></b>
			<div tal:condition="area/description | nothing" tal:content="area/description">description</div>
		  <div class="clearer"></div>

			<!-- show the email contact form:
			<a tal:attributes="href string:${area/id}/@@Email_Form"
			  class="imglink">
			  <img tal:attributes="src string:/${context/virtual_url_path}/++resource++on.sales.images/Flugpost-k.gif" src="#" 
			    alt="Sales Enquiry" title="Sales Enquiry"
			    i18n:translate="alt title" />
			</a> -->

			<!-- show the alternate view with more details (default for leaf nodes): -->
			<a tal:attributes="href string:${area/id}/@@details"
			  i18n:translate="salesarea_details"
			  class="imglink">
			  <img src="#" tal:attributes="src string:/${context/virtual_url_path}/++resource++on.sales.images/icon-magnifier-2.gif"
			    alt="Area Details" title="Area Details"
			    i18n:translate="alt title" />
			</a>
                        <div class="clearer"></div>

			<ul tal:condition="area/sons"
			  tal:define="sons area/sons"
			  tal:repeat="son sons">

			  <li>
			      <a href="#"
			         tal:attributes="href string: ${area/id}/${son/id}${son/view}"
			         tal:content="son/title">son's title</a>
			  </li>

			</ul>
			  <!--div tal:content="python: 'Object: ' + str(area)">object dump </div -->
			    
		      </div>
		      
		</div>
		<div metal:use-macro="context/document_relateditems/macros/relatedItems">
		  show related items if they exist
		</div>
		
		<div tal:replace="structure provider:plone.belowcontentbody" />

      </tal:main-macro>
    </metal:main>

  </body>
</html>

