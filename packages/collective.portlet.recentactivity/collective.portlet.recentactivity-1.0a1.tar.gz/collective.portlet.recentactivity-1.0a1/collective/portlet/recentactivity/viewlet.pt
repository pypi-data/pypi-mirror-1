<ol class="recent_activity"
    tal:condition="view/available">

	<h2>Recent Activities</h2>
	
    <tal:items tal:define="plone_view context/@@plone;
                           getIcon nocall:plone_view/getIcon;
                           normalizeString nocall:plone_view/normalizeString;
                           toLocalizedTime nocall:plone_view/toLocalizedTime;"
               tal:repeat="activity view/recent_activities">

        <li class="portletItem"
            tal:define="oddrow repeat/activity/odd;
                        item_icon python:getIcon(activity);"
            tal:attributes="class python:oddrow and  'portletItem even' or 'portletItem odd'">
            User <a href=""
                    tal:content="activity/user"
                    tal:attributes="href activity/user_url" />
            <span tal:content="activity/action" />
            <a href=""
               tal:content="python:activity['object'].title"
               tal:attributes="href activity/object_url" />
            <tal:condition tal:condition="python: activity['action'] == 'added'">
	            to
	            <a href=""
	               tal:content="python:activity['parent'].title"
	               tal:attributes="href activity/parent_url" />
	        </tal:condition>
            <br />&mdash
            <tal:block tal:condition="activity/time/days">
            	<span tal:replace="activity/time/days" /> days and
            </tal:block>
            <tal:block tal:condition="activity/time/hours"> 
            	<span tal:replace="activity/time/hours" /> hours and
            </tal:block>
            <tal:block tal:condition="activity/time/minutes">
            	<span tal:replace="activity/time/minutes" /> minutes ago.
            </tal:block>
			<tal:block tal:condition="python: not activity['time']['days'] and not activity['time']['hours'] and not activity['time']['minutes']">
            	less than one minute ago.
            </tal:block>            
        </li>
    </tal:items>

</ol>