<tal:block i18n:domain="plonehrm">
  <table class="listing absence_overview"
	 tal:define="rows view/rows"
	 tal:condition="rows">
    <thead>
      <tr tal:define="first python:rows[0]"
	  i18n:domain="plonelocales">
	<th i18n:domain="plone" i18n:translate="">Fullname</th>
	<th i18n:translate="month_jan_abbr">jan</th>
	<th i18n:translate="month_feb_abbr">feb</th>
	<th i18n:translate="month_mar_abbr">mar</th>
	<th i18n:translate="month_apr_abbr">apr</th>
	<th i18n:translate="month_may_abbr">may</th>
	<th i18n:translate="month_jun_abbr">jun</th>
	<th i18n:translate="month_jul_abbr">jul</th>
	<th i18n:translate="month_aug_abbr">aug</th>
	<th i18n:translate="month_sep_abbr">sep</th>
	<th i18n:translate="month_oct_abbr">oct</th>
	<th i18n:translate="month_nov_abbr">nov</th>
	<th i18n:translate="month_dec_abbr">dec</th>
	<th i18n:domain="plonehrm" i18n:translate="head_total">Total</th>
	<th i18n:domain="plonehrm" i18n:translate="head_percentage">Percentage</th>
	<th i18n:domain="plonehrm" i18n:translate="head_number">Count</th>
      </tr>
    </thead>
    <tfoot>
      <tr>
	<th colspan="13" i18n:translate="absence_average">
	Average</th>
	<th tal:content="python: int(view.average_total)" />
	<th tal:content="view/average_percentage" />
	<th tal:content="python: int(view.average_count)" />
      </tr>
    </tfoot>
    <tbody>
      <tal:rows tal:repeat="row view/rows">
	<tr tal:define="oddrow repeat/row/odd;"
            tal:attributes="class python:oddrow and 'odd' or 'even'">
	  <td tal:repeat="col row">
            <tal:block tal:condition="python: col != 0"
		       replace="structure col" />
	    <tal:block tal:condition="python: col == 0">-</tal:block>
	  </td>
	</tr>
      </tal:rows>
    </tbody>
    
  </table>

  <h2 i18n:translate="label_export_cvs">Export absences</h2>

  <form name="absence_export_form"
	id="absence_export_form"
	method="post"
	action="export-absences.csv">

    <label for="export_start_date"
	   i18n:translate="label_export_start_date">
      Export start date</label>
    <tal:start
       define="today python:modules['DateTime'].now();
               utils python:modules['Products.CMFPlone.utils'];
               uniqueItemIndex python:utils.RealIndexIterator(pos=0);
               fieldName string:export_start_date;
               id fieldName;
               show_hm python:False;
               show_ymd python:True;
               inputname fieldName;
               formname string:absence_export_form;
               inputvalue python:None;
               tabindex python:1;">
      <metal:box use-macro="here/calendar_macros/macros/calendarDatePickerBox|here/calendar_slot/macros/calendarDatePickerBox">
	a calendar, hopefully
      </metal:box>
    </tal:start>

    <label for="export_end_date"
	   i18n:translate="label_export_end_date">
      Export end date</label>
    <tal:start
       define="today python:modules['DateTime'].now();	     
               utils python:modules['Products.CMFPlone.utils'];
               uniqueItemIndex python:utils.RealIndexIterator(pos=0);
               fieldName string:export_end_date;
               id fieldName;
               show_hm python:False;
               show_ymd python:True;
               inputname fieldName;
               formname string:absence_export_form;
               inputvalue python:None;
               tabindex python:1;">
      <metal:box use-macro="here/calendar_macros/macros/calendarDatePickerBox|here/calendar_slot/macros/calendarDatePickerBox">
	a calendar, hopefully
      </metal:box>
    </tal:start>

    <input value="Export"
	   id="export_absence_submit"
           class="context"
           i18n:attributes="value label_export_absence"
           type="submit" />
  </form>
</tal:block>
