<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Schema Reference &mdash; py-simplecouchdb v0.9.25 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.25',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="py-simplecouchdb v0.9.25 documentation" href="../index.html" />
    <link rel="next" title="Creating, Getting and Deleting Data" href="creating_getting_deleting.html" />
    <link rel="prev" title="Breaking Changes" href="../breakingchanges.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="creating_getting_deleting.html" title="Creating, Getting and Deleting Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../breakingchanges.html" title="Breaking Changes"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">py-simplecouchdb v0.9.25 documentation</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="module-simplecouchdb.schema">
<span id="schema-ref"></span><h1>Schema Reference<a class="headerlink" href="#module-simplecouchdb.schema" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-document-interface">
<h2>The Document interface<a class="headerlink" href="#the-document-interface" title="Permalink to this headline">¶</a></h2>
<p>An application describes the kinds of data it uses with <a class="reference external" href="document.html#document-ref"><em>Document:</em></a>. A document is a Python class that inherits from the <a title="simplecouchdb.schema.Document" class="reference external" href="document.html#simplecouchdb.schema.Document"><tt class="xref docutils literal"><span class="pre">simplecouchdb.schema.Document</span></tt></a> class. The document class defines a new kind of CouchDB document and the properties the kind is expected to take.</p>
<p>Document properties are defined using class attributes on the document class. Each class attribute is an instance of a subclass of the Property class, usually one of the provided property classes. A property instance holds configuration for the property, such as whether or not the property is required for the instance to be valid, or a default value to use for the instance if none is provided.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">simplecouchdb</span> <span class="kn">import</span> <span class="n">schema</span>

<span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">birthdate</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">DateProperty</span><span class="p">()</span>
    <span class="n">weight_in_pounds</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">IntegerProperty</span><span class="p">()</span>
    <span class="n">spayed_or_neutered</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">BooleanProperty</span><span class="p">()</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
</pre></div>
</div>
<p>An CouchDB document is represented in the API by an instance of the corresponding document class. The application can create a new document by calling the constructor of the class. The application accesses and manipulates properties of the entity using attributes of the instance. The document instance constructor accepts initial values for properties as keyword arguments.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pet</span> <span class="o">=</span> <span class="n">Pet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Fluffy&quot;</span><span class="p">,</span>
      <span class="nb">type</span><span class="o">=</span><span class="s">&quot;cat&quot;</span><span class="p">,</span>
      <span class="n">owner</span><span class="o">=</span><span class="s">&quot;Jean&quot;</span><span class="p">)</span>
<span class="n">pet</span><span class="o">.</span><span class="n">weight_in_pounds</span> <span class="o">=</span> <span class="mf">24</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The attributes of the document class are configuration for the model properties, whose values are <a title="simplecouchdb.schema.Property" class="reference external" href="property.html#simplecouchdb.schema.Property"><tt class="xref docutils literal"><span class="pre">simplecouchdb.schema.Property</span></tt></a> instances. The attributes of the document instance are the actual property values, whose values are of the type accepted by the Property class.</p>
</div>
<p>The document class use the Property instances to validate data. The validation could occur when you validate(<tt class="xref docutils literal"><span class="pre">simplecouchdb.Document.validate()</span></tt>) the document class or save (<tt class="xref docutils literal"><span class="pre">simplecouchdb.Document.save()</span></tt>) it.</p>
<p>An instance of a model created using the constructor does not exist in the datastore until it is &#8220;saved&#8221; for the first time. See <a class="reference external" href="creating_getting_deleting.html#creating-getting-deleting-ref"><em>Creating, Getting and Deleting Data</em></a>.</p>
</div>
<div class="section" id="document-is-dynamic">
<h2>Document is dynamic<a class="headerlink" href="#document-is-dynamic" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is usefull to have different properties on each document. CouchDB allow it so why not having it in python. A document can have both dynamic and static property. Any value assigned to an attribute of an instance of a document becomes a property of the CouchDB document, using the name of the attribute. These properties are known as dynamic properties. Properties defined using Property class instances in class attributes are fixed properties.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">StringProperty</span><span class="p">()</span>
    <span class="n">hobbies</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">ListProperty</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s">&quot;Albert&quot;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s">&quot;Johnson&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">hobbies</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;chess&quot;</span><span class="p">,</span> <span class="s">&quot;travel&quot;</span><span class="p">]</span>

<span class="n">p</span><span class="o">.</span><span class="n">chess_elo_rating</span> <span class="o">=</span> <span class="mf">1350</span>

<span class="n">p</span><span class="o">.</span><span class="n">travel_countries_visited</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Spain&quot;</span><span class="p">,</span> <span class="s">&quot;Italy&quot;</span><span class="p">,</span> <span class="s">&quot;USA&quot;</span><span class="p">,</span> <span class="s">&quot;Brazil&quot;</span><span class="p">]</span>
<span class="n">p</span><span class="o">.</span><span class="n">travel_trip_count</span> <span class="o">=</span> <span class="mf">13</span>
</pre></div>
</div>
<p>Because dynamic properties do not have document property definitions, dynamic properties are not validated. Any dynamic property can have a value of any of the python types, including None.</p>
<p>Unlike fixed properties, dynamic properties need not exist. A dynamic property with a value of None is different from a non-existent dynamic property.  You can delete a dynamic property by deleting the attribute.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">del</span> <span class="n">p</span><span class="o">.</span><span class="n">chess_elo_rating</span>
</pre></div>
</div>
<p>A request that uses a dynamic property will only return entities whose value for the property is of the same type as the value used in the request. Similarly, the request will only return entities with that property set.</p>
<div class="highlight-python"><pre>p1 = Person()
p1.favorite = 42
p1.save(db)

p2 = Person()
p2.favorite = "blue"
p2.save(db)

p3 = Person()
p3.save(db)

people = Person.view(db, "person/favorite", startkey=0, endkey=50)
# people has p1, but not p2 or p3

people = Person.view(db, "person/favorite")", startkey=50)
# people has no results</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some dynamic data in couchdb are automatically converted to their python type. Those are datetime, datetime.date, datetime.time and Decimal types. this is only possible if date/time fields are <span class="target" id="index-0"></span><a class="reference external" href="http://rfc.net/rfc8601.html"><strong>RFC 8601</strong></a> strings in the couchdb document.</p>
</div>
</div>
<div class="section" id="document-inheritance">
<h2>Document inheritance<a class="headerlink" href="#document-inheritance" title="Permalink to this headline">¶</a></h2>
<p>Document inheritance in simplecouchdb work almost identically to the way normal class inheritance works in Python. The only difference is that you can&#8217;t inherit views.</p>
<div class="highlight-python"><pre>class Animal(Document)
    name = schema.StringProperty(required=True)
    type = schema.StringProperty(required=True)

class Pet(Animal):
    birthdate = schema.DateProperty()
    weight_in_pounds = schema.IntegerProperty()
    spayed_or_neutered = schema.BooleanProperty()
    owner = schema.StringProperty()</pre>
</div>
<p>The <tt class="xref docutils literal"><span class="pre">Pet</span></tt> document will have 6 properties name, type, birthdate, weight_in_pounds, spayed_or_neutered, owner. It can be used as a common Document object. Pet and Animal have 2 different doc_type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For now, there is no way in CouchDB to know that Pet inherit from Animal. Though this feature will be implemented soon.</p>
</div>
</div>
<div class="section" id="properties-and-types">
<h2>Properties and Types<a class="headerlink" href="#properties-and-types" title="Permalink to this headline">¶</a></h2>
<p>Couchdb support all Javascrip types, including Unicode strings, integers, floating point numbers. We also added support for dates and decimal types. Each of the CouchDB value type has a corresponding Property class provided by the <tt class="xref docutils literal"><span class="pre">simplecouchdb.schema</span></tt> module.</p>
<p><a class="reference external" href="property.html#property-ref"><em>Properties and Types</em></a> describes all of the supported value types and their corresponding Property classes.</p>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<ul>
<li class="toctree-l1"><a class="reference external" href="creating_getting_deleting.html">Creating, Getting and Deleting Data</a><ul>
<li class="toctree-l2"><a class="reference external" href="creating_getting_deleting.html#creating-and-updating-a-document">Creating and Updating a Document</a></li>
<li class="toctree-l2"><a class="reference external" href="creating_getting_deleting.html#getting-documents-using-id">Getting documents using id</a></li>
<li class="toctree-l2"><a class="reference external" href="creating_getting_deleting.html#getting-documents-using-view">Getting documents using view</a></li>
<li class="toctree-l2"><a class="reference external" href="creating_getting_deleting.html#getting-documents-using-view-property">Getting documents using view property</a></li>
<li class="toctree-l2"><a class="reference external" href="creating_getting_deleting.html#deleting-document">Deleting document</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="document.html">Document:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="property.html">Properties and Types</a><ul>
<li class="toctree-l2"><a class="reference external" href="property.html#couchdb-values-types">CouchDB values types</a></li>
<li class="toctree-l2"><a class="reference external" href="property.html#properties-classes">Properties Classes</a></li>
<li class="toctree-l2"><a class="reference external" href="property.html#property-base-class">Property base class</a></li>
<li class="toctree-l2"><a class="reference external" href="property.html#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Schema Reference</a><ul>
<li><a class="reference external" href="#the-document-interface">The Document interface</a></li>
<li><a class="reference external" href="#document-is-dynamic">Document is dynamic</a></li>
<li><a class="reference external" href="#document-inheritance">Document inheritance</a></li>
<li><a class="reference external" href="#properties-and-types">Properties and Types</a></li>
<li><a class="reference external" href="#reference">Reference</a><ul>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../breakingchanges.html" title="previous chapter">Breaking Changes</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="creating_getting_deleting.html" title="next chapter">Creating, Getting and Deleting Data</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/schema/index.txt">Show Source</a></li>
            </ul>
          <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="creating_getting_deleting.html" title="Creating, Getting and Deleting Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../breakingchanges.html" title="Breaking Changes"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">py-simplecouchdb v0.9.25 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, 2009, Benoit Chesneau.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.5.1.
    </div>
  </body>
</html>