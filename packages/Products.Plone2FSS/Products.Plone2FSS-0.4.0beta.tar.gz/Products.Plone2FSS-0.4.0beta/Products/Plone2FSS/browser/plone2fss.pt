<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="Products.Plone2FSS">

      
<body>

<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main">

	<h1>Plone2FSS management</h1>
	
	<p>
		This form let you modify some FileSystemStorage behaviour on your Data.fs
	</p>
	<p>
		Can be usefull when:
	</p>
	<ul>
		<li>You have choosen a bad storage strategy or you simply kept the default ones</li>
		<li>You want to use FSS in an old Plone portal that didn't use it before</li>
	</ul>
	<p>
		Please, <strong>be carefull</strong>.
	</p>

	<form tal:attributes="action string:${context/absolute_url}/@@plone2fss_export"
	      method="post">
		
		<fieldset>
			<legend>Export to a valid FSS format</legend>

			<div class="formHelp">
				This utility export the contents of documents below this level to a valid
				FileSystemStorage format.<br/>
				This <em>not</em> change the content's storage, only export data in a server
				filesystem directory.
			</div>

			<label for="filesystem_output_dir">Server filesystem output directory</label>
			<span class="fieldRequired" title="Required"
                          i18n:attributes="title title_required;"
                          i18n:translate="label_required">(Required)</span>
			<div class="formHelp">
				Put here a valid directory on the server, where to export data
			</div>
			<input style="width:100%" name="filesystem_output_dir" id="filesystem_output_dir"
			       tal:attributes="value view/request/filesystem_output_dir|nothing" />
			<div class="visualClear">&nbsp;</div>

			<strong>Strategy</strong>
			<span class="fieldRequired" title="Required"
                          i18n:attributes="title title_required;"
                          i18n:translate="label_required">(Required)</span>
			<div class="formHelp">
				Export data in a specific strategy
			</div>
			<input type="radio" name="strategy_type" id="stype_flat"
			       value="flat" />
			<label for="stype_flat">Flat</label><br/>
			<input type="radio" name="strategy_type" id="stype_directory"
			       value="directory" />
			<label for="stype_directory">Directory</label><br/>
			<input type="radio" name="strategy_type" id="stype_site1"
			       value="site1" />
			<label for="stype_site1">Site1</label><br/>
			<input type="radio" name="strategy_type" id="stype_site2"
			       value="site2" disabled="disabled" />
			<label for="stype_site2">Site2</label><br/>
			<div class="visualClear">&nbsp;</div>

			<label for="content_types_migration">Content types</label>
			<div class="formHelp">
				Enter a list of content types to export, one per line.
			</div>
			<textarea name="content_types:lines" id="content_types_migration" rows="5"
			          tal:content="python: '\n'.join(request.get('content_types',[])) or '\n'.join(view.default_content_types)">
				File
				Image...
			</textarea>
			<div class="visualClear">&nbsp;</div>


			<label for="image_field_formats">Available image field's format</label>
			<div class="formHelp">
				Enter all avaiable format for image fields, used in the content types above.
			</div>
			<textarea name="image_field_formats:lines" id="image_field_formats" rows="5"
			          tal:content="python: '\n'.join(request.get('image_field_formats',[])) or '\n'.join(view.default_image_field_formats)">
				File
				Image...
			</textarea>
			<div class="visualClear">&nbsp;</div>

			<input type="submit" name="to_fss" class="context" value="Run" />
		</fieldset>
	</form>

	<form tal:attributes="action string:${context/absolute_url}/@@plone2fss_export"
	      method="post">
		<fieldset>
			<legend>Change contents storage</legend>

			<div class="formHelp">
				Dinamically change the storage on contents below this level from
				<em>AttributeStorage</em> to <em>FileSystemStorage</em>.
				FileSystemStorage must be installed, and contents must be configured to use it.<br/>
				<strong>Please, BACKUP you Data.fs first!</strong>.
			</div>

			<label for="content_types_stchange">Content types</label>
			<div class="formHelp">
				Enter a list of content types to act on.
			</div>
			<textarea name="content_types:lines" id="content_types_stchange" rows="5"
			          tal:content="python: '\n'.join(request.get('content_types',[])) or '\n'.join(view.default_content_types)">
				File
				Image...
			</textarea>
			<div class="visualClear">&nbsp;</div>

			<input type="submit" name="attr2fss" class="context" value="Run"
			       onclick="return confirm('Are you REALLY sure?\nHave you done a backup of your database?')"/>
		</fieldset>
	</form>

    </tal:main-macro>
</metal:main>

</body>
</html>