{% extends "receipt_base.html" %}
{% load i18n humanize %}
{% block receiptcontent %}
<div class="module">
<table width="100%">
<caption>{% trans "Invoiced Items" %}</caption>
<tr><th>{% trans "Description" %}</th><th>{% trans "Unit Price" %}</th>
    <th>{% trans "Quantity" %}</th><th>{% trans "Amount" %}</th></tr>
<tr><th colspan="3">{% trans "Opening balance" %}</th>
    <td valign="bottom" align="right">{{receipt.opening|stringformat:"01.2f"|intcomma}}</td></tr>
{% for detail in details %}
<tr><td><pre style="margin:0;"><a href="/admin/billing/receipt/{{receipt.id}}/charges/?rate__implementation__exact={{detail.implementation}}">{{detail.description}} ({{detail.chargeType}})</a></pre></td>
	<td valign="bottom" align="right">
{% if editable %}{% if detail.price %}
<form method="POST">
<input type="hidden" name="action" value="rerate"/>
<input type="hidden" name="receipt_id" value="{{receipt.id}}"/>
<input type="hidden" name="rating_id" value="{{detail.rating_id}}"/>
<input type="text" name="amount" value="{{detail.price|stringformat:"01.4f"}}"/>
<input type="submit" value="{% trans 'Recalculate'%}"/>
</form>
{% endif %}{% else %}
{{detail.price|stringformat:"01.4f"|intcomma}}
{% endif %}
	</td>
	<td valign="bottom" align="right">{{detail.count|intcomma}}</td>
	<td valign="bottom" align="right">{{detail.total|stringformat:"01.2f"|intcomma}}</td>
</tr>
{% endfor %}
<tr><th colspan="3">{% trans "Total" %}</th>
    <td valign="bottom" align="right">{{receipt.total|stringformat:"01.2f"|intcomma}}</td></tr>
<tr><th colspan="3">{% trans "Closing balance" %}</th>
    <td valign="bottom" align="right">{{receipt.closing|stringformat:"01.2f"|intcomma}}</td></tr>
</table>
</div>
{% endblock %}
