{% extends "admin/change_list.html" %}
{% load i18n humanize %}
{% if not is_popup %}{% block breadcrumbs %}<div class="breadcrumbs"><a href="/admin/">{% trans 'Home' %}</a> &rsaquo; <a href="/admin/billing/">{% trans 'Billing and Invoicing' %}</a> &rsaquo; {% trans "Account Statistics" %}</div>{% endblock %}{% endif %}
{% block content %}
<div id="content-main">
<style>
	.flagged { background-color: #ff5533; };
	.heading { font-weight: bold; };
</style>
<div class="module" style="width:50%">
<table cellspacing="0" width="100%">
<caption>{% trans "Account Billing Statistics" %}</caption>
<tr><th>{% trans 'Date' %}</th><td align="right">{{now}}</td></tr>
<tr><th>{% trans 'Total Volume' %}</th><td align="right">{{total|stringformat:"01.2f"|intcomma}}</td></tr>
<tr><th>{% trans 'Month to date' %}</th><td align="right">{{todate|stringformat:"01.2f"|intcomma}}</td></tr>
<tr><th>{% trans 'Last Month' %}</th><td align="right">{{last|stringformat:"01.2f"|intcomma}}</td></tr>
</table>
</div>
<div class="module" id="changelist">
<table cellspacing="0">
<thead>
	<tr class="heading">
		<th>{% trans 'Account' %}</th>
		<th align="right">{% trans 'Balance' %}</th>
		<th align="right">{% trans 'Current' %}</th>
		<th align="right">{% trans 'Receipts' %}</th>
		<th align="right" colspan="2">{% trans 'Latest' %}</th>
		<th align="right">{% trans 'Deviation' %}</th>
		<th align="right">{% trans 'Minimum' %}</th>
		<th align="right">{% trans 'Maximum' %}</th>
		<th align="right">{% trans 'Average' %}</th>
		<th align="right">{% trans 'Std. Dev.' %}</th>
	</tr>
{% for stat in stats %}
	<tr{% if stat.flag %} class="flagged"{% endif %}>
		<td><a href="/admin/billing/account/{{stat.account.id}}/">{{stat.account}}</a></td>
		<td align="right">{{stat.account.balance|stringformat:"01.2f"|intcomma}} {{stat.account.currency}}</td>
		<td align="right">{{stat.current.total|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.account.receipt_set.count|intcomma}}</td>
		<td><a href="/admin/billing/receipt/{{stat.latest.id}}/">{{stat.latest}}</a></td>
		<td align="right">{{stat.latest.total|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.dev|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.min|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.max|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.average|stringformat:"01.2f"|intcomma}}</td>
		<td align="right">{{stat.stddev|stringformat:"01.2f"|intcomma}}</td>
	</tr>
{% endfor %}
</table>
</div>
</div>
{% endblock %}
