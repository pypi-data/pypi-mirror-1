#!/bin/bash
command=$1

if [[ "$1" == "--help" ]]; then
	# needed by lgp check
	exit
fi

mkdir -p /opt/buildd 2>/dev/null

if [ -f /usr/share/keyrings/debian-archive-keyring.gpg ]
then
    for dist in etch lenny sid 
    do 
        sudo pbuilder ${command} --distribution ${dist} --basetgz /opt/buildd/${dist}.tgz --mirror http://ftp.fr.debian.org/debian \
                                 --othermirror "deb http://intranet.logilab.fr/debian/logilab-private/debian ${dist}/ |deb http://intranet.logilab.fr/debian/logilab-public/debian ${dist}/"
    done
fi

if [ -f /usr/share/keyrings/ubuntu-archive-keyring.gpg ]
then
    for dist in dapper feisty gutsy hardy intrepid
    do 
        sudo pbuilder ${command} --distribution ${dist} --basetgz /opt/buildd/${dist}.tgz --mirror http://fr.archive.ubuntu.com/ubuntu \
                                 --othermirror "deb http://intranet.logilab.fr/debian/logilab-private-${dist}/debian ${dist}/ | deb http://security.ubuntu.com/ubuntu ${dist}-security main restricted | deb http://fr.archive.ubuntu.com/ubuntu/ ${dist}-updates main restricted" \
                                 --components "main restricted universe"
    done
fi
