<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<div class="division-title-block">
<a name="id102477"></a><div class="division-title">Packaging avec les outils de DevTools</div>
</div><div class="component-title-block"><div class="component-title">Table des Matières</div></div><div class="toc"><div class="toc-element">
<div class="component-toc-text"><a href="#empaquetage-d-un-paquet-conforme-au-standard-source-tree">Chapitre I - Empaquetage d'un paquet conforme au "Standard Source Tree"</a></div>
<div class="toc-element"><div class="sect1-toc-text"><a href="#cr-ation-d-un-tarball-avec-distutils">1.  Création d'un tarball avec distutils</a></div></div>
<div class="toc-element"><div class="sect1-toc-text"><a href="#test-du-paquet-debian">2.  Test du paquet debian</a></div></div>
<div class="toc-element"><div class="sect1-toc-text"><a href="#construction-du-paquet-final">3.  Construction du paquet final</a></div></div>
</div></div><div class="component-title-block">
<a name="empaquetage-d-un-paquet-conforme-au-standard-source-tree"></a><div class="component-pretitle">Chapitre I</div>
<div class="component-title">Empaquetage d'un paquet conforme au "Standard Source Tree"</div>
</div>

<div class="para">Pour commencer, il est important de voir la documentation du fameux
<a class="" href="standard_source_tree.html">standard source tree</a> avant de passer à la suite de ce document.</div>
<div class="sect1-title">
<a name="cr-ation-d-un-tarball-avec-distutils"></a>1. Création d'un tarball avec distutils</div>

<div class="para">La première étape de la distribution d'un paquet Python est de rendre celui-ci
distribuable à l'aide de <a class="" href="http://www.python.org/sigs/distutils-sig/">Distutils</a> (cela n'est pas nécessaire pour les produits
Zope). Ce paquet fournit un fichier <span class="emphasis">setup.py</span> générique, tirant les
informations nécessaire du fichier <span class="emphasis">__pkginfo__.py</span>. Vous n'avez donc
théoriquement qu'à copier le setup.py générique et à écrire un fichier
<span class="emphasis">MANIFEST.in</span>. Pour en savoir plus ou si vous avez des besoins un peu exotique,
e vous laisse lire la <a class="" href="http://www.python.org/sigs/distutils-sig/doc/">documentation</a> de distutils. Une fois cela effectué, il
est de bon ton de tester que ça marche...</div>
<ol class="list">
<li class="listitem">
<div class="para">
<span class="emphasis-bold">python setup.py sdist</span> à la racine du paquet.</div>
</li>
<li class="listitem">
<div class="para">vérifier que l'archive générée (dans le sous-répertoire <span class="emphasis">dist</span>) contient les
fichiers désirés.</div>
</li>
<li class="listitem">
<div class="para">extraire l'archive (tarball) dans un répertoire temporaire.</div>
</li>
<li class="listitem">
<div class="para">
<span class="emphasis-bold">python setup.py install</span> dans le répertoire extrait de l'archive
(voir les options d'installation avec <span class="emphasis-bold">python setup.py install --help</span>).</div>
</li>
<li class="listitem">
<div class="para">vérifier que les tests / éxécutables installés fonctionnent correctement.</div>
</li>
</ol>
<div class="para">L'utilitaire <a class="" href="preparedistrib.html">preparedistrib</a> vous aide en faisant des vérifications et diverses
actions préparant la distribution. Il est donc fortement conseillé de l'éxécuter
avant d'effectuer une distribution. Une fois le tarball généré et vérifié,
utiliser l'utilitaire <a class="" href="tagpackage.html">tagpackage</a> pour mettre un tag dans le CVS correspondant
à la distribution que vous venez d'effectuer.</div>

<div class="sect1-title">
<a name="test-du-paquet-debian"></a>2. Test du paquet debian</div>

<div class="para">Pour tester rapidement votre paquet debian utilisez <a class="" href="buildpackage.html">buildpackage</a>.
(<span class="emphasis-bold">buildpackage logilab/pyreverse deb</span> si on reprend l'exemple).</div>
<div class="para">Une fois le paquet construit, il faut vérifier :</div>
<ol class="list">
<li class="listitem">
<div class="para">son contenu avec <span class="emphasis-bold">dpkg --contents &lt;monpackage.deb&gt;</span>
</div>
</li>
<li class="listitem">
<div class="para">son installation avec <span class="emphasis-bold">dpkg -i &lt;monpackage.deb&gt;</span>
</div>
</li>
<li class="listitem">
<div class="para">que les tests / éxécutables installés fonctionnent correctement</div>
</li>
<li class="listitem">
<div class="para">sa déinstallation avec <span class="emphasis-bold">dpkg -r &lt;monpackage.deb&gt;</span>
</div>
</li>
</ol>

<div class="sect1-title">
<a name="construction-du-paquet-final"></a>3. Construction du paquet final</div>

<div class="para">Une fois que tout marche, vous devez utiliser <a class="" href="makedistrib.html">makedistrib</a> pour construire le
tarball et le paquet debian. Il est important d'utiliser ensuite l'utilitaire
<a class="" href="tagpackage.html">tagpackage</a> pour mettre les tags dans le gestionnaire de source.</div>


