<div class="comments">
<div class="commentsheader">Комментарии</div>
<tal:block repeat="comment view/comments/values">
  <div class="comment">
    <div class="commentheader">
        <div class="commentauthor"
	    tal:on-error="structure python:'Unknown Author'"
            tal:content="structure python:path('comment/@@nickname')[comment.author]"
        />
        <span 
            class="commentdate"
            tal:define="datetimeformat context/++registry++datetimeformat:%Y-%m-%d"
            tal:content="python:comment.created.strftime(str(datetimeformat))"
	/>
    </div>

    <div class="commentauthorimage">
	  <tal:block
		define="profile python:view.profile(comment.author)"
	        on-error="structure python:'<img src=\'/++resource++images/nophoto-small.gif\'/>'"> 
          <a href=""
              tal:attributes="href profile/@@absolute_url">
            <tal:block
                  condition="python:path('profile/++attribute++logo').getSize() > 0"
                  content="structure python:path('profile/++attribute++logo/@@smartimagecontainer/small').tag()">
            </tal:block>
            <tal:block
                  condition="python:path('profile/++attribute++logo').getSize() == 0">
                  <img src="/++resource++images/nophoto-small.gif" alt="NO PHOTO" />
            </tal:block>
          </a>
      </tal:block> 
    </div>

    <div class="commentabstract" tal:content="structure comment/++nsinterface++ng.app.converter.object2psadapter.interfaces.IPropertySheet/abstract"/>
  </div>
</tal:block>
<div class="commentadd" tal:condition="context/++nsinterface++ng.content.comment.interfaces.ICommentAnnotation/isallow"><a href="@@addcomment.html">Добавить комментарий</a></div>
</div>