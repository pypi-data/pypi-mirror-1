<html metal:use-macro="context/@@skin_macros/view"
    i18n:domain="zope">
  <head>
    <title>FriendList</title>
  </head>
  <body>
    <div metal:fill-slot="body">
      
      <div class="friendlist">
        <div class="message" tal:content="options/message | nothing" tal:condition="options/message | nothing"/>
        <div class="error" tal:content="options/error | nothing" tal:condition="options/error | nothing"/>

        <h1 class="friendlistheader">Мои друзья: </h1>
           
        <tal:block
            tal:define="friends view/friends">
          
          <tal:block
              tal:condition="python: len(friends.set) < 1">
              <p>&nbsp;Друзей нет :(</p>
          </tal:block>
          <tal:block
              tal:condition="python: len(friends.set) > 0">
          <tal:block repeat="friend friends/friends">
              
            <div class="person"
                 tal:condition="python:not view.iscommunity(friend.profile)">
              <a tal:attributes="href friend/profile/@@adaptive_url">
              <div class="imagebox">
                <tal:block
                    on-error="structure python:'<img src=\'/++resource++images/nophoto-small.gif\'/>'">
                  <tal:block
                      condition="python:path('friend/profile/++attribute++logo').getSize() > 0"
                      content="structure python:path('friend/profile/++attribute++logo/@@smartimagecontainer/small').tag()">
                  </tal:block>
	              <tal:block 
		              condition="python:path('friend/profile/++attribute++logo').getSize() == 0">
		            <img src="/++resource++images/nophoto-small.gif" alt="NO PHOTO" />
	              </tal:block>
                </tal:block>
              </div>
              </a>
              <br clear="both" />
              <a tal:attributes="href friend/profile/@@adaptive_url">
                <span class="personname" tal:content="friend/profile/title">Степан Лондон</span>
                <span class="personstatus" tal:content="python:friend.status and 'accepted' or 'waited'">Друг</span>
                <span class="iscommunity"
                    tal:condition="python:view.iscommunity(friend.profile)">
                  (cообщество)
                </span>
              </a> 
            </div>

            <div class="community"
                 tal:condition="python:view.iscommunity(friend.profile)">
              <a tal:attributes="href friend/profile/@@adaptive_url">
              <div class="imagebox">
                <tal:block
                    on-error="structure python:'<img src=\'/++resource++images/nophoto-small.gif\'/>'">
                  <tal:block
                      condition="python:path('friend/profile/++attribute++logo').getSize() > 0"
                      content="structure python:path('friend/profile/++attribute++logo/@@smartimagecontainer/small').tag()">
                  </tal:block>
	              <tal:block 
		              condition="python:path('friend/profile/++attribute++logo').getSize() == 0">
		            <img src="/++resource++images/nophoto-small.gif" alt="NO PHOTO" />
	              </tal:block>
                </tal:block>
              </div>
              </a>
              <br clear="both" />
              <a tal:attributes="href friend/profile/@@adaptive_url">
                <span class="communityname" tal:content="friend/profile/title">Степан Лондон</span>
                <span class="communitystatus" tal:content="python:friend.status and 'accepted' or 'waited'">Друг</span>
                <span class="iscommunity"
                    tal:condition="python:view.iscommunity(friend.profile)">
                  (cообщество)
                </span>
              </a> 
            </div>

          </tal:block>  
          <br clear="all" />
          </tal:block>
        </tal:block>
      </div>
      
      <form action="" tal:attributes="action string: ${context/@@absolute_url}/">
        <input type="submit" name="suggest:method" value="Suggest friendship" class="button" />
      </form>
    </div>
  </body>
</html>  