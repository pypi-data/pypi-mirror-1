<tal:def define="portal_url python:view.context.portal_url.getPortalObject().absolute_url()">
<span tal:replace="structure string:<script><!--" />
   if (typeof(Calendar) == 'undefined')
   {
    var head = document.getElementsByTagName("head")[0];         

    var cssNode = document.createElement('link');
    cssNode.type = 'text/css';
    cssNode.rel = 'stylesheet';
    cssNode.href = '<span tal:replace="string:$portal_url/jscalendar/calendar-system.css"/>';
    cssNode.media = 'screen';
    head.appendChild(cssNode);

    var newScript = document.createElement('script');
    newScript.type = 'text/javascript';
    newScript.src = '<span tal:replace="string:$portal_url/jscalendar/calendar_stripped.js"/>';
    head.appendChild(newScript);

    var newScript = document.createElement('script');
    newScript.type = 'text/javascript';
    newScript.src = '<span tal:replace="string:$portal_url/jscalendar/calendar-en.js"/>';
    head.appendChild(newScript);
   }
<span tal:replace="structure string:--></script>" />
</tal:def>
