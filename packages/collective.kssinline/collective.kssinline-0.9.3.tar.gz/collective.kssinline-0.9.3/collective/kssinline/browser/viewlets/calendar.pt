<tal:def define="portal_url python:view.context.portal_url.getPortalObject().absolute_url()">
<span tal:replace="structure string:<script><!--" />
   if (typeof(Calendar) == 'undefined')
   {
    var head = document.getElementsByTagName("head")[0];         

    <tal:css repeat="css python:('jscalendar/calendar-system',
        'content_types')">
      var cssNode = document.createElement('link');
      cssNode.type = 'text/css';
      cssNode.rel = 'stylesheet';
      cssNode.href = '<span tal:replace="string:${portal_url}/${css}.css"/>';
      cssNode.media = 'screen';
      head.appendChild(cssNode);
    </tal:css>

    <tal:scripts repeat="script python:('jscalendar/calendar_stripped',
    'jscalendar/calendar-en',
    'widgets/js/textcount',
    'widgets/js/inandout',
    'widgets/js/picklist')">
      var newScript = document.createElement('script');
      newScript.type = 'text/javascript';
      newScript.src = '<span tal:replace="string:${portal_url}/${script}.js"/>';
      head.appendChild(newScript);
    </tal:scripts>
   }
<span tal:replace="structure string:--></script>" />
</tal:def>
