<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type" />
  
  <title>Creating Applications: Labelling Multiple-Choice Values</title><meta name="generator" content="amaya 8.1a, see http://www.w3.org/Amaya/" />
  <link href="styles.css" rel="stylesheet" type="text/css" /></head>
<body>
<h1>Creating Applications: Labelling Multiple-Choice Values</h1>
<p>When introducing the item type multiple-choice field into the application, we defined the following values:</p><pre>&lt;?xml version="1.0"?&gt;<br />&lt;type&gt;<br />  &lt;type-enum value="(Not selected)"/&gt;<br />  &lt;type-enum value="Important"/&gt;<br />  &lt;type-enum value="Not important"/&gt;<br />  &lt;type-enum value="Personal"/&gt;<br />&lt;/type&gt;</pre><p>For
simple applications with a limited audience, it is often acceptable to
use values which are then presented unchanged such that the value&nbsp;<code>Personal</code> is known both inside the application and is also shown to the user as the textual string <code>Personal</code>. However, for other applications there may be good reasons not to show values directly in this way:</p><ol><li>There may be a special internal value which is not descriptive; for example&nbsp;<code>123</code> representing the same concept as <code>Personal</code>.</li><li>The value might be understandable not be understandable to some users; for example, the text <code>Personal</code> may not be understood by users who do not speak or otherwise use the&nbsp;English language.</li></ol><p>We
must therefore consider introducing additional label information in
order to remedy the first case, at least. Consequently, we may modify
the defined values as follows:</p><pre>?xml version="1.0"?&gt;<br />&lt;type&gt;<br />  &lt;type-enum value="0"&gt;(Not selected)&lt;/type-enum&gt;<br />  &lt;type-enum value="I"&gt;Important&lt;/type-enum&gt;<br />  &lt;type-enum value="N"&gt;Not important&lt;/type-enum&gt;<br />  &lt;type-enum value="P"&gt;Personal&lt;/type-enum&gt;<br />&lt;/type&gt;</pre><p>Here,
we have provided user-visible labels which can now be used by the
template. A single change to the item type choices list is required to
include these labels as the visible text in that particular form
control whilst maintaining the usage of the internal values:</p><pre>  &lt;p&gt;<br />    Item type:<br />    &lt;select template:multiple-choice-list-field="type,type-enum,value" name="..." multiple="multiple"<br />      onchange="requestUpdate(<br />        'comments',<br />        '{template:list-attribute('type-enum', 'value')}',<br />        '{template:other-elements(../options)}',<br />        '{template:child-attribute('value', template:child-element('comment', 1, template:other-elements(../options)))}',<br />        '/structure/item/options')"&gt;<br />      &lt;option template:multiple-choice-list-value="type-enum,value,selected<span style="font-weight: bold;">,text()</span>" value="..." /&gt;<br />    &lt;/select&gt;<br />  &lt;/p&gt;</pre><p>The addition, as described in the&nbsp;<a href="reference.html#multiple-choice-value"><code>template:multiple-choice-value</code></a> and&nbsp;<a href="reference.html#multiple-choice-list-value"><code>template:multiple-choice-list-value</code></a> sections of the <a href="reference.html">"Template Attribute Reference"</a> document, selects the text inside the appropriate&nbsp;<code>type-enum</code> elements and inserts it as a label into each choice in the item type list.</p><ul>
</ul><h3>Updating the Web Resource</h3>
<p>To update the special WebStack resource,&nbsp;we
now need to modify a few of the class attributes:</p>
<pre>    template_resources = {<br />        "structure" : ("structure_multivalue_label_template.xhtml", "structure_output.xsl")<br />        }<br />    init_resources = {<br />        "structure" : ("structure_multivalue_label_template.xhtml", "structure_input.xsl")<br />        }<br />    document_resources = {<br />        "types" : "structure_types_label.xml"<br />        }<br /></pre>
<p>With these adjustments, it should now be possible to see the
original labels and yet have the application manipulate a separate set
of internal values.
Note that it may be necessary to remove the old stylesheet for
producing output,&nbsp;<code>structure_output.xsl</code>, so that the updated version of the template is taken into use.</p><h3>Translating Labels</h3><p>Whilst
the above work made it possible to satisfy the first motivation of the
use of labels - to hide internal values - it did not permit us to
provide translations for different languages. In fact, there are at
least two approaches which could provide labels in multiple languages:</p><ol><li>Define a file containing the&nbsp;<code>types</code> and&nbsp;<code>type-enum</code> elements for each language.</li><li>Use the internationalisation support in XSLForms to translate the labels.</li></ol><p>The
former approach might work in situations where multiple-choice values
are obtained from a repository, such as a database, which contains the
labels for items in each supported language. One can envisage a product
database, for example, containing product descriptions for each
language or market, and such information could be extracted in such a
way that it could be convenient to use many different data files (or to
extract the information&nbsp;dynamically, insert it into the form data
document, and to provide a reference to the form data document as a
source of value information).</p><p>Let us concentrate, however, on the
latter, more convenient approach for our example application. In order
to produce translated labels, we must first define a <a href="internationalisation.html#PreparingTheTranslations">translations file</a> as described in the <a href="internationalisation.html">"Internationalisation"</a> document; this file can be saved alongside our other resources with the name&nbsp;<code>translations.xml</code>, and its contents can be defined as follows:</p><pre>&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;<br />&lt;translations&gt;<br />  &lt;locale&gt;<br />    &lt;code value="nb"/&gt;<br />    &lt;code value="nb_NO"/&gt;<br />    &lt;translation value="(Not selected)"&gt;(Ikke valgt)&lt;/translation&gt;<br />    &lt;translation value="Important"&gt;Viktig&lt;/translation&gt;<br />    &lt;translation value="Not important"&gt;Ikke viktig&lt;/translation&gt;<br />    &lt;translation value="Personal"&gt;Personlig&lt;/translation&gt;<br />  &lt;/locale&gt;<br />&lt;/translations&gt;</pre><p>To make use of this file, we must add additional references in the Web resource's attributes:</p><pre>    document_resources = {<br />        "types" : "structure_types_label.xml",<br />        <span style="font-weight: bold;">"translations" : "translations.xml"</span><br />        }</pre><p>And to introduce the translation mechanisms into the output production, we must modify the resource further:</p><pre>        # Complete the response.<br /><br />        <span style="font-weight: bold;">stylesheet_parameters["locale"] = trans.get_content_languages()[0]</span><br />        self.send_output(trans, [trans_xsl], structure, stylesheet_parameters,<br />            <span style="font-weight: bold;">references={"translations" : self.prepare_document("translations")}</span>)</pre><p>Here, we define a&nbsp;<code>locale</code>
parameter for the output stylesheet using the first language specified
in each user's browser's language preferences. Then, we add a reference
to the translations document specified above.</p><p>Finally, we have to change the template to make use of the translations:</p><pre>  &lt;p&gt;<br />    Item type:<br />    &lt;select template:multiple-choice-list-field="type,type-enum,value" name="..." multiple="multiple"<br />      onchange="requestUpdate(<br />        'comments',<br />        '{template:list-attribute('type-enum', 'value')}',<br />        '{template:other-elements(../options)}',<br />        '{template:child-attribute('value', template:child-element('comment', 1, template:other-elements(../options)))}',<br />        '/structure/item/options')"&gt;<br />      &lt;option template:multiple-choice-list-value="type-enum,value,selected<span style="font-weight: bold;">,template:i18n(text())</span>" value="..." /&gt;<br />    &lt;/select&gt;<br />  &lt;/p&gt;</pre><p>Note that we use the&nbsp;<a href="../apidocs/public/XSLForms.Output-module.html#i18n"><code>template:i18n</code></a> extension function to modify the text found in each&nbsp;<code>type-enum</code> element in the types document. The usage of this function is described in the&nbsp;<a href="../apidocs/public/XSLForms.Output-module.html">extension function API documentation</a>.</p><p>Now, upon adding items in the application, if the browser is set up appropriately - in this case using&nbsp;<code>Norwegian Bokm&aring;l [nb]</code>&nbsp;as the first choice of language - the item types will appear translated in the final output.</p>
<h2>Further Reading</h2>
<p>Now that we have designed and implemented a simple application, it
may be worth reading some <a href="advice.html">recommendations</a>
about developing your own applications.</p>
</body></html>