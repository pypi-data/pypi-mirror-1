<html metal:use-macro="context/@@standard_macros/page"
      i18n:domain="z3c.widget.flashupload">

  <metal:block fill-slot="style_slot">
    <link rel="stylesheet" href="audio.css"
          tal:attributes="href string:$portal_url/++resource++ploneflashupload.css"
          />
  </metal:block>

  <metal:block fill-slot="body">
    <metal:block define-macro="swf"
                 tal:define="resourceurl string:$portal_url/++resource++;
                             z3curl string:${resourceurl}z3c.widget.flashupload">

      <div class="upload-form-controls">
        <form action="" name="upload_complete" method="get"
              tal:attributes="action view/upload_action">
          <input type="hidden" name="portal_status_message" value="" />
          <input type="button" id="flash.start.browsing" value="Upload Files"
                 name="upload_button"
                 class="context"
                 i18n:attributes="value"
                 onClick="JavaScript:z3cFlashUploadStartBrowsing()" />
        </form>
      </div>

      <script type="text/javascript"
              tal:content="string:
                           var swf_upload_url='$z3curl/upload.swf';
                           var swf_upload_target_path='${context/@@absolute_url}/uploadfile';
                           ">
      </script>

      <div id="flashuploadtarget">
        <!-- inside this div, the flash upload swf will be injected -->
      </div>

      <script type="text/javascript"
              src=""
              tal:attributes="src string:$z3curl/jquery.js">
      </script>

      <script type="text/javascript"
              src=""
              tal:attributes="src string:$z3curl/swfobject.js">
      </script>

      <script type="text/javascript"
              src=""
              tal:attributes="src string:$z3curl/upload.js">
      </script>

      <script type="text/javascript"
              src=""
              tal:attributes="src string:${resourceurl}ploneflashupload.js">
      </script>

    </metal:block>

    <div class="upload-folder-listing">
      <metal:block use-macro="context/folder_listing/macros/listing">
      </metal:block>
    </div>

  </metal:block>
</html>
