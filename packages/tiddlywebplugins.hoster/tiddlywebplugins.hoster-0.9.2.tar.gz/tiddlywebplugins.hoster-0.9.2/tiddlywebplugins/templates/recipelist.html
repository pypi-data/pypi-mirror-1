{% extends "hosterbase.html" %}
{% block body %}

{% if policy or delete %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"
    type="text/javascript"></script>
<script type="text/javascript">
    var server_prefix='{{ server_prefix }}';
    var current_username='{{ user.name }}';
</script>
{% endif %}

{% if policy %}
<!-- we can edit the description -->
<script src="{{ server_prefix }}/bags/hoster/tiddlers/bagdesc.js"
    type="text/javascript"></script>
{% endif %}

<h3>Recipe {{ recipe.name }}</h3>

<div id="description">
    <strong>Description:</strong>
    <span id="bagdesc">{{ recipe.desc }}</span>
</div>

{% if policy %}
<div id="policy">
    <h4>Policy</h4>
    <dl>
    {% for constraint in ['read', 'manage'] %}
    <dt>{{ constraint }}</dt>
    <dd><ul>{% for entry in policy[constraint] %}
        <li>{{ entry }}</li>
        {% endfor %}
    </ul></dd>
    {% endfor %}
    </dl>
    <form action="{{ server_prefix }}/recipepolicy" method="POST">
        Reset policy to <select name="publicity">
            <option value="private"
            {% if publicity == 'private' %}selected="1"{% endif %}>
            Private</option>
            <option value="public"
            {% if publicity == 'public' %}selected="1"{% endif %}>
            Public</option>
            <option value="custom"
            {% if publicity == 'custom' %}selected="1"{% endif %}>
            Custom</option>
        </select>
        <input type="submit" value="submit" />
        <input type="hidden" name="recipe" value="{{ recipe.name }}" />
    </form>
</div>
{% endif %}

<div id="representations">
    {{ representations }}
</div>

<h3>Recipe</h3>
<ul>
{% for bag, filter in recipe.get_recipe() %}
<li><a href="{{ server_prefix }}/bags/{{ bag }}/tiddlers">{{ bag }}</a>, {{ filter }}</a></li>
{% endfor %}
</ul>

<h3>Tiddlers</h3>
<ul>
{% for tiddler in bag.gen_tiddlers() %}
<li class="listedtiddler"><a
    href="{{ server_prefix }}/recipes/{{ recipe.name }}/tiddlers/{{ tiddler.title }}">{{ tiddler.title }}</a></li>
{% endfor %}
</ul>
{% endblock %}
