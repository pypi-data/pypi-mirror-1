{% extends "admin/change_form.html" %}
<?xml version="1.0" encoding="utf-8"?>
{% load i18n admin_list admin_csv %}

{% if not is_popup %}{% block breadcrumbs %}<div class="breadcrumbs"><a href="../../">{% trans "Home" %}</a> &rsaquo; <a href="../">{{ app_label|capfirst|escape }}</a> &rsaquo; {{ cl.opts.verbose_name_plural|capfirst|escape }}</div>{% endblock %}{% endif %}

{% block content %}


<div id="content-main">

   <script type="text/javascript">
    <!--
       isSelected = true;
       function toggleSelect() {
          if (isSelected == false) isSelected=true; else isSelected=false;
        inputs = document.getElementsByTagName('input')
        for (i = 0; i < inputs.length; i++) {
           input = inputs[i];
	 if (input.type == 'checkbox' && input.id != 'readonly') {
	    input.checked = isSelected ;
	}
        }
       }
       //-->
   </script>

   <form name="csvform" action="{{ request.path }}?all=1" enctype="multipart/form-data" method="POST">
    {% block filters %}
    {% if cl.has_filters %}
    <div id="changelist-filter">
    <h2>{% trans 'Filter' %}</h2>
    {% for spec in cl.filter_specs %}
       {% admin_list_filter_selector cl spec %}
    {% endfor %}
    </div>
    {% endif %}
    {% endblock %}
    <div id="fields" class="form-row">
     <h2>{% trans "Columns" %}</h2>
     <br />
     {% for field in fields %}
     <div class="module" style="display:block; float:left; padding-right:20px; margin-right: 5px;">
      {% if field.unique and cl %}
      <label class="required inline" style="padding-left:20px;" ><input id="readonly" type="checkbox" name="{{ field.name }}" {{ field.checked }} onclick="return false;" /> {{ field.name }}</label>
      {% else %}
      <label class="inline"><input type="checkbox" name="{{ field.name }}" {{ field.checked }} /> {{ field.name }}</label>
      {% endif %}
     </div>
     {% endfor %}
     <input type="submit" onclick="toggleSelect(); return false" value="{% trans "(De)Select all" %}" />

    </div>

    {% block form_specific %}
    <div class="form-row">
     <label class="required">
      {% trans "Encoding" %} : {{ form.encoding }}
     </label>
     <label class="required">
      {% trans "Delimiter" %} : {{ form.delimiter }}
     </label>

    </div>

    <div class="form-row">
     <input type="submit" value="export" name="action"/>
    </div>

    <div class="form-row">
     <p>
      {{ form.import_mode }}
     </p>
     {{ form.skip_first }} {% trans "Skip first line" %}
     <p>
      <label class="required">
         {% trans "File" %} : <input type="file" name="csv" />
      </label>
     </p>
    <input type="submit" value="import" name="action"/>
    </div>
    {% endblock %}

   </form>
   {% block results %}
   <table>
    {% for row in input %}
    <tr>
     {% for cell in row %}
     <td>{{ cell }}</td>
     {% endfor %}
    </tr>
    {% endfor %}
   </table>
   <pre>
    {% for message in output %}
    {% if forloop.first %}
    {% trans "CSV File had been procedeed" %}
    {% endif %}
    {{ message }}
    {% endfor %}
   </pre>
   {% endblock %}
{% endblock %}


</div>
