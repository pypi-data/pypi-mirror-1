<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extensions &mdash; WTForms v0.4 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="WTForms v0.4 documentation" href="index.html" />
    <link rel="prev" title="Widgets" href="widgets.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="widgets.html" title="Widgets"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">WTForms v0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-wtforms.ext">
<span id="extensions"></span><h1>Extensions<a class="headerlink" href="#module-wtforms.ext" title="Permalink to this headline">¶</a></h1>
<p>WTForms ships with a number of extensions that make it easier to work with
other frameworks and libraries, such as Django.</p>
<div class="section" id="module-wtforms.ext.django">
<h2>Django<a class="headerlink" href="#module-wtforms.ext.django" title="Permalink to this headline">¶</a></h2>
<p>This extension provides templatetags to make it easier to work with Django
templates and WTForms&#8217; html attribute rendering. It also provides a generator
for automatically creating forms based on Django ORM models.</p>
<div class="section" id="module-wtforms.ext.django.templatetags.wtforms">
<h3>Templatetags<a class="headerlink" href="#module-wtforms.ext.django.templatetags.wtforms" title="Permalink to this headline">¶</a></h3>
<p>Django templates does not allow arbitrarily calling functions with parameters,
making it impossible to use the html attribute rendering feature of WTForms. To
alleviate this, we provide a templatetag.</p>
<p>Adding <tt class="xref docutils literal"><span class="pre">wtforms.ext.django</span></tt> to your INSTALLED_APPS will make the wtforms
template library available to your application.  With this you can pass extra
attributes to form fields similar to the usage in jinja:</p>
<div class="highlight-django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">wtforms</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">form_field</span> <span class="nv">form.username</span> <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;big_text&quot;</span> <span class="nv">onclick</span><span class="o">=</span><span class="s2">&quot;do_something()&quot;</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p><strong>Note</strong> By default, using the <cite>{{ form.field }}</cite> syntax in django models will
be auto-escaped.  To avoid this happening, use Django&#8217;s <cite>{% autoescape off %}</cite>
block tag or use WTForms&#8217; <cite>form_field</cite> template tag.</p>
</div>
<div class="section" id="module-wtforms.ext.django.orm">
<h3>Model forms<a class="headerlink" href="#module-wtforms.ext.django.orm" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="wtforms.ext.django.orm.model_form">
<tt class="descclassname">wtforms.ext.django.orm.</tt><tt class="descname">model_form</tt><big>(</big><em>model</em>, <em>base_class=Form</em>, <em>include_pk=False</em><big>)</big><a class="headerlink" href="#wtforms.ext.django.orm.model_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a wtforms form for a given django model class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">wtforms.ext.django.orm</span> <span class="kn">import</span> <span class="n">model_form</span>
<span class="kn">from</span> <span class="nn">myproject.myapp.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="n">UserForm</span> <span class="o">=</span> <span class="n">model_form</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</pre></div>
</div>
<p>The form can be made to extend your own form by passing the <tt class="docutils literal"><span class="pre">base_class</span></tt>
parameter. Primary key fields are not included unless you specify
<tt class="docutils literal"><span class="pre">include_pk=True</span></tt>.</p>
<p><a title="wtforms.ext.django.orm.model_form" class="reference internal" href="#wtforms.ext.django.orm.model_form"><tt class="xref docutils literal"><span class="pre">model_form()</span></tt></a> attempts to glean as much metadata as possible from
inspecting the model&#8217;s fields, and will even attempt to guess at what
validation might be wanted based on the field type. For example, converting
an <cite>EmailField</cite> will result in a <a title="wtforms.fields.TextField" class="reference external" href="fields.html#wtforms.fields.TextField"><tt class="xref docutils literal"><span class="pre">TextField</span></tt></a> with
the <tt class="xref docutils literal"><span class="pre">email()</span></tt> validator on it. if the <cite>blank</cite>
property is set on a model field, the resulting form field will have the
<tt class="xref docutils literal"><span class="pre">optional()</span></tt> validator set.</p>
<p>Just like any other Form, forms created by ModelForm can be extended via
inheritance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">UserFormBase</span> <span class="o">=</span> <span class="n">model_form</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UserForm</span><span class="p">(</span><span class="n">UserFormBase</span><span class="p">):</span>
    <span class="n">new_pass</span>     <span class="o">=</span> <span class="n">PasswordField</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">optional</span><span class="p">(),</span> <span class="n">validators</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="s">&#39;confirm_pass&#39;</span><span class="p">)])</span>
    <span class="n">confirm_pass</span> <span class="o">=</span> <span class="n">PasswordField</span><span class="p">()</span>
</pre></div>
</div>
<p>When combined with <a title="wtforms.form.Form.__iter__" class="reference external" href="forms.html#wtforms.form.Form.__iter__"><tt class="xref docutils literal"><span class="pre">form</span> <span class="pre">iteration</span></tt></a>,
model_form is a handy way to generate dynamic CRUD forms which update with
added fields to the model. One must be careful though, as it&#8217;s possible the
generated form fields won&#8217;t be as strict with validation as a hand-written
form might be.</p>
</dd></dl>

</div>
<div class="section" id="module-wtforms.ext.django.fields">
<h3>ORM-backed fields<a class="headerlink" href="#module-wtforms.ext.django.fields" title="Permalink to this headline">¶</a></h3>
<p>While linking data to most fields is fairly easy, making drop-down select lists
using django ORM data can be quite repetetive. To this end, we have added some
helpful tools to use the django ORM along with wtforms</p>
<dl class="class">
<dt id="wtforms.ext.django.fields.QuerySetSelectField">
<em class="property">class </em><tt class="descclassname">wtforms.ext.django.fields.</tt><tt class="descname">QuerySetSelectField</tt><big>(</big><em>default field args</em>, <em>queryset=None</em>, <em>label_attr=''</em>, <em>allow_blank=False</em>, <em>blank_text=u''</em><big>)</big><a class="headerlink" href="#wtforms.ext.django.fields.QuerySetSelectField" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a QuerySet either at initialization or inside a view, will display a
select drop-down field of choices. The <cite>data</cite> property actually will
store/keep an ORM model instance, not the ID. Submitting a choice which is
not in the queryset will result in a validation error.</p>
<p>Specifying <cite>label_attr</cite> in the constructor will use that property of the
model instance for display in the list, else the model object&#8217;s <cite>__str__</cite>
or <cite>__unicode__</cite> will be used.</p>
<p>If <cite>allow_blank</cite> is set to <cite>True</cite>, then a blank choice will be added to the
top of the list. Selecting this choice will result in the <cite>data</cite> property
being <cite>None</cite>.  The label for the blank choice can be set by specifying the
<cite>blank_text</cite> parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ArticleEdit</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">title</span>    <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">column</span>   <span class="o">=</span> <span class="n">QuerySetSelectField</span><span class="p">(</span><span class="n">label_attr</span><span class="o">=</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="n">allow_blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">QuerySetSelectField</span><span class="p">(</span><span class="n">queryset</span><span class="o">=</span><span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">edit_article</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="n">article</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">ArticleEdit</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">article</span><span class="p">)</span>
    <span class="n">form</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">queryset</span> <span class="o">=</span> <span class="n">Column</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>As shown in the above example, the queryset can be set dynamically in the
view if needed instead of at form construction time, allowing the select
field to consist of choices only relevant to the user.</p>
</dd></dl>

<dl class="class">
<dt id="wtforms.ext.django.fields.ModelSelectField">
<em class="property">class </em><tt class="descclassname">wtforms.ext.django.fields.</tt><tt class="descname">ModelSelectField</tt><big>(</big><em>default field args</em>, <em>model=None</em>, <em>label_attr=''</em>, <em>allow_blank=False</em>, <em>blank_text=u''</em><big>)</big><a class="headerlink" href="#wtforms.ext.django.fields.ModelSelectField" title="Permalink to this definition">¶</a></dt>
<dd>Like a QuerySetSelectField, except takes a model class instead of a
queryset and lists everything in it.</dd></dl>

</div>
</div>
<div class="section" id="module-wtforms.ext.sqlalchemy">
<h2>SQLAlchemy<a class="headerlink" href="#module-wtforms.ext.sqlalchemy" title="Permalink to this headline">¶</a></h2>
<p>This extension provides SelectField integration with SQLAlchemy ORM models,
similar to those in the Django extension.</p>
<div class="section" id="module-wtforms.ext.sqlalchemy.fields">
<h3>ORM-backed fields<a class="headerlink" href="#module-wtforms.ext.sqlalchemy.fields" title="Permalink to this headline">¶</a></h3>
<p>These fields are provided to make it easier to use data from ORM objects in
your forms. Due to the complication of dealing with multiple-primary-keyed
tables, currently it is only possible to use these fields with simple integer
primary keyed ORM models.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">enabled_categories</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Category</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">enabled</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">BlogPostEdit</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">title</span>    <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">blog</span>     <span class="o">=</span> <span class="n">QuerySelectField</span><span class="p">()</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">QuerySelectField</span><span class="p">(</span><span class="n">query_factory</span><span class="o">=</span><span class="n">enabled_categories</span><span class="p">,</span> <span class="n">allow_blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">edit_blog_post</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">ArticleEdit</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">post</span><span class="p">)</span>
    <span class="n">form</span><span class="o">.</span><span class="n">blog</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Blog</span><span class="o">.</span><span class="n">author</span> <span class="o">==</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Blog</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="wtforms.ext.sqlalchemy.fields.QuerySelectField">
<em class="property">class </em><tt class="descclassname">wtforms.ext.sqlalchemy.fields.</tt><tt class="descname">QuerySelectField</tt><big>(</big><em>default field args</em>, <em>query_factory=None</em>, <em>pk_attr='id'</em>, <em>label_attr=''</em>, <em>allow_blank=False</em>, <em>blank_text=u''</em><big>)</big><a class="headerlink" href="#wtforms.ext.sqlalchemy.fields.QuerySelectField" title="Permalink to this definition">¶</a></dt>
<dd><p>Will display a select drop-down field to choose between ORM results in a
sqlalchemy <cite>Query</cite>.  The <cite>data</cite> property actually will store/keep an ORM
model instance, not the ID. Submitting a choice which is not in the query
will result in a validation error.</p>
<p>This field only works for queries on models with single-column integer
primary keys. If the primary key is not named &#8216;id&#8217;, then you should provide
the <cite>pk_attr</cite> with the name of the primary key field on the mapped model.</p>
<p>The <cite>query</cite> property on the field can be set from within a view to assign
a query per-instance to the field. If the property is not set, the
<cite>query_factory</cite> callable passed to the field constructor will be called to
obtain a query.</p>
<p>Specifying <cite>label_attr</cite> in the constructor will use that property of the
model instance for display in the list, else the model object&#8217;s <cite>__str__</cite>
or <cite>__unicode__</cite> will be used.</p>
<p>If <cite>allow_blank</cite> is set to <cite>True</cite>, then a blank choice will be added to the
top of the list. Selecting this choice will result in the <cite>data</cite> property
being <cite>None</cite>. The label for this blank choice can be set by specifying the
<cite>blank_text</cite> parameter.</p>
</dd></dl>

<dl class="class">
<dt id="wtforms.ext.sqlalchemy.fields.ModelSelectField">
<em class="property">class </em><tt class="descclassname">wtforms.ext.sqlalchemy.fields.</tt><tt class="descname">ModelSelectField</tt><big>(</big><em>default field args</em>, <em>model=None</em>, <em>pk_attr='id'</em>, <em>label_attr=''</em>, <em>allow_blank=False</em>, <em>blank_text=u''</em><big>)</big><a class="headerlink" href="#wtforms.ext.sqlalchemy.fields.ModelSelectField" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to QuerySelectField, only for model classes.</p>
<p>Using this field is only meaningful when using scoped sessions in
SQLAlchemy, because otherwise model instances do not know how to make
queries of themselves. This field is simply a convenience for using
<cite>Model.query</cite> as the factory for QuerySelectField.</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Extensions</a><ul>
<li><a class="reference external" href="#module-wtforms.ext.django">Django</a><ul>
<li><a class="reference external" href="#module-wtforms.ext.django.templatetags.wtforms">Templatetags</a></li>
<li><a class="reference external" href="#module-wtforms.ext.django.orm">Model forms</a></li>
<li><a class="reference external" href="#module-wtforms.ext.django.fields">ORM-backed fields</a></li>
</ul>
</li>
<li><a class="reference external" href="#module-wtforms.ext.sqlalchemy">SQLAlchemy</a><ul>
<li><a class="reference external" href="#module-wtforms.ext.sqlalchemy.fields">ORM-backed fields</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="widgets.html"
                                  title="previous chapter">Widgets</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/ext.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="widgets.html" title="Widgets"
             >previous</a> |</li>
        <li><a href="index.html">WTForms v0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009 by Thomas Johansson, James Crasta.
      Last updated on Oct 10, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>