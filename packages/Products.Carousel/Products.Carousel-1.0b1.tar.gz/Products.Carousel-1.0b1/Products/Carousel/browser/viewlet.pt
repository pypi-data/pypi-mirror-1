<div id="carousel"
     tal:define="folder python:context.aq_explicit.isPrincipiaFolderish and context or context.aq_parent;
                 banners python:[o.getObject() for o in here.portal_catalog(portal_type='Carousel Banner', path='/'.join(folder.getPhysicalPath()) + '/carousel', sort_on='getObjPositionInParent')]"
     tal:condition="banners">

    <div id="carousel-banners"
        tal:define="size python:banners[0].getField('image').getSize(banners[0]);
                    height python:size[1];
                    width python:size[0]"
        tal:attributes="style string:width: ${width}px;; height: ${height}px;;">
      <tal:image_loop repeat="banner banners">
        <a tal:attributes="href banner/getRemoteUrl;
                           id string:carousel-banner-${repeat/banner/index};
                           class python:repeat['banner'].start and 'carousel-banner selected' or 'carousel-banner';
                           style python:repeat['banner'].start and 'display: block' or 'display: none';
                           title banner/Title;">
            <img tal:replace="structure python:banner.getField('image').tag(banner)"/>
        </a>
      </tal:image_loop>
    </div>
    
    <div id="carousel-titles">

        <a tal:repeat="banner banners"
           tal:content="banner/Title"
           tal:attributes="class python:repeat['banner'].start and 'carousel-title selected' or 'carousel-title';
                           href banner/getRemoteUrl;
                           id string:carousel-title-${repeat/banner/index};
                           onclick string:jq('.carousel-banner:not(#carousel-banner-${repeat/banner/index})').fadeOut(300);;jq('#carousel-banner-${repeat/banner/index}').fadeIn(300);;jq('.carousel-title.selected').removeClass('selected');;jq(this).addClass('selected');;return false;;">[Title]</a>

    </div>
    
    <div style="clear:both;"></div>
</div>
