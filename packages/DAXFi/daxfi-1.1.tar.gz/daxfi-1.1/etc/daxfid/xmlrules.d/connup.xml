<?xml version="1.0"?>

<!DOCTYPE ruleset SYSTEM "../dtd.d/daxfifw_0.5.dtd">

<?daxfi-process only-for="iptables,ipfilter"?>

<!-- Accept traffic over the high ports. -->

<!-- Drop and log new or invalid connections from the outside. -->
<append>
  <rule
	direction="in"
	source-ip="%REMOTE_IP"
	destination-ip="%LOCAL_IP">
    <tcp state="new" />
    <drop />
    <limit rate="1/s" burst="10" />
    <log />
  </rule>

  <!-- Accept traffic over high ports RELATED to an existing connection,
       so that ftp passive mode works.  Also accept packets in an ESTABLISHED
       connection. -->
  <rule
	direction="in"
	source-ip="%REMOTE_IP"
	destination-ip="%LOCAL_IP">
    <tcp destination-port="1024:65535" state="related" />
    <accept />
  </rule>

  <!-- Do the same, for udp. -->
  <rule
	direction="in"
	source-ip="%REMOTE_IP"
	destination-ip="%LOCAL_IP">
    <udp destination-port="1024:65535" state="related" />
    <accept />
  </rule>
</append>

