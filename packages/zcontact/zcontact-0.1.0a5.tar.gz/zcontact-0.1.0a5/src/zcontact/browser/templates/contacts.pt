<div id="result-wrapper">
  <div tal:repeat="contact view/contacts"
       class="search-result-item"
       tal:attributes="name string:${contact/@@absolute_url}/@@inline.html;
		       id string:search-item-${repeat/contact/index}">
    <div class="top-row">
      <noscript>
	<a tal:attributes="href contact/@@absolute_url"
	   tal:content="contact/title" />
      </noscript>
      <span tal:content="structure contact/@@listwidget|contact/title">Title</span>
      <img class="processing" style="display: none;"
	   tal:attributes="src context/++resource++processing.gif" />
    </div>
    <div class="content-row">
    </div>
  </div>
</div>
<script type="text/javascript">
  $("#result-wrapper div.search-result-item:even").addClass("evenRow");
  $("#result-wrapper div.search-result-item:odd").addClass("oddRow");
  $("#result-wrapper .content-row").hide();
  $("#result-wrapper .processing").hide();
  $.each($("#result-wrapper div.search-result-item"),
    function(i, val){
      $(val).find(".top-row").click(
          function(){
  	     var container = $("#search-item-"+i+" .content-row");
	     var processing = $("#search-item-"+i+" .processing");
	     processing.show()
	     if (container.children().size() == 0){
               $.get($("#search-item-"+i).attr("name"),
	            function(data){
		        container.html(data);
			container.slideDown();
			processing.hide()
		    }
		    );
             }
	     else {
	       container.slideUp("normal", function(){container.children().remove();});
	       processing.hide();
	     }
          });
    });

</script>
