<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>routes – Routes module &mdash; Routes v1.11 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.11',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Routes v1.11 documentation"
          href="_static/opensearch.xml"/>
    <link rel="top" title="Routes v1.11 documentation" href="index.html" />
    <link rel="prev" title="Porting Routes to a WSGI Web Framework" href="porting.html" /> 
  </head>
  <body>
<div style="color: #D1361B; font-size: 70px; font-weight: bold; padding: 10px 0 0 10px;">Routes</div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="porting.html" title="Porting Routes to a WSGI Web Framework"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Routes home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>&raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-routes">
<h1><tt class="xref docutils literal"><span class="pre">routes</span></tt> &#8211; Routes module<a class="headerlink" href="#module-routes" title="Permalink to this headline">¶</a></h1>
<p>Provides common classes and functions most users will want access to.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="routes.request_config">
<tt class="descclassname">routes.</tt><tt class="descname">request_config</tt><big>(</big><em>original=False</em><big>)</big><a class="headerlink" href="#routes.request_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Routes RequestConfig object.</p>
<p>To get the Routes RequestConfig:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">routes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">request_config</span><span class="p">()</span>
</pre></div>
</div>
<p>The following attributes must be set on the config object every request:</p>
<dl class="docutils">
<dt>mapper</dt>
<dd>mapper should be a Mapper instance thats ready for use</dd>
<dt>host</dt>
<dd>host is the hostname of the webapp</dd>
<dt>protocol</dt>
<dd>protocol is the protocol of the current request</dd>
<dt>mapper_dict</dt>
<dd>mapper_dict should be the dict returned by mapper.match()</dd>
<dt>redirect</dt>
<dd>redirect should be a function that issues a redirect, 
and takes a url as the sole argument</dd>
<dt>prefix (optional)</dt>
<dd>Set if the application is moved under a URL prefix. Prefix
will be stripped before matching, and prepended on generation</dd>
<dt>environ (optional)</dt>
<dd><p class="first">Set to the WSGI environ for automatic prefix support if the
webapp is underneath a &#8216;SCRIPT_NAME&#8217;</p>
<p class="last">Setting the environ will use information in environ to try and
populate the host/protocol/mapper_dict options if you&#8217;ve already
set a mapper.</p>
</dd>
</dl>
<p><strong>Using your own requst local</strong></p>
<p>If you have your own request local object that you&#8217;d like to use instead 
of the default thread local provided by Routes, you can configure Routes 
to use it:</p>
<div class="highlight-python"><pre>from routes import request_config()
config = request_config()
if hasattr(config, 'using_request_local'):
    config.request_local = YourLocalCallable
    config = request_config()</pre>
</div>
<p>Once you have configured request_config, its advisable you retrieve it 
again to get the object you wanted. The variable you assign to 
request_local is assumed to be a callable that will get the local config 
object you wish.</p>
<p>This example tests for the presence of the &#8216;using_request_local&#8217; attribute
which will be present if you haven&#8217;t assigned it yet. This way you can 
avoid repeat assignments of the request specific callable.</p>
<p>Should you want the original object, perhaps to change the callable its 
using or stop this behavior, call request_config(original=True).</p>
</dd></dl>

<dl class="class">
<dt id="routes.Mapper">
<em class="property">
class </em><tt class="descclassname">routes.</tt><tt class="descname">Mapper</tt><big>(</big><em>controller_scan=&lt;function controller_scan at 0x101d88b90&gt;</em>, <em>directory=None</em>, <em>always_scan=False</em>, <em>register=True</em>, <em>explicit=False</em><big>)</big><a class="headerlink" href="#routes.Mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapper handles URL generation and URL recognition in a web
application.</p>
<p>Mapper is built handling dictionary&#8217;s. It is assumed that the web
application will handle the dictionary returned by URL recognition
to dispatch appropriately.</p>
<p>URL generation is done by passing keyword parameters into the
generate function, a URL is then returned.</p>
<p>Create a new Mapper instance</p>
<p>All keyword arguments are optional.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">controller_scan</span></tt></dt>
<dd><p class="first">Function reference that will be used to return a list of
valid controllers used during URL matching. If
<tt class="docutils literal"><span class="pre">directory</span></tt> keyword arg is present, it will be passed
into the function during its call. This option defaults to
a function that will scan a directory for controllers.</p>
<p class="last">Alternatively, a list of controllers or None can be passed
in which are assumed to be the definitive list of
controller names valid when matching &#8216;controller&#8217;.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">directory</span></tt></dt>
<dd>Passed into controller_scan for the directory to scan. It
should be an absolute path if using the default 
<tt class="docutils literal"><span class="pre">controller_scan</span></tt> function.</dd>
<dt><tt class="docutils literal"><span class="pre">always_scan</span></tt></dt>
<dd>Whether or not the <tt class="docutils literal"><span class="pre">controller_scan</span></tt> function should be
run during every URL match. This is typically a good idea
during development so the server won&#8217;t need to be restarted
anytime a controller is added.</dd>
<dt><tt class="docutils literal"><span class="pre">register</span></tt></dt>
<dd>Boolean used to determine if the Mapper should use 
<tt class="docutils literal"><span class="pre">request_config</span></tt> to register itself as the mapper. Since
it&#8217;s done on a thread-local basis, this is typically best
used during testing though it won&#8217;t hurt in other cases.</dd>
<dt><tt class="docutils literal"><span class="pre">explicit</span></tt></dt>
<dd><p class="first">Boolean used to determine if routes should be connected
with implicit defaults of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;controller&#39;</span><span class="p">:</span><span class="s">&#39;content&#39;</span><span class="p">,</span><span class="s">&#39;action&#39;</span><span class="p">:</span><span class="s">&#39;index&#39;</span><span class="p">,</span><span class="s">&#39;id&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
</pre></div>
</div>
<p class="last">When set to True, these defaults will not be added to route
connections and <tt class="docutils literal"><span class="pre">url_for</span></tt> will not use Route memory.</p>
</dd>
</dl>
<p>Additional attributes that may be set after mapper
initialization (ie, map.ATTRIBUTE = &#8216;something&#8217;):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">encoding</span></tt></dt>
<dd>Used to indicate alternative encoding/decoding systems to
use with both incoming URL&#8217;s, and during Route generation
when passed a Unicode string. Defaults to &#8216;utf-8&#8217;.</dd>
<dt><tt class="docutils literal"><span class="pre">decode_errors</span></tt></dt>
<dd>How to handle errors in the encoding, generally ignoring
any chars that don&#8217;t convert should be sufficient. Defaults
to &#8216;ignore&#8217;.</dd>
<dt><tt class="docutils literal"><span class="pre">minimization</span></tt></dt>
<dd>Boolean used to indicate whether or not Routes should
minimize URL&#8217;s and the generated URL&#8217;s, or require every
part where it appears in the path. Defaults to True.</dd>
<dt><tt class="docutils literal"><span class="pre">hardcode_names</span></tt></dt>
<dd>Whether or not Named Routes result in the default options
for the route being used <em>or</em> if they actually force url
generation to use the route. Defaults to False.</dd>
</dl>
<dl class="method">
<dt id="routes.Mapper.connect">
<tt class="descname">connect</tt><big>(</big><em>*args</em>, <em>**kargs</em><big>)</big><a class="headerlink" href="#routes.Mapper.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and connect a new Route to the Mapper.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;:controller/:action/:id&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;date/:year/:month/:day&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&quot;blog&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;view&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;archives/:page&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&quot;blog&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;by_page&quot;</span><span class="p">,</span>
<span class="n">requirements</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;page&#39;</span><span class="p">:</span><span class="s">&#39;\d{1,2}&#39;</span> <span class="p">})</span>
<span class="n">m</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;category_list&#39;</span><span class="p">,</span> <span class="s">&#39;archives/category/:section&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;category&#39;</span><span class="p">,</span>
<span class="n">section</span><span class="o">=</span><span class="s">&#39;home&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;list&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;home&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;view&#39;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="s">&#39;home&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="routes.Mapper.create_regs">
<tt class="descname">create_regs</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#routes.Mapper.create_regs" title="Permalink to this definition">¶</a></dt>
<dd>Atomically creates regular expressions for all connected
routes</dd></dl>

<dl class="method">
<dt id="routes.Mapper.generate">
<tt class="descname">generate</tt><big>(</big><em>*args</em>, <em>**kargs</em><big>)</big><a class="headerlink" href="#routes.Mapper.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a route from a set of keywords</p>
<p>Returns the url text, or None if no URL could be generated.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">controller</span><span class="o">=</span><span class="s">&#39;content&#39;</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s">&#39;view&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="routes.Mapper.match">
<tt class="descname">match</tt><big>(</big><em>url</em><big>)</big><a class="headerlink" href="#routes.Mapper.match" title="Permalink to this definition">¶</a></dt>
<dd><p>Match a URL against against one of the routes contained.</p>
<p>Will return None if no valid match is found.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">resultdict</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;/joe/sixpack&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="routes.Mapper.redirect">
<tt class="descname">redirect</tt><big>(</big><em>match_path</em>, <em>destination_path</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#routes.Mapper.redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a redirect route to the mapper</p>
<p>Redirect routes bypass the wrapped WSGI application and instead
result in a redirect being issued by the RoutesMiddleware. As
such, this method is only meaningful when using
RoutesMiddleware.</p>
<p>By default, a 302 Found status code is used, this can be
changed by providing a <tt class="docutils literal"><span class="pre">_redirect_code</span></tt> keyword argument
which will then be used instead. Note that the entire status
code string needs to be present.</p>
<p>When using keyword arguments, all arguments that apply to
matching will be used for the match, while generation specific
options will be used during generation. Thus all options
normally available to connected Routes may be used with
redirect routes as well.</p>
<p>Example:</p>
<div class="highlight-python"><pre>map = Mapper()
map.redirect('/legacyapp/archives/{url:.*}, '/archives/{url})
map.redirect('/home/index', '/', _redirect_code='301 Moved Permanently')</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="routes.Mapper.resource">
<tt class="descname">resource</tt><big>(</big><em>member_name</em>, <em>collection_name</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#routes.Mapper.resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate routes for a controller resource</p>
<p>The member_name name should be the appropriate singular version
of the resource given your locale and used with members of the
collection. The collection_name name will be used to refer to
the resource collection methods and should be a plural version
of the member_name argument. By default, the member_name name
will also be assumed to map to a controller you create.</p>
<p>The concept of a web resource maps somewhat directly to &#8216;CRUD&#8217; 
operations. The overlying things to keep in mind is that
mapping a resource is about handling creating, viewing, and
editing that resource.</p>
<p>All keyword arguments are optional.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">controller</span></tt></dt>
<dd>If specified in the keyword args, the controller will be
the actual controller used, but the rest of the naming
conventions used for the route names and URL paths are
unchanged.</dd>
<dt><tt class="docutils literal"><span class="pre">collection</span></tt></dt>
<dd><p class="first">Additional action mappings used to manipulate/view the
entire set of resources provided by the controller.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;message&#39;</span><span class="p">,</span> <span class="s">&#39;messages&#39;</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;rss&#39;</span><span class="p">:</span><span class="s">&#39;GET&#39;</span><span class="p">})</span>
<span class="c"># GET /message/rss (maps to the rss action)</span>
<span class="c"># also adds named route &quot;rss_message&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">member</span></tt></dt>
<dd><p class="first">Additional action mappings used to access an individual
&#8216;member&#8217; of this controllers resources.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;message&#39;</span><span class="p">,</span> <span class="s">&#39;messages&#39;</span><span class="p">,</span> <span class="n">member</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;mark&#39;</span><span class="p">:</span><span class="s">&#39;POST&#39;</span><span class="p">})</span>
<span class="c"># POST /message/1/mark (maps to the mark action)</span>
<span class="c"># also adds named route &quot;mark_message&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">new</span></tt></dt>
<dd><p class="first">Action mappings that involve dealing with a new member in
the controller resources.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;message&#39;</span><span class="p">,</span> <span class="s">&#39;messages&#39;</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;preview&#39;</span><span class="p">:</span><span class="s">&#39;POST&#39;</span><span class="p">})</span>
<span class="c"># POST /message/new/preview (maps to the preview action)</span>
<span class="c"># also adds a url named &quot;preview_new_message&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">path_prefix</span></tt></dt>
<dd>Prepends the URL path for the Route with the path_prefix
given. This is most useful for cases where you want to mix
resources or relations between resources.</dd>
<dt><tt class="docutils literal"><span class="pre">name_prefix</span></tt></dt>
<dd><p class="first">Perpends the route names that are generated with the
name_prefix given. Combined with the path_prefix option,
it&#8217;s easy to generate route names and paths that represent
resources that are in relations.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;message&#39;</span><span class="p">,</span> <span class="s">&#39;messages&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;categories&#39;</span><span class="p">,</span> 
    <span class="n">path_prefix</span><span class="o">=</span><span class="s">&#39;/category/:category_id&#39;</span><span class="p">,</span> 
    <span class="n">name_prefix</span><span class="o">=</span><span class="s">&quot;category_&quot;</span><span class="p">)</span>
<span class="c"># GET /category/7/message/1</span>
<span class="c"># has named route &quot;category_message&quot;</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">parent_resource</span></tt> </dt>
<dd><p class="first">A <tt class="docutils literal"><span class="pre">dict</span></tt> containing information about the parent
resource, for creating a nested resource. It should contain
the <tt class="docutils literal"><span class="pre">member_name</span></tt> and <tt class="docutils literal"><span class="pre">collection_name</span></tt> of the parent
resource. This <tt class="docutils literal"><span class="pre">dict</span></tt> will 
be available via the associated <tt class="docutils literal"><span class="pre">Route</span></tt> object which can
be accessed during a request via
<tt class="docutils literal"><span class="pre">request.environ['routes.route']</span></tt></p>
<p>If <tt class="docutils literal"><span class="pre">parent_resource</span></tt> is supplied and <tt class="docutils literal"><span class="pre">path_prefix</span></tt>
isn&#8217;t, <tt class="docutils literal"><span class="pre">path_prefix</span></tt> will be generated from
<tt class="docutils literal"><span class="pre">parent_resource</span></tt> as
&#8220;&lt;parent collection name&gt;/:&lt;parent member name&gt;_id&#8221;.</p>
<p>If <tt class="docutils literal"><span class="pre">parent_resource</span></tt> is supplied and <tt class="docutils literal"><span class="pre">name_prefix</span></tt>
isn&#8217;t, <tt class="docutils literal"><span class="pre">name_prefix</span></tt> will be generated from
<tt class="docutils literal"><span class="pre">parent_resource</span></tt> as  &#8220;&lt;parent member name&gt;_&#8221;.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">routes.util</span> <span class="kn">import</span> <span class="n">url_for</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">()</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;location&#39;</span><span class="p">,</span> <span class="s">&#39;locations&#39;</span><span class="p">,</span> 
<span class="gp">... </span>           <span class="n">parent_resource</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">member_name</span><span class="o">=</span><span class="s">&#39;region&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                                <span class="n">collection_name</span><span class="o">=</span><span class="s">&#39;regions&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># path_prefix is &quot;regions/:region_id&quot; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># name prefix is &quot;region_&quot;  </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;region_locations&#39;</span><span class="p">,</span> <span class="n">region_id</span><span class="o">=</span><span class="mf">13</span><span class="p">)</span> 
<span class="go">&#39;/regions/13/locations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;region_new_location&#39;</span><span class="p">,</span> <span class="n">region_id</span><span class="o">=</span><span class="mf">13</span><span class="p">)</span> 
<span class="go">&#39;/regions/13/locations/new&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;region_location&#39;</span><span class="p">,</span> <span class="n">region_id</span><span class="o">=</span><span class="mf">13</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mf">60</span><span class="p">)</span> 
<span class="go">&#39;/regions/13/locations/60&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;region_edit_location&#39;</span><span class="p">,</span> <span class="n">region_id</span><span class="o">=</span><span class="mf">13</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mf">60</span><span class="p">)</span> 
<span class="go">&#39;/regions/13/locations/60/edit&#39;</span>
</pre></div>
</div>
<p>Overriding generated <tt class="docutils literal"><span class="pre">path_prefix</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;location&#39;</span><span class="p">,</span> <span class="s">&#39;locations&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">parent_resource</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">member_name</span><span class="o">=</span><span class="s">&#39;region&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">collection_name</span><span class="o">=</span><span class="s">&#39;regions&#39;</span><span class="p">),</span>
<span class="gp">... </span>           <span class="n">path_prefix</span><span class="o">=</span><span class="s">&#39;areas/:area_id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># name prefix is &quot;region_&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;region_locations&#39;</span><span class="p">,</span> <span class="n">area_id</span><span class="o">=</span><span class="mf">51</span><span class="p">)</span>
<span class="go">&#39;/areas/51/locations&#39;</span>
</pre></div>
</div>
<p>Overriding generated <tt class="docutils literal"><span class="pre">name_prefix</span></tt>:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;location&#39;</span><span class="p">,</span> <span class="s">&#39;locations&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">parent_resource</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">member_name</span><span class="o">=</span><span class="s">&#39;region&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">collection_name</span><span class="o">=</span><span class="s">&#39;regions&#39;</span><span class="p">),</span>
<span class="gp">... </span>           <span class="n">name_prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># path_prefix is &quot;regions/:region_id&quot; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;locations&#39;</span><span class="p">,</span> <span class="n">region_id</span><span class="o">=</span><span class="mf">51</span><span class="p">)</span>
<span class="go">&#39;/regions/51/locations&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="routes.Mapper.routematch">
<tt class="descname">routematch</tt><big>(</big><em>url</em><big>)</big><a class="headerlink" href="#routes.Mapper.routematch" title="Permalink to this definition">¶</a></dt>
<dd><p>Match a URL against against one of the routes contained.</p>
<p>Will return None if no valid match is found, otherwise a
result dict and a route object is returned.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">resultdict</span><span class="p">,</span> <span class="n">route_obj</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;/joe/sixpack&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="routes.URLGenerator">
<em class="property">
class </em><tt class="descclassname">routes.</tt><tt class="descname">URLGenerator</tt><big>(</big><em>mapper</em>, <em>environ</em><big>)</big><a class="headerlink" href="#routes.URLGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL Generator generates URL&#8217;s</p>
<p>It is automatically instantiated by the RoutesMiddleware and put
into the <tt class="docutils literal"><span class="pre">wsgiorg.routing_args</span></tt> tuple accessible as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">environ</span><span class="p">[</span><span class="s">&#39;wsgiorg.routing_args&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Or via the <tt class="docutils literal"><span class="pre">routes.url</span></tt> key:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">environ</span><span class="p">[</span><span class="s">&#39;routes.url&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The url object may be instantiated outside of a web context for use
in testing, however sub_domain support and fully qualified URL&#8217;s
cannot be generated without supplying a dict that must contain the
key <tt class="docutils literal"><span class="pre">HTTP_HOST</span></tt>.</p>
<p>Instantiate the URLGenerator</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">mapper</span></tt></dt>
<dd>The mapper object to use when generating routes.</dd>
<dt><tt class="docutils literal"><span class="pre">environ</span></tt></dt>
<dd>The environment dict used in WSGI, alternately, any dict
that contains at least an <tt class="docutils literal"><span class="pre">HTTP_HOST</span></tt> value.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="routes.url_for">
<tt class="descclassname">routes.</tt><tt class="descname">url_for</tt><big>(</big><em>*args</em>, <em>**kargs</em><big>)</big><a class="headerlink" href="#routes.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a URL</p>
<p>All keys given to url_for are sent to the Routes Mapper instance for 
generation except for:</p>
<div class="highlight-python"><pre>anchor          specified the anchor name to be appened to the path
host            overrides the default (current) host if provided
protocol        overrides the default (current) protocol if provided
qualified       creates the URL with the host/port information as 
                needed</pre>
</div>
<p>The URL is generated based on the rest of the keys. When generating a new 
URL, values will be used from the current request&#8217;s parameters (if 
present). The following rules are used to determine when and how to keep 
the current requests parameters:</p>
<ul class="simple">
<li>If the controller is present and begins with &#8216;/&#8217;, no defaults are used</li>
<li>If the controller is changed, action is set to &#8216;index&#8217; unless otherwise 
specified</li>
</ul>
<p>For example, if the current request yielded a dict of
{&#8216;controller&#8217;: &#8216;blog&#8217;, &#8216;action&#8217;: &#8216;view&#8217;, &#8216;id&#8217;: 2}, with the standard 
&#8216;:controller/:action/:id&#8217; route, you&#8217;d get the following results:</p>
<div class="highlight-python"><pre>url_for(id=4)                    =&gt;  '/blog/view/4',
url_for(controller='/admin')     =&gt;  '/admin',
url_for(controller='admin')      =&gt;  '/admin/view/2'
url_for(action='edit')           =&gt;  '/blog/edit/2',
url_for(action='list', id=None)  =&gt;  '/blog/list'</pre>
</div>
<p><strong>Static and Named Routes</strong></p>
<p>If there is a string present as the first argument, a lookup is done 
against the named routes table to see if there&#8217;s any matching routes. The
keyword defaults used with static routes will be sent in as GET query 
arg&#8217;s if a route matches.</p>
<p>If no route by that name is found, the string is assumed to be a raw URL. 
Should the raw URL begin with <tt class="docutils literal"><span class="pre">/</span></tt> then appropriate SCRIPT_NAME data will
be added if present, otherwise the string will be used as the url with 
keyword args becoming GET query args.</p>
</dd></dl>

<dl class="function">
<dt id="routes.redirect_to">
<tt class="descclassname">routes.</tt><tt class="descname">redirect_to</tt><big>(</big><em>*args</em>, <em>**kargs</em><big>)</big><a class="headerlink" href="#routes.redirect_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Issues a redirect based on the arguments.</p>
<p>Redirect&#8217;s <em>should</em> occur as a &#8220;302 Moved&#8221; header, however the web 
framework may utilize a different method.</p>
<p>All arguments are passed to url_for to retrieve the appropriate URL, then
the resulting URL it sent to the redirect function as the URL.</p>
</dd></dl>

<dl class="function">
<dt id="routes.mapper.strip_slashes">
<tt class="descclassname">routes.mapper.</tt><tt class="descname">strip_slashes</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#routes.mapper.strip_slashes" title="Permalink to this definition">¶</a></dt>
<dd>Remove slashes from the beginning and end of a part/URL.</dd></dl>

<dl class="class">
<dt id="routes.middleware.RoutesMiddleware">
<em class="property">
class </em><tt class="descclassname">routes.middleware.</tt><tt class="descname">RoutesMiddleware</tt><big>(</big><em>wsgi_app</em>, <em>mapper</em>, <em>use_method_override=True</em>, <em>path_info=True</em><big>)</big><a class="headerlink" href="#routes.middleware.RoutesMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Routing middleware that handles resolving the PATH_INFO in
addition to optionally recognizing method overriding.</p>
<p>Create a Route middleware object</p>
<p>Using the use_method_override keyword will require Paste to be
installed, and your application should use Paste&#8217;s WSGIRequest
object as it will properly handle POST issues with wsgi.input
should Routes check it.</p>
<p>If path_info is True, then should a route var contain
path_info, the SCRIPT_NAME and PATH_INFO will be altered
accordingly. This should be used with routes like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;blog/*path_info&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">,</span> <span class="n">path_info</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href=""><tt class="docutils literal"><span class="pre">routes</span></tt> &#8211; Routes module</a><ul>
<li><a class="reference external" href="#module-contents">Module Contents</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="porting.html"
                                  title="previous chapter">Porting Routes to a WSGI Web Framework</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/modules.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="porting.html" title="Porting Routes to a WSGI Web Framework"
             >previous</a> |</li>
        <li><a href="index.html">Routes home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>&raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Ben Bangert.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
  </body>
</html>