<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Scripts &mdash; Abjad v1.1.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/ga-1.js"></script>
    <script type="text/javascript" src="../../../_static/ga-2.js"></script>
    <link rel="top" title="Abjad v1.1.1 documentation" href="../../../index.html" />
    <link rel="next" title="To-do" href="../todo/index.html" />
    <link rel="prev" title="Tests" href="../tests/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="../todo/index.html" title="To-do"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../tests/index.html" title="Tests"
             accesskey="P">previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="scripts">
<h1>Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">abjad/scr/devel</span></tt> directory contains scripts for Abjad developers.
Add <tt class="docutils literal"><span class="pre">abjad/scr/devel</span></tt> to your <tt class="docutils literal"><span class="pre">PATH</span></tt> to use the scripts described below.</p>
<div class="highlight-python"><pre>abjad$ ls scr/devel
abj-grep           abj-rmpycs         count-source-lines
abj-grp            abj-update         replace-in-files</pre>
</div>
<div class="section" id="searching-the-abjad-codebase-with-abj-grep">
<h2>Searching the Abjad codebase with <tt class="docutils literal"><span class="pre">abj-grep</span></tt><a class="headerlink" href="#searching-the-abjad-codebase-with-abj-grep" title="Permalink to this headline">¶</a></h2>
<p>Abjad provides a wrapper around UNIX <tt class="docutils literal"><span class="pre">grep</span></tt> in the form of <tt class="docutils literal"><span class="pre">abj-grep</span></tt>.
Use this script to recursively search the entire Abjad codebase, leaving
out non-human-readable files, files located in special <tt class="docutils literal"><span class="pre">.svn</span></tt> Subversion
subdirectories, and all files in the <tt class="docutils literal"><span class="pre">abjad/documentation</span></tt> directories.
You can run <tt class="docutils literal"><span class="pre">abj-grep</span></tt> from any directory on your system; you needn&#8217;t be
in the Abjad source directories when you call <tt class="docutils literal"><span class="pre">abj-grep</span></tt>.</p>
<div class="highlight-python"><pre>$ abj-grep 'is_assignable('

leaf/duration.py:111:         if not durtools.is_assignable(rational):
tempo/indication.py:67:         assert durtools.is_assignable(arg)
tools/check/are_scalable.py:12:         if not durtools.is_assignable(candidate_duration):
tools/durtools/is_assignable.py:5:def is_assignable(duration):
tools/durtools/prolated_to_written.py:2:from abjad.tools.durtools.is_assignable import is_assignable
tools/durtools/prolated_to_written.py:15:   if is_assignable(prolated_duration):
tools/tietools/duration_change.py:28:   if durtools.is_assignable(new_written_duration):
tools/tuplettools/contents_scale.py:30:   if durtools.is_assignable(multiplier):</pre>
</div>
</div>
<div class="section" id="removing-old-pyc-files-with-abj-rmpycs">
<h2>Removing old <tt class="docutils literal"><span class="pre">*.pyc</span></tt> files with <tt class="docutils literal"><span class="pre">abj-rmpycs</span></tt><a class="headerlink" href="#removing-old-pyc-files-with-abj-rmpycs" title="Permalink to this headline">¶</a></h2>
<p>See the section on <tt class="docutils literal"><span class="pre">abj-update</span></tt> below for the reasons that it is a
good idea to periodically remove the byte-compiled <tt class="docutils literal"><span class="pre">*.pyc</span></tt> files that
Python generates for its own use behind the scenes. Abjad supplies
<tt class="docutils literal"><span class="pre">abj-rmpycs</span></tt> to delete all the <tt class="docutils literal"><span class="pre">*.pyc</span></tt> in the Abjad codebase, leaving
other <tt class="docutils literal"><span class="pre">*.pyc</span></tt> on your system untouched.</p>
</div>
<div class="section" id="updating-your-development-copy-of-abjad-with-abj-update">
<h2>Updating your development copy of Abjad with <tt class="docutils literal"><span class="pre">abj-update</span></tt><a class="headerlink" href="#updating-your-development-copy-of-abjad-with-abj-update" title="Permalink to this headline">¶</a></h2>
<p>The normal way of updating your working copy of a Subversion repository
is with the <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">update</span></tt> or <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">up</span></tt> command. You can update
your working copy of Abjad in the usual way with <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">up</span></tt>. But
Abjad supplies an <tt class="docutils literal"><span class="pre">abj-update</span></tt> script as a wrapper around the usual
Subversion update commands. In addition to updating your working copy
of Abjad, <tt class="docutils literal"><span class="pre">abj-update</span></tt> populates the <tt class="docutils literal"><span class="pre">abjad/.version</span></tt> file with
the most recent revision number of the system, and then removes all
<tt class="docutils literal"><span class="pre">*.pyc</span></tt> files from your Abjad install. The benefits here are twofold.
First, Abjad adds the most recent revision number of the system to all
<tt class="docutils literal"><span class="pre">.ly</span></tt> files that you generate when working with Abjad. If you do not
update the Abjad version file on a regular basis, the headers in your
Abjad-generated <tt class="docutils literal"><span class="pre">.ly</span></tt> files will list the wrong version of the system.
Second, as is the case in working with any substantial Python codebase,
it is a good idea to periodically remove the byte-compiled <tt class="docutils literal"><span class="pre">*.pyc</span></tt> files
that Python creates for its own use. The reason for this is inadvertant
name aliasing. That is, if there was previously a module named <tt class="docutils literal"><span class="pre">foo.py</span></tt>
somewhere in the system and if Python had at some point imported the module
and created <tt class="docutils literal"><span class="pre">foo.pyc</span></tt> as a byprodct, this <tt class="docutils literal"><span class="pre">.pyc</span></tt> file will remain on
the filesystem even if you later decide to remove, or rename, the source
<tt class="docutils literal"><span class="pre">foo.py</span></tt> module. This lead to confusion because days or weeks after
<tt class="docutils literal"><span class="pre">foo.py</span></tt> has been removed, Python will still find <tt class="docutils literal"><span class="pre">foo.pyc</span></tt> and seem
to make the contents of <tt class="docutils literal"><span class="pre">foo.py</span></tt> available from beyond the grave.
Updating with <tt class="docutils literal"><span class="pre">abj-update</span></tt> takes care of these two situations.</p>
</div>
<div class="section" id="counting-lines-of-code-with-count-source-lines">
<h2>Counting lines of code with <tt class="docutils literal"><span class="pre">count-source-lines</span></tt><a class="headerlink" href="#counting-lines-of-code-with-count-source-lines" title="Permalink to this headline">¶</a></h2>
<p>Run <tt class="docutils literal"><span class="pre">count-source-lines</span></tt> for a count of lines of count divided between
source and test files.</p>
<div class="highlight-python"><pre>abjad$ count-source-lines

source_modules: 713
test_modules: 580

source_lines: 25899
test_lines: 46111

total lines: 72010
test-to-source ratio is 1.8 : 1</pre>
</div>
<p>The script is directory-dependent so you can run it any the entire Abjad
codebase or any subdirectory of the codebase.</p>
</div>
<div class="section" id="global-search-and-replace-with-replace-in-files">
<h2>Global search-and-replace with <tt class="docutils literal"><span class="pre">replace-in-files</span></tt><a class="headerlink" href="#global-search-and-replace-with-replace-in-files" title="Permalink to this headline">¶</a></h2>
<p>You probably won&#8217;t need to use <tt class="docutils literal"><span class="pre">replace-in-files</span></tt> very often.
But if you are making changes to Abjad that will cause some name,
such as <tt class="docutils literal"><span class="pre">FooBar</span></tt>, to be globally changed everywhere in the Abjad
codebase to, say to <tt class="docutils literal"><span class="pre">foo_bar</span></tt>, then you can use <tt class="docutils literal"><span class="pre">replace-in-files</span></tt>
to save lots of time.</p>
<div class="highlight-python"><pre>$ replace-in-files --help

     Usage:

     replace-in-files DIR OLD_TEXT NEW_TEXT [CONFIRM=true/false]

     Crawl directory DIR and read every file in it recursively.
     Replace OLD_TEXT with NEW_TEXT in each file.

     Set CONFIRM to `false` to replace without prompting.</pre>
</div>
</div>
<div class="section" id="adding-new-development-scripts">
<h2>Adding new development scripts<a class="headerlink" href="#adding-new-development-scripts" title="Permalink to this headline">¶</a></h2>
<p>If you write and then find yourself using a certain script over and over
again when you&#8217;re developing new code for Abjad, consider contributing
back to the project so we can include your script in the next public
release of Abjad. Scripts in the the Abjad script directories end with
no file extension and try to be as OS-portable as possible, which
usually means writing the script in Python, rather than your operating
system&#8217;s shell, and relying heavily on Python&#8217;s <tt class="docutils literal"><span class="pre">os</span></tt> module.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Scripts</a><ul>
<li><a class="reference external" href="#searching-the-abjad-codebase-with-abj-grep">Searching the Abjad codebase with <tt class="docutils literal"><span class="pre">abj-grep</span></tt></a></li>
<li><a class="reference external" href="#removing-old-pyc-files-with-abj-rmpycs">Removing old <tt class="docutils literal"><span class="pre">*.pyc</span></tt> files with <tt class="docutils literal"><span class="pre">abj-rmpycs</span></tt></a></li>
<li><a class="reference external" href="#updating-your-development-copy-of-abjad-with-abj-update">Updating your development copy of Abjad with <tt class="docutils literal"><span class="pre">abj-update</span></tt></a></li>
<li><a class="reference external" href="#counting-lines-of-code-with-count-source-lines">Counting lines of code with <tt class="docutils literal"><span class="pre">count-source-lines</span></tt></a></li>
<li><a class="reference external" href="#global-search-and-replace-with-replace-in-files">Global search-and-replace with <tt class="docutils literal"><span class="pre">replace-in-files</span></tt></a></li>
<li><a class="reference external" href="#adding-new-development-scripts">Adding new development scripts</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../tests/index.html"
                                  title="previous chapter">Tests</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../todo/index.html"
                                  title="next chapter">To-do</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/chapters/devel/scripts/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../todo/index.html" title="To-do"
             >next</a> |</li>
        <li class="right" >
          <a href="../tests/index.html" title="Tests"
             >previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Víctor Adán, Trevor Bača.
      Last updated on Aug 05, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>