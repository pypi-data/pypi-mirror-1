<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Bartók’s Wandering &mdash; Abjad v1.1.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/ga-1.js"></script>
    <script type="text/javascript" src="../../../../_static/ga-2.js"></script>
    <link rel="top" title="Abjad v1.1.1 documentation" href="../../../../index.html" />
    <link rel="next" title="Example: metric grid" href="../slicing/index.html" />
    <link rel="prev" title="Abjad?" href="../../abjad/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="../slicing/index.html" title="Example: metric grid"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../abjad/index.html" title="Abjad?"
             accesskey="P">previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="bart-k-s-wandering">
<h1>Bartók&#8217;s <em>Wandering</em><a class="headerlink" href="#bart-k-s-wandering" title="Permalink to this headline">¶</a></h1>
<p>This example reconstructs the last five measures of Bartók&#8217;s <em>Wandering</em> from Mikrokosmos vol. III.  It demonstrates the use of many of the main classes in Abjad. The end result is just a few measures long, but the example covert most of the basic features you&#8217;ll usually need.</p>
<p>Here is what we want to end up with:</p>
<img alt="../../../../_images/bartok_final.png" src="../../../../_images/bartok_final.png" />
<p>Keep that image in mind as you go through this example.</p>
<p>We will construct the fragment <cite>top-down</cite>, going from the high level containers to the details. We could have done it the other way around, but it will be easier to keep the big picture in mind this way. We encourage you to try rebuilding the example <cite>bottom-down</cite> as an exercise.
First let&#8217;s create the high level framework of the score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">piano</span> <span class="o">=</span> <span class="n">PianoStaff</span><span class="p">([</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_staff</span> <span class="o">=</span> <span class="n">Staff</span><span class="p">([</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_staff</span> <span class="o">=</span> <span class="n">Staff</span><span class="p">([</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">piano</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper_staff</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">piano</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower_staff</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we created an empty <tt class="xref docutils literal"><span class="pre">PianoStaff</span></tt> container and we&#8217;ve assigned it to the <cite>piano</cite> variable. Then we created two <a title="abjad.Staff" class="reference external" href="../../../api/staff/staff.html#abjad.Staff"><tt class="xref docutils literal"><span class="pre">Staff</span></tt></a> objects and we assigned them to the <cite>upper_staff</cite> and <cite>lower_staff</cite> variables. Finally, we appended the staves to the <tt class="xref docutils literal"><span class="pre">PianoStaff</span></tt> container.</p>
<p>Now let&#8217;s add some measures to the framework.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">RigidMeasure</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">[</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">RigidMeasure</span><span class="p">((</span><span class="mf">3</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">[</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">m3</span> <span class="o">=</span> <span class="n">RigidMeasure</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">[</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">m4</span> <span class="o">=</span> <span class="n">RigidMeasure</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">[</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">m5</span> <span class="o">=</span> <span class="n">RigidMeasure</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">[</span> <span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span> <span class="o">=</span> <span class="p">[</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">,</span> <span class="n">m4</span><span class="p">,</span> <span class="n">m5</span><span class="p">]</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span> <span class="o">=</span> <span class="n">clone</span><span class="o">.</span><span class="n">covered</span><span class="p">(</span><span class="n">upper_measures</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_staff</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">upper_measures</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_staff</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lower_measures</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that the <cite>lower_measures</cite> are simply copies of the <cite>upper_measures</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="xref docutils literal"><span class="pre">clone</span></tt> package houses the different copying functions that Abjad provides for object duplication. The difference between them resides in the way each handles spanners attached to Components during the duplication process. See XXX for details.</p>
</div>
<p>Notice also that the measures are added to their corresponding <a title="abjad.Staff" class="reference external" href="../../../api/staff/staff.html#abjad.Staff"><tt class="xref docutils literal"><span class="pre">Staff</span></tt></a> via the <tt class="docutils literal"><span class="pre">extend</span></tt> method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that <tt class="docutils literal"><span class="pre">extend</span></tt> is used for appending multiple objects that are grouped together in an iterable (i.e. a list, tuple, set, etc.) while <tt class="docutils literal"><span class="pre">append</span></tt> is used for single objects.</p>
</div>
<p>Now lets actually start adding some notes. Let&#8217;s begin with the upper staff:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Note</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">9</span><span class="p">,</span> <span class="mf">7</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">4</span><span class="p">]])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">construct</span><span class="o">.</span><span class="n">notes</span><span class="p">([</span><span class="mf">2</span><span class="p">,</span><span class="mf">7</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">)]</span><span class="o">+</span><span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">)]</span><span class="o">*</span><span class="mf">4</span><span class="p">))</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">notes</span> <span class="o">=</span> <span class="n">construct</span><span class="o">.</span><span class="n">notes</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">4</span><span class="p">],</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">)])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Note</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)))</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Note</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Let&#8217;s now create the notes for the lower staff. This will be a more intricate process that that needed for the upper staff. Notice that, for the upper staff, we simply added notes directly to the measures. This will not be possible for the lower staff due to the parallel <cite>threads</cite> (voices or melodic lines) found in the last two measures.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The usual term for a melodic line is <cite>voice</cite>. Generally speaking, the language developed in Abjad uses the term <em>thread</em> to refer to this notion. A <cite>thread</cite> however, has a more concrete interpretation in Abjad. Please refer to the <a class="reference external" href="../../../fundamentals/threads/index.html"><em>Threads</em></a> section for a complete explanation of <cite>threads</cite>.
The term Voice (with upper case) we use specifically for either the <a title="abjad.Voice" class="reference external" href="../../../api/voice/voice.html#abjad.Voice"><tt class="xref docutils literal"><span class="pre">Voice</span></tt></a> class or an instance of the class.</p>
</div>
<p>When two or more melodic lines are simultaneously present in the same <a title="abjad.Staff" class="reference external" href="../../../api/staff/staff.html#abjad.Staff"><tt class="xref docutils literal"><span class="pre">Staff</span></tt></a>, we need some way of grouping notes to disambiguate the paths of the possible melodic lines. We do this by creating explicit threads via the instantiation of the <a title="abjad.Voice" class="reference external" href="../../../api/voice/voice.html#abjad.Voice"><tt class="xref docutils literal"><span class="pre">Voice</span></tt></a> class. Here we create two threads: one called <cite>main_voice</cite> the other called <cite>appendix_voice</cite>. The threads are made explicit by instantiating <a title="abjad.Voice" class="reference external" href="../../../api/voice/voice.html#abjad.Voice"><tt class="xref docutils literal"><span class="pre">Voice</span></tt></a> classes and by naming them appropriately.</p>
<p>Lets move measure by measure in the construction of the lower staff:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m1</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">(</span><span class="n">construct</span><span class="o">.</span><span class="n">notes</span><span class="p">([</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">)]))</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;main_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_voice_m1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m2</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">(</span><span class="n">construct</span><span class="o">.</span><span class="n">notes</span><span class="p">([</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">4</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2</span><span class="p">],</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">)]))</span>
<span class="n">main_voice_m2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;main_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_voice_m2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m3</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">(</span><span class="n">construct</span><span class="o">.</span><span class="n">notes</span><span class="p">([</span><span class="o">-</span><span class="mf">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">3</span><span class="p">],</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">16</span><span class="p">)]))</span>
<span class="n">main_voice_m3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;main_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_voice_m3</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that every <a title="abjad.Voice" class="reference external" href="../../../api/voice/voice.html#abjad.Voice"><tt class="xref docutils literal"><span class="pre">Voice</span></tt></a>  we create is equally named <cite>main_voice</cite> to guarantee the existence of a continuous thread. Many transformations and score traversal operations are possible across threads, so this is another reason why threads are important.</p>
<p>It is in the last two measures where we suddenly have two simultaneous voices in the lower staff. The new, second <a title="abjad.Voice" class="reference external" href="../../../api/voice/voice.html#abjad.Voice"><tt class="xref docutils literal"><span class="pre">Voice</span></tt></a> that seems to appear out of nowhere we will label <cite>appendix_voice</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m4</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">([</span><span class="n">Note</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">))])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m4</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;appendix_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m4</span><span class="o">.</span><span class="n">voice</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mf">1</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m4</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">([</span><span class="n">Note</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">)),</span> <span class="n">Note</span><span class="p">(</span><span class="o">-</span><span class="mf">3</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">))])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m4</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;main_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m4</span><span class="o">.</span><span class="n">voice</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mf">2</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Container</span><span class="p">([</span><span class="n">appendix_voice_m4</span><span class="p">,</span> <span class="n">main_voice_m4</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>A couple important things to notice:</p>
<ol class="arabic simple">
<li>The <cite>number</cite> property of the <cite>appendix_voice</cite> is set to <tt class="docutils literal"><span class="pre">1</span></tt>, and the <cite>number</cite> property of the <cite>main_voice</cite> is set to <tt class="docutils literal"><span class="pre">2</span></tt>. These determine the direction of the stem for each voice.</li>
<li>Because both voices occur simultaneously in the score, we must put them in a parallel <a title="abjad.Container" class="reference external" href="../../../api/container/container.html#abjad.Container"><tt class="xref docutils literal"><span class="pre">Container</span></tt></a> to tell Abjad that they indeed run in parallel. Notice the setting of the boolean <cite>parallel</cite> property of the <a title="abjad.Container" class="reference external" href="../../../api/container/container.html#abjad.Container"><tt class="xref docutils literal"><span class="pre">Container</span></tt></a> object. It is this <a title="abjad.Container" class="reference external" href="../../../api/container/container.html#abjad.Container"><tt class="xref docutils literal"><span class="pre">Container</span></tt></a> that is passed to the measure.</li>
</ol>
<p>We now do a similar thing for the last measure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m5</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">([</span><span class="n">Note</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">))])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m5</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;appendix_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">appendix_voice_m5</span><span class="o">.</span><span class="n">voice</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mf">1</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m5</span> <span class="o">=</span>  <span class="n">Voice</span><span class="p">([</span><span class="n">Note</span><span class="p">(</span><span class="o">-</span><span class="mf">5</span><span class="p">,</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">))])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m5</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;main_voice&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">main_voice_m5</span><span class="o">.</span><span class="n">voice</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mf">2</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Container</span><span class="p">([</span><span class="n">appendix_voice_m5</span><span class="p">,</span> <span class="n">main_voice_m5</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s see what we have up till now:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">piano</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/bartok_framework.png" src="../../../../_images/bartok_framework.png" />
<p>Ok, let&#8217;s add some detail. First, notice that the bottom staff has a treble clef, just like the top staff. Let&#8217;s change that:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_staff</span><span class="o">.</span><span class="n">clef</span><span class="o">.</span><span class="n">forced</span> <span class="o">=</span> <span class="n">Clef</span><span class="p">(</span><span class="s">&#39;bass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s sprinkle some dynamic markings. For the top staff, we will add them to the first note of the first measure and the second note of the second measure. For the bottom staff, we will add dynamic markings to the second note of the first measure and the fourth note of the second measure. Note that because we created Voices inside the measures of the lower staff, we need to index those too:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="s">&#39;pp&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">upper_measures</span><span class="p">[</span><span class="mf">1</span><span class="p">][</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="s">&#39;mp&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">][</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="s">&#39;pp&#39;</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_measures</span><span class="p">[</span><span class="mf">1</span><span class="p">][</span><span class="mf">0</span><span class="p">][</span><span class="mf">3</span><span class="p">]</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">mark</span> <span class="o">=</span> <span class="s">&#39;mp&#39;</span>
</pre></div>
</div>
<p>Let&#8217;s also add a double bar line to the end of the piece:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">lower_staff</span><span class="o">.</span><span class="n">barline</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s">&#39;||&#39;</span>
</pre></div>
</div>
<p>Let&#8217;s see how this is coming out:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">piano</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/bartok_notes.png" src="../../../../_images/bartok_notes.png" />
<p>Notice that the beams of the eighth and sixteenth notes appear as you would usually expect: grouped by beat. We get this for free thanks to LilyPond&#8217;s default rendering algorithm. This is not, however, the way Bartok notated his score. Let&#8217;s set the beams as Bartok did, running some across the bar lines:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Beam</span><span class="p">(</span><span class="n">upper_measures</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Beam</span><span class="p">(</span><span class="n">lower_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">1</span><span class="p">:</span><span class="mf">5</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Beam</span><span class="p">(</span><span class="n">lower_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">6</span><span class="p">:</span><span class="mf">10</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">piano</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/bartok_beams.png" src="../../../../_images/bartok_beams.png" />
<p>Now some slurs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Slur</span><span class="p">(</span><span class="n">upper_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="mf">5</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Slur</span><span class="p">(</span><span class="n">upper_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">5</span><span class="p">:])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Slur</span><span class="p">(</span><span class="n">lower_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">1</span><span class="p">:</span><span class="mf">6</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">slr</span> <span class="o">=</span> <span class="n">Slur</span><span class="p">(</span><span class="n">lower_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="mf">6</span><span class="p">:</span><span class="mf">13</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">main_voice_m4</span><span class="p">,</span> <span class="n">main_voice_m5</span><span class="p">))</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">slr</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="s">&#39;down&#39;</span>
</pre></div>
</div>
<p>Notice that we store the last slur in the <cite>slr</cite> variable to change its <tt class="docutils literal"><span class="pre">position</span></tt> attribute to <tt class="docutils literal"><span class="pre">'down'</span></tt>. This does what you would expect!</p>
<p>Now dynamic wedges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Crescendo</span><span class="p">(</span><span class="n">upper_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mf">7</span><span class="p">:</span><span class="o">-</span><span class="mf">2</span><span class="p">])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Decrescendo</span><span class="p">(</span><span class="n">upper_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mf">2</span><span class="p">:])</span>
</pre></div>
</div>
<p>...and a <cite>ritardando</cite> marking above the last seven notes of the upper staff:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">upper_staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mf">7</span><span class="p">:])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">tx</span><span class="o">.</span><span class="n">bound_details__left__text</span> <span class="o">=</span> <span class="n">Markup</span><span class="p">(</span><span class="s">&#39;ritard.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>And, we almost forgot! Two ties connecting the last notes in the upper and lower staves:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Tie</span><span class="p">(</span><span class="n">upper_staff</span><span class="p">[</span><span class="o">-</span><span class="mf">2</span><span class="p">:])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">Tie</span><span class="p">([</span><span class="n">appendix_voice_m4</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">appendix_voice_m5</span><span class="p">[</span><span class="mf">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>The final result:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">piano</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/bartok_final.png" src="../../../../_images/bartok_final.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../../abjad/index.html"
                                  title="previous chapter">Abjad?</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../slicing/index.html"
                                  title="next chapter">Example: metric grid</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../../_sources/chapters/introduction/examples/bartok/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../slicing/index.html" title="Example: metric grid"
             >next</a> |</li>
        <li class="right" >
          <a href="../../abjad/index.html" title="Abjad?"
             >previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Víctor Adán, Trevor Bača.
      Last updated on Aug 05, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>