<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tests &mdash; Abjad v1.1.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/ga-1.js"></script>
    <script type="text/javascript" src="../../../_static/ga-2.js"></script>
    <link rel="top" title="Abjad v1.1.1 documentation" href="../../../index.html" />
    <link rel="next" title="Scripts" href="../scripts/index.html" />
    <link rel="prev" title="Docs" href="../documentation/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="../scripts/index.html" title="Scripts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../documentation/index.html" title="Docs"
             accesskey="P">previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tests">
<h1>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h1>
<p>Abjad includes an extensive battery of tests.
Abjad is in a state of rapid development and extension.
Major refactoring efforts are common every six to eight months, and
are likely to remain so at least 2012.
And yet Abjad continues to allow the creation
of complex pieces of fully notated score in the midst of these changes.
We believe this is due to the extensive coverage provided by
the automated regression battery described in the following sections. <a class="footnote-reference" href="#id2" id="id1">[1]</a></p>
<div class="section" id="automated-regression">
<h2>Automated regression?<a class="headerlink" href="#automated-regression" title="Permalink to this headline">¶</a></h2>
<p>A battery is any collection of tests. Regression tests differ from
other types of test in that they are designed to be run again and
again during many different stages of the development process.
Regression tests help ensure that the system continues to function
correctly as we make changes to it. An automated regression
battery is one that can be run automatically by some sort of driver with
minimal manual intervention.</p>
<p>Several different test drivers are now in use in the Python community.
Of these, Abjad uses <a class="reference external" href="http://codespeak.net/py/dist/test/test.html">py.test</a>.
The <tt class="docutils literal"><span class="pre">py.test</span></tt> distribution is not included in the Python
standard library, so one of the first thing new contributors to Abjad
should do is download and install <tt class="docutils literal"><span class="pre">py.test</span></tt>, and then run the existing
battery.</p>
</div>
<div class="section" id="running-the-battery">
<h2>Running the battery<a class="headerlink" href="#running-the-battery" title="Permalink to this headline">¶</a></h2>
<p>Change to the directory where you have Abjad installed.
Then run <tt class="docutils literal"><span class="pre">py.test</span></tt>.</p>
<div class="highlight-python"><pre>abjad$ py.test
============================= test process starts ==============================
executable:   /Library/Frameworks/Python.framework/Versions/2.5/Resources/Python
.app/Contents/MacOS/Python  (2.5.0-final-0)
using py lib: /Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/sit
e-packages/py &lt;rev unknown&gt;

accidental/test/test_accidental_compare.py[3] ...
accidental/test/test_accidental_eq.py[3] ...
accidental/test/test_accidental_init.py[2] ..
accidental/test/test_accidental_interface_grob_handling.py[2] ..
accidental/test/test_accidental_interface_style.py[2] ..

... (many lines omitted) ...

tuplet/test/test_tuplet_number_grob_handling.py[3] ...
update/test/test_update_interface.py[10] ..........
voice/interface/test/test_voice_interface_explicit.py[2] ..
voice/interface/test/test_voice_interface_number.py[5] .....
voice/test/test_voice_len.py[2] ..

================ tests finished: 2165 passed in 232.53 seconds =================</pre>
</div>
</div>
<div class="section" id="reading-test-output">
<h2>Reading test output<a class="headerlink" href="#reading-test-output" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">py.test</span></tt> crawls the entire directory structure from which
you call it, running tests in alphabetical order.
<tt class="docutils literal"><span class="pre">py.test</span></tt> prints the total number of tests per file in square brackets
and prints test results as a single <tt class="docutils literal"><span class="pre">.</span></tt> dot for success or else
an <tt class="docutils literal"><span class="pre">F</span></tt> for failure.</p>
</div>
<div class="section" id="writing-tests">
<h2>Writing tests<a class="headerlink" href="#writing-tests" title="Permalink to this headline">¶</a></h2>
<p>Project check-in standards
ask that tests accompany all code committed to the Abjad repository.
If you add a new function, class or method to Abjad, you should add
a new test file for that function, class or method.
If you fix or extend an existing function, class or method,
you should find the existing test file that covers that code
and then either add a completely new test to the test file or
else update an existing test already present in the test file.</p>
</div>
<div class="section" id="test-files-start-with-test">
<h2>Test files start with <tt class="docutils literal"><span class="pre">test_</span></tt><a class="headerlink" href="#test-files-start-with-test" title="Permalink to this headline">¶</a></h2>
<p>When <tt class="docutils literal"><span class="pre">py.test</span></tt> first starts up it crawls the entire directory structure
from which you call it prior to running a single test. As <tt class="docutils literal"><span class="pre">py.test</span></tt>
executes this preflight work, it looks for any files beginning or ending
with the string <tt class="docutils literal"><span class="pre">test</span></tt> and then collects and alphabetizes these.
Only after making such a catalog of tests does <tt class="docutils literal"><span class="pre">py.test</span></tt> begin execution.
This collect-and-cache behavior leads to the important point about naming,
below.</p>
</div>
<div class="section" id="avoiding-name-conflicts">
<h2>Avoiding name conflicts<a class="headerlink" href="#avoiding-name-conflicts" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The names of <strong>test functions</strong> must be absolutely unique
across the entire directory structure on which you call <tt class="docutils literal"><span class="pre">py.test</span></tt>.
You must never share names between test functions.
For example, you must not have two tests named
<tt class="docutils literal"><span class="pre">test_grob_handling_01(</span> <span class="pre">)</span></tt> <strong>even if both tests live in different
test files</strong>. That is, a test named <tt class="docutils literal"><span class="pre">test_grob_handling_01(</span> <span class="pre">)</span></tt>
living in the file <tt class="docutils literal"><span class="pre">test_accidental_grob_handling.py</span></tt> and a second
test named <tt class="docutils literal"><span class="pre">test_grob_handling_01(</span> <span class="pre">)</span></tt> living in the file
<tt class="docutils literal"><span class="pre">test_notehead_grob_handling.py</span></tt> will conflict with the each
other when <tt class="docutils literal"><span class="pre">py.test</span></tt> runs. And, unfortunately, <strong>``py.test is silent
about such conflicts when it runs</strong>. That is, should you run <tt class="docutils literal"><span class="pre">py.test</span></tt>
with the duplicate naming situation described here, what will happen
is that <tt class="docutils literal"><span class="pre">py.test</span></tt> will correctly run and report results for the
<strong>first</strong> such test it finds. However, when <tt class="docutils literal"><span class="pre">py.test</span></tt> encounters
the second like-named test, <tt class="docutils literal"><span class="pre">py.test</span></tt> will incorrectly report
cached results for the <strong>first</strong> test rather than the second.
The take-away is to include some sort of namespacing indicators
in every test name and not to be afraid of long test names.
The <tt class="docutils literal"><span class="pre">test_grob_handling_01(</span> <span class="pre">)</span></tt> example given here fixes easily when
the two tests rename to <tt class="docutils literal"><span class="pre">test_accidental_grob_handling_01(</span> <span class="pre">)</span></tt> and
<tt class="docutils literal"><span class="pre">test_notehead_grob_handling_01(</span> <span class="pre">)</span></tt>.</p>
</div>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Abjad r2371 includes 2165 tests.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Tests</a><ul>
<li><a class="reference external" href="#automated-regression">Automated regression?</a></li>
<li><a class="reference external" href="#running-the-battery">Running the battery</a></li>
<li><a class="reference external" href="#reading-test-output">Reading test output</a></li>
<li><a class="reference external" href="#writing-tests">Writing tests</a></li>
<li><a class="reference external" href="#test-files-start-with-test">Test files start with <tt class="docutils literal"><span class="pre">test_</span></tt></a></li>
<li><a class="reference external" href="#avoiding-name-conflicts">Avoiding name conflicts</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../documentation/index.html"
                                  title="previous chapter">Docs</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../scripts/index.html"
                                  title="next chapter">Scripts</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/chapters/devel/tests/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../scripts/index.html" title="Scripts"
             >next</a> |</li>
        <li class="right" >
          <a href="../documentation/index.html" title="Docs"
             >previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Víctor Adán, Trevor Bača.
      Last updated on Aug 05, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>