<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example: metric grid &mdash; Abjad v1.1.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.1.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/ga-1.js"></script>
    <script type="text/javascript" src="../../../../_static/ga-2.js"></script>
    <link rel="top" title="Abjad v1.1.1 documentation" href="../../../../index.html" />
    <link rel="next" title="Installation" href="../../download/index.html" />
    <link rel="prev" title="Bartók’s Wandering" href="../bartok/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="../../download/index.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../bartok/index.html" title="Bartók’s Wandering"
             accesskey="P">previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="example-metric-grid">
<h1>Example: metric grid<a class="headerlink" href="#example-metric-grid" title="Permalink to this headline">¶</a></h1>
<p>This example <a class="footnote-reference" href="#f1" id="id1">[1]</a> demonstrates how you can compose a sequence of notes with
arbitrary durations outside a metric hierarchy (e.g. Measures) and
then slice and dice the notes to have them fit a metric overlay added
<cite>a posteriori</cite>.</p>
<p>Let us first define a set of durations from prime numbers:</p>
<div class="highlight-python"><pre>abjad&gt; durations = [5, 7, 2, 11, 13, 5, 13, 3]
abjad&gt; durations = zip(durations, [16] * len(durations))
abjad&gt; print durations
[(5, 16), (7, 16), (2, 16), (11, 16), (13, 16), (5, 16), (13, 16), (3, 16)]</pre>
</div>
<p>Let us now create a list of notes from these durations.</p>
<div class="highlight-python"><pre>abjad&gt; notes = construct.notes(0, durations)
abjad&gt; print notes
[Note(c', 4), Note(c', 16), Note(c', 4..), Note(c', 8), Note(c', 2), Note(c', 8.), Note(c', 2.), Note(c', 16), Note(c', 4), Note(c', 16), Note(c', 2.), Note(c', 16), Note(c', 8.)]</pre>
</div>
<p>Let us now put these notes inside a <tt class="xref docutils literal"><span class="pre">RhythmicSketchStaff</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">staff</span> <span class="o">=</span> <span class="n">RhythmicSketchStaff</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/example16.png" src="../../../../_images/example16.png" />
<p>As this will become part of a piece for ensemble to be conducted, we
would like all the parts to have a common metric (measure) structure.
We now apply a <tt class="xref docutils literal"><span class="pre">MetricGrid</span></tt> spanner with the desired metric sequence
to our staff.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">MetricGrid</span><span class="p">(</span><span class="n">staff</span><span class="p">,</span> <span class="p">[(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">11</span><span class="p">,</span> <span class="mf">16</span><span class="p">)])</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">staff</span><span class="o">.</span><span class="n">meter</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span> <span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">staff</span><span class="o">.</span><span class="n">barline</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span> <span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/example25.png" src="../../../../_images/example25.png" />
<p>Notice how some notes <strong>span</strong> more than one measure (i.e. they extend
over the bar lines). This is a good thing because it shows that note
durations and meter are treated independently. It also shows the
flexibility and exactness of LilyPond&#8217;s internal rhythmic model. We
may not want these spanning notes in our final score, however. We may
also want to show each beat by splitting notes every quarter or every
half note duration. To do this we will slice the music to a second
sequence of meters using the  <tt class="docutils literal"><span class="pre">partition.unfractured_by_durations(</span> <span class="pre">)</span></tt>
function. Because tied note may be created by the partitioning function, we then
fuse all tied notes within each of the metric units &#8211;via the
<tt class="docutils literal"><span class="pre">fuse.tie_chains_by_durations(</span> <span class="pre">)</span></tt> function&#8211; to guarantee that our durations
are represented in the most compact form.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">abjad</span><span class="o">&gt;</span> <span class="n">meters</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">)]</span> <span class="o">*</span> <span class="mf">4</span> <span class="o">+</span> <span class="p">[(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">4</span><span class="p">)]</span> <span class="o">*</span> <span class="mf">6</span> <span class="o">+</span> <span class="p">[(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[(</span><span class="mf">3</span><span class="p">,</span> <span class="mf">16</span><span class="p">)]</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">meters</span> <span class="o">=</span> <span class="n">durtools</span><span class="o">.</span><span class="n">rationalize</span><span class="p">(</span><span class="n">meters</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">partition</span><span class="o">.</span><span class="n">unfractured_by_durations</span><span class="p">(</span><span class="n">staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">,</span> <span class="n">meters</span><span class="p">,</span> <span class="n">tie_after</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">fuse</span><span class="o">.</span><span class="n">tie_chains_by_durations</span><span class="p">(</span><span class="n">staff</span><span class="o">.</span><span class="n">leaves</span><span class="p">,</span> <span class="n">meters</span><span class="p">)</span>
<span class="n">abjad</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/example34.png" src="../../../../_images/example34.png" />
<p>And this gives us our final score snippet.</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>This example reconstructs the first few measures of Stephen Lehman&#8217;s <cite>Rai</cite> following the composer&#8217;s own process: <em>&#8220;I basically created a duration row, and then applied a meter to it after the fact. Then, once I started changing the distribution of prime number values over the course of the piece, I tried to make them fit in the same time span.&#8221;</em></td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../bartok/index.html"
                                  title="previous chapter">Bartók&#8217;s <em>Wandering</em></a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../../download/index.html"
                                  title="next chapter">Installation</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../../_sources/chapters/introduction/examples/slicing/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../download/index.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="../bartok/index.html" title="Bartók’s Wandering"
             >previous</a> |</li>
    <li><a href="http://www.projectabjad.org/">Project Abjad</a> &raquo;</li>
    
        <li><a href="../../../../index.html">Abjad v1.1.1 documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Víctor Adán, Trevor Bača.
      Last updated on Aug 05, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>