<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>py.test customize</title>
    <meta content="text/html;charset=ISO-8859-1" name="Content-Type"/>
    <link href="../style.css" media="screen" rel="stylesheet" type="text/css"/></head>
  <body>
    <div id="navspace">
      <div><a href="http://pylib.org"><img alt="py lib" height="57" id="pyimg" src="http://codespeak.net/img/pylib.png" width="77"/></a></div>
      <div id="menubar">
        <div style="font-style: italic;">1.0.2</div>
        <div>
          <div><a class="menu" href="../download.html">install</a></div></div>
        <div>
          <div><a class="menu" href="../contact.html">contact</a></div></div>
        <div>
          <div><a class="menu" href="../changelog.html">changelog</a></div></div>
        <div>
          <div><a class="menu" href="../faq.html">faq</a></div></div>
        <div>
          <div>
            <h3>py.test:</h3>
            <div><a class="menu" href="index.html">doc index</a></div>
            <div><a class="menu" href="features.html">features</a></div>
            <div><a class="menu" href="quickstart.html">quickstart</a></div>
            <div><a class="menu" href="talks.html">tutorials</a></div>
            <div><a class="menu" href="plugin/index.html">plugins</a></div>
            <div><a class="menu" href="funcargs.html">funcargs</a></div>
            <div><a class="menu" href="customize.html">customize</a></div></div></div>
        <div>
          <div>
            <h3>supporting APIs:</h3>
            <div><a class="menu" href="../index.html">pylib index</a></div>
            <div><a class="menu" href="../execnet.html">py.execnet</a></div>
            <div><a class="menu" href="../path.html">py.path</a></div>
            <div><a class="menu" href="../code.html">py.code</a></div></div></div></div></div>
    <div id="contentspace">
<div class="document" id="customizing-and-extending-py-test">
<h1 class="title">Customizing and Extending py.test</h1>

<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#basic-test-configuration" id="id1">basic test configuration</a><ul>
<li><a class="reference internal" href="#available-command-line-options" id="id2">available command line options</a></li>
<li><a class="reference internal" href="#conftest-py-project-specific-hooks-and-configuration" id="id3">conftest.py: project specific hooks and configuration</a></li>
<li><a class="reference internal" href="#setting-persistent-option-defaults" id="id4">setting persistent option defaults</a></li>
<li><a class="reference internal" href="#temporary-directories" id="id5">Temporary directories</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plugin-basics" id="id6">Plugin basics</a><ul>
<li><a class="reference internal" href="#project-specific-local-or-named-global-plugins" id="id7">project specific &quot;local&quot; or named &quot;global&quot; plugins</a></li>
<li><a class="reference internal" href="#plugin-discovery-at-tool-startup" id="id8">Plugin discovery at tool startup</a></li>
<li><a class="reference internal" href="#specifying-plugins-in-a-test-module-or-plugin" id="id9">Specifying plugins in a test module or plugin</a></li>
<li><a class="reference internal" href="#conftest-py-as-anonymous-per-project-plugins" id="id10">conftest.py as anonymous per-project plugins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#important-py-test-hooks" id="id11">Important py.test hooks</a><ul>
<li><a class="reference internal" href="#command-line-parsing-and-configuration-hooks" id="id12">command line parsing and configuration hooks</a></li>
<li><a class="reference internal" href="#adding-global-py-test-helpers-and-functionality" id="id13">adding global py.test helpers and functionality</a></li>
<li><a class="reference internal" href="#generic-runtest-hooks" id="id14">generic &quot;runtest&quot; hooks</a></li>
<li><a class="reference internal" href="#generic-collection-hooks" id="id15">generic collection hooks</a></li>
<li><a class="reference internal" href="#python-test-function-and-module-hooks" id="id16">Python test function and module hooks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-collection-process" id="id17">Test Collection process</a><ul>
<li><a class="reference internal" href="#the-collection-tree" id="id18">the collection tree</a></li>
<li><a class="reference internal" href="#constructing-the-package-name-for-test-modules" id="id19">constructing the package name for test modules</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="basic-test-configuration">
<h1><a class="toc-backref" href="#id1">basic test configuration</a></h1>
<div class="section" id="available-command-line-options">
<h2><a class="toc-backref" href="#id2">available command line options</a></h2>
<p>You can see command line options by running:</p>
<pre class="literal-block">
py.test -h
</pre>
<p>This will display all available command line options
in your specific environment.</p>
</div>
<div class="section" id="conftest-py-project-specific-hooks-and-configuration">
<span id="collect-ignore"></span><span id="project-specific-test-configuration"></span><h2><a class="toc-backref" href="#id3">conftest.py: project specific hooks and configuration</a></h2>
<p>A unique feature of py.test are its <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files which
allow to:</p>
<ul class="simple">
<li><a class="reference internal" href="#set-option-defaults">set option defaults</a></li>
<li><a class="reference internal" href="#implement-hooks">implement hooks</a></li>
<li><a class="reference external" href="funcargs.html#application-setup-tutorial-example">specify funcargs</a></li>
</ul>
<p>or set particular variables to influence the testing process:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pytest_plugins</span></tt>: list of named plugins to load</li>
<li><tt class="docutils literal"><span class="pre">collect_ignore</span></tt>: list of paths to ignore during test collection, relative to the containing <tt class="docutils literal"><span class="pre">conftest.py</span></tt> file</li>
<li><tt class="docutils literal"><span class="pre">rsyncdirs</span></tt>: list of to-be-rsynced directories for distributed
testing, relative to the containing <tt class="docutils literal"><span class="pre">conftest.py</span></tt> file.</li>
</ul>
<p>You may put a conftest.py files in your project root directory or into
your package directory if you want to add project-specific test options.</p>
<p><tt class="docutils literal"><span class="pre">py.test</span></tt> loads all <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files upwards from the command
line file arguments.  It usually looks up configuration values
right-to-left, i.e. the closer conftest files will be checked first.
This means you can have a <tt class="docutils literal"><span class="pre">conftest.py</span></tt> in your very home directory to
have some global configuration values.</p>
</div>
<div class="section" id="setting-persistent-option-defaults">
<span id="set-option-defaults"></span><h2><a class="toc-backref" href="#id4">setting persistent option defaults</a></h2>
<p>py.test will lookup option values in this order:</p>
<ul class="simple">
<li>command line</li>
<li>conftest.py files</li>
<li>environment variables</li>
</ul>
<p>To find out about the particular switches and type:</p>
<pre class="literal-block">
py.test --help-config
</pre>
<p>This will print information about all options in your
environment, including your local plugins.</p>
</div>
<div class="section" id="temporary-directories">
<span id="basetemp"></span><h2><a class="toc-backref" href="#id5">Temporary directories</a></h2>
<p>You can create directories by calling one of two methods
on the config object:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">config.mktemp(basename)</span></tt>: create and return a new tempdir</li>
<li><tt class="docutils literal"><span class="pre">config.ensuretemp(basename)</span></tt>: create or return a new tempdir</li>
</ul>
<p>temporary directories are created as sub directories of a per-session
testdir and will keep around the directories of the last three test
runs.  You can set the base temporary directory through the command line
<cite>--basetemp`</cite> option.  When distributing tests on the same machine,
<tt class="docutils literal"><span class="pre">py.test</span></tt> takes care to configure a basetemp directory for the sub
processes such that all temporary data lands below below a single
per-test run basetemp directory.</p>
</div>
</div>
<div class="section" id="plugin-basics">
<span id="extensions"></span><h1><a class="toc-backref" href="#id6">Plugin basics</a></h1>
<div class="section" id="project-specific-local-or-named-global-plugins">
<span id="local-plugin"></span><h2><a class="toc-backref" href="#id7">project specific &quot;local&quot; or named &quot;global&quot; plugins</a></h2>
<p>py.test implements much of its functionality by calling <a class="reference internal" href="#well-specified-hooks">well specified
hooks</a>.  Python modules which contain such hook functions are called
plugins.  Hook functions are discovered in <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files or in
<a class="reference external" href="plugin/index.html">named plugins</a>.  <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files are sometimes called
&quot;anonymous&quot; or conftest plugins. They are useful for keeping test
extensions close to your application.  Named plugins are normal python
modules or packages that can be distributed separately.   Named plugins
need to follow a naming pattern; they have an all lowercase <tt class="docutils literal"><span class="pre">pytest_</span></tt>
prefixed name.  While conftest plugins are discovered automatically,
named plugins must be explicitely specified.</p>
</div>
<div class="section" id="plugin-discovery-at-tool-startup">
<span id="test-tool-starts-up"></span><span id="loaded-at-tool-startup"></span><span id="tool-startup"></span><h2><a class="toc-backref" href="#id8">Plugin discovery at tool startup</a></h2>
<p>py.test loads plugin modules at tool startup in the following way:</p>
<ul class="simple">
<li>by reading the <tt class="docutils literal"><span class="pre">PYTEST_PLUGINS</span></tt> environment variable
and importing the comma-separated list of named plugins.</li>
<li>by pre-scanning the command line for the <tt class="docutils literal"><span class="pre">-p</span> <span class="pre">name</span></tt> option
and loading the specified plugin before actual command line parsing.</li>
<li>by loading all <a class="reference internal" href="#conftest-py-plugin">conftest.py plugin</a> files as inferred by the command line
invocation</li>
<li>by recursively loading all plugins specified by the
<tt class="docutils literal"><span class="pre">pytest_plugins</span></tt> variable in a <tt class="docutils literal"><span class="pre">conftest.py</span></tt> file</li>
</ul>
<p>Note that at tool startup only <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files in
the directory of the specified test modules (or the current dir if None)
or any of the parent directories are found.  There is no try to
pre-scan all subdirectories to find <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files or test
modules.</p>
</div>
<div class="section" id="specifying-plugins-in-a-test-module-or-plugin">
<h2><a class="toc-backref" href="#id9">Specifying plugins in a test module or plugin</a></h2>
<p>You can specify plugins in a test module or a plugin like this:</p>
<div class="highlight"><pre>pytest_plugins <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;name1&quot;</span>, <span style="color: #BA2121">&quot;name2&quot;</span>,
</pre></div>
<p>When the test module or plugin is loaded the specified plugins
will be loaded.  If you specify plugins without the <tt class="docutils literal"><span class="pre">pytest_</span></tt>
prefix it will be automatically added.  All plugin names
must be lowercase.</p>
</div>
<div class="section" id="conftest-py-as-anonymous-per-project-plugins">
<span id="conftestplugin"></span><span id="conftest-py-plugin"></span><h2><a class="toc-backref" href="#id10">conftest.py as anonymous per-project plugins</a></h2>
<p>The purpose of <tt class="docutils literal"><span class="pre">conftest.py</span></tt> files is to allow <a class="reference internal" href="#project-specific-test-configuration">project-specific
test configuration</a>.  They thus make for a good place to implement
project-specific test related features through hooks.  For example you may
set the <a class="reference internal" href="#collect-ignore">collect_ignore</a> variable depending on a command line option
by defining the following hook in a <tt class="docutils literal"><span class="pre">conftest.py</span></tt> file:</p>
<div class="highlight"><pre><span style="color: #408080; font-style: italic"># ./conftest.py in your root or package dir</span>
collect_ignore <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;hello&#39;</span>, <span style="color: #BA2121">&#39;test_world.py&#39;</span>]
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_addoption</span>(parser):
    parser<span style="color: #666666">.</span>addoption(<span style="color: #BA2121">&quot;--runall&quot;</span>, action<span style="color: #666666">=</span><span style="color: #BA2121">&quot;store_true&quot;</span>, default<span style="color: #666666">=</span><span style="color: #008000">False</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_configure</span>(config):
    <span style="color: #008000; font-weight: bold">if</span> config<span style="color: #666666">.</span>getvalue(<span style="color: #BA2121">&quot;runall&quot;</span>):
        collect_ignore[:] <span style="color: #666666">=</span> []
</pre></div>
</div>
</div>
<div class="section" id="important-py-test-hooks">
<span id="implement-hooks"></span><span id="well-specified-hooks"></span><h1><a class="toc-backref" href="#id11">Important py.test hooks</a></h1>
<p>py.test calls hooks functions to implement its <a class="reference internal" href="#test-collection">test collection</a>,
running and reporting process.  When py.test loads a plugin it validates
that all hook functions conform to the <a class="reference external" href="plugin/hookspec.html">hook definition specification</a>.</p>
<p>The hook function name and its
argument names need to match exactly but it is allowed for an implementation
to accept <em>less</em> parameters.  You'll get useful errors on mistyped hook or
argument names.  Read on for some introductory information on particular
hooks.  It's sensible to look at existing plugins so see example usages
and start off with your own plugin.</p>
<div class="section" id="command-line-parsing-and-configuration-hooks">
<span id="configuration-hooks"></span><h2><a class="toc-backref" href="#id12">command line parsing and configuration hooks</a></h2>
<p>When the <a class="reference internal" href="#test-tool-starts-up">test tool starts up</a> it will invoke all hooks that add
command line options in the python standard optparse style.</p>
<div class="highlight"><pre><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_addoption</span>(parser):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; add command line options. &quot;&quot;&quot;</span><span style="color: #BA2121">&quot;</span>
    parser<span style="color: #666666">.</span>addoption(<span style="color: #BA2121">&quot;--myopt&quot;</span>, dest<span style="color: #666666">=</span><span style="color: #BA2121">&quot;myopt&quot;</span>, action<span style="color: #666666">=</span><span style="color: #BA2121">&quot;store_true&quot;</span>)
</pre></div>
<p>After all these hooks have been called, the command line is parser
and a <tt class="docutils literal"><span class="pre">config</span></tt> object is created and another hook is invoked,
for example:</p>
<div class="highlight"><pre><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_configure</span>(config):
    config<span style="color: #666666">.</span>getvalue(<span style="color: #BA2121">&quot;myopt&quot;</span>)
</pre></div>
<p>When the test run finishes this corresponding finalizer hook is called:</p>
<blockquote>
<dl class="docutils">
<dt>def pytest_unconfigure(config):</dt>
<dd>...</dd>
</dl>
</blockquote>
</div>
<div class="section" id="adding-global-py-test-helpers-and-functionality">
<h2><a class="toc-backref" href="#id13">adding global py.test helpers and functionality</a></h2>
<p>If you want to make global helper functions or objects available
to your test code you can implement:</p>
<blockquote>
<dl class="docutils">
<dt>def pytest_namespace():</dt>
<dd>&quot;&quot;&quot; return dictionary with items to be made available on py.test. namespace &quot;&quot;&quot;</dd>
</dl>
</blockquote>
<p>All such returned items will be made available directly on
the <tt class="docutils literal"><span class="pre">py.test</span></tt> namespace.</p>
<p>If you want to provide helpers that are specific to a test function run or need
to be setup per test function run, please refer to the <a class="reference external" href="funcargs.html">funcargs mechanism</a>.</p>
</div>
<div class="section" id="generic-runtest-hooks">
<h2><a class="toc-backref" href="#id14">generic &quot;runtest&quot; hooks</a></h2>
<p>Each test item is usually executed by calling the following three hooks:</p>
<div class="highlight"><pre>pytest_runtest_setup(item)
pytest_runtest_call(item)
pytest_runtest_teardown(item)
</pre></div>
<p>For each of the three invocations a <a class="reference internal" href="#call-object">call object</a> encapsulates
information about the outcome of the call and is subsequently used
to make a report object:</p>
<div class="highlight"><pre>report <span style="color: #666666">=</span> hook<span style="color: #666666">.</span>pytest_runtest_makereport(item, call)
</pre></div>
<p>For example, the <a class="reference external" href="http://bitbucket.org/hpk42/py-trunk/src/tip/py/test/plugin/pytest_pdb.py">pytest_pdb plugin</a> uses this hook to activate
interactive debugging on failures when <tt class="docutils literal"><span class="pre">--pdb</span></tt> is specified on the
command line.</p>
<p>Usually three reports will be generated for a single test item for each
of the three runtest hooks respectively.  If <tt class="docutils literal"><span class="pre">pytest_runtest_setup</span></tt>
fails then <tt class="docutils literal"><span class="pre">pytest_runtest_teardown</span></tt> will be called but not
<tt class="docutils literal"><span class="pre">pytest_runtest_call</span></tt>.</p>
<p>Each of the up to three reports is eventually fed to the logreport hook:</p>
<div class="highlight"><pre>pytest_runtest_logreport(report)
</pre></div>
<p>A <tt class="docutils literal"><span class="pre">report</span></tt> object contains status and reporting information:</p>
<div class="highlight"><pre>report<span style="color: #666666">.</span>longrepr <span style="color: #666666">=</span> string<span style="color: #666666">/</span>lines<span style="color: #666666">/</span><span style="color: #008000">object</span> to <span style="color: #008000; font-weight: bold">print</span>
report<span style="color: #666666">.</span>when <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;setup&quot;</span>, <span style="color: #BA2121">&quot;call&quot;</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;teardown&quot;</span>
report<span style="color: #666666">.</span>shortrepr <span style="color: #666666">=</span> letter <span style="color: #008000; font-weight: bold">for</span> progress<span style="color: #666666">-</span>report
report<span style="color: #666666">.</span>passed <span style="color: #666666">=</span> <span style="color: #008000">True</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">False</span>
report<span style="color: #666666">.</span>failed <span style="color: #666666">=</span> <span style="color: #008000">True</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">False</span>
report<span style="color: #666666">.</span>skipped <span style="color: #666666">=</span> <span style="color: #008000">True</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">False</span>
</pre></div>
<p>The <a class="reference external" href="http://bitbucket.org/hpk42/py-trunk/src/tip/py/test/plugin/pytest_terminal.py">pytest_terminal plugin</a> uses this hook to print information
about a test run.</p>
<p>The whole protocol described here is implemented via this hook:</p>
<div class="highlight"><pre>pytest_runtest_protocol(item) <span style="color: #666666">-&gt;</span> <span style="color: #008000">True</span>
</pre></div>
<p id="call-object">The call object contains information about a performed call:</p>
<div class="highlight"><pre>call<span style="color: #666666">.</span>excinfo <span style="color: #666666">=</span> ExceptionInfo <span style="color: #008000">object</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">None</span>
call<span style="color: #666666">.</span>when <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;setup&quot;</span>, <span style="color: #BA2121">&quot;call&quot;</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;teardown&quot;</span>
call<span style="color: #666666">.</span>outerr <span style="color: #666666">=</span> <span style="color: #008000">None</span> <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">tuple</span> of strings representing captured stdout<span style="color: #666666">/</span>stderr
</pre></div>
</div>
<div class="section" id="generic-collection-hooks">
<h2><a class="toc-backref" href="#id15">generic collection hooks</a></h2>
<p>py.test calls the following two fundamental hooks for collecting files and directories:</p>
<div class="highlight"><pre><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collect_directory</span>(path, parent):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return Collection node or None for the given path. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collect_file</span>(path, parent):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return Collection node or None for the given path. &quot;&quot;&quot;</span>
</pre></div>
<p>Both return a <a class="reference internal" href="#collection-node">collection node</a> for a given path.  All returned
nodes from all hook implementations will participate in the
collection and running protocol.  The <tt class="docutils literal"><span class="pre">parent</span></tt> object is
the parent node and may be used to access command line
options via the <tt class="docutils literal"><span class="pre">parent.config</span></tt> object.</p>
</div>
<div class="section" id="python-test-function-and-module-hooks">
<h2><a class="toc-backref" href="#id16">Python test function and module hooks</a></h2>
<p>For influencing the collection of objects in Python modules
you can use the following hook:</p>
<div class="highlight"><pre><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_pycollect_makeitem</span>(collector, name, obj):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return custom item/collector for a python object in a module, or None.  &quot;&quot;&quot;</span>
</pre></div>
<p>This hook will be called for each Python object in a collected
Python module.  The return value is a custom <a class="reference internal" href="#collection-node">collection node</a> or None.</p>
<!-- XXX or ``False`` if you want to indicate that the given item should not be collected. -->
</div>
</div>
<div class="section" id="test-collection-process">
<span id="test-collection"></span><span id="collection-node"></span><span id="collection-process"></span><h1><a class="toc-backref" href="#id17">Test Collection process</a></h1>
<div class="section" id="the-collection-tree">
<h2><a class="toc-backref" href="#id18">the collection tree</a></h2>
<p>The collecting process is iterative so that distribution
and execution of tests can start as soon as the first test
item is collected.  Collection nodes with children are
called &quot;Collectors&quot; and terminal nodes are called &quot;Items&quot;.
Here is an example of such a tree, generated with the
command <tt class="docutils literal"><span class="pre">py.test</span> <span class="pre">--collectonly</span> <span class="pre">py/xmlobj</span></tt>:</p>
<pre class="literal-block">
&lt;Directory 'xmlobj'&gt;
    &lt;Directory 'testing'&gt;
        &lt;Module 'test_html.py' (py.__.xmlobj.testing.test_html)&gt;
            &lt;Function 'test_html_name_stickyness'&gt;
            &lt;Function 'test_stylenames'&gt;
            &lt;Function 'test_class_None'&gt;
            &lt;Function 'test_alternating_style'&gt;
        &lt;Module 'test_xml.py' (py.__.xmlobj.testing.test_xml)&gt;
            &lt;Function 'test_tag_with_text'&gt;
            &lt;Function 'test_class_identity'&gt;
            &lt;Function 'test_tag_with_text_and_attributes'&gt;
            &lt;Function 'test_tag_with_subclassed_attr_simple'&gt;
            &lt;Function 'test_tag_nested'&gt;
            &lt;Function 'test_tag_xmlname'&gt;
</pre>
<p>By default all directories not starting with a dot are traversed,
looking for <tt class="docutils literal"><span class="pre">test_*.py</span></tt> and <tt class="docutils literal"><span class="pre">*_test.py</span></tt> files.  Those Python
files are imported under their <a class="reference internal" href="#package-name">package name</a>.</p>
<p>The Module collector looks for test functions
and test classes and methods. Test functions and methods
are prefixed <tt class="docutils literal"><span class="pre">test</span></tt> by default.  Test classes must
start with a capitalized <tt class="docutils literal"><span class="pre">Test</span></tt> prefix.</p>
</div>
<div class="section" id="constructing-the-package-name-for-test-modules">
<span id="package-name"></span><h2><a class="toc-backref" href="#id19">constructing the package name for test modules</a></h2>
<p>Test modules are imported under their fully qualified
name.  Given a filesystem <tt class="docutils literal"><span class="pre">fspath</span></tt> it is constructed as follows:</p>
<ul class="simple">
<li>walk the directories up to the last one that contains
an <tt class="docutils literal"><span class="pre">__init__.py</span></tt> file.</li>
<li>perform <tt class="docutils literal"><span class="pre">sys.path.insert(0,</span> <span class="pre">basedir)</span></tt>.</li>
<li>import the root package as <tt class="docutils literal"><span class="pre">root</span></tt></li>
<li>determine the fully qualified name for <tt class="docutils literal"><span class="pre">fspath</span></tt> by either:<ul>
<li>calling <tt class="docutils literal"><span class="pre">root.__pkg__.getimportname(fspath)</span></tt> if the
<tt class="docutils literal"><span class="pre">__pkg__</span></tt> exists.` or</li>
<li>otherwise use the relative path of the module path to
the base dir and turn slashes into dots and strike
the trailing <tt class="docutils literal"><span class="pre">.py</span></tt>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7597274-3");
pageTracker._trackPageview();
} catch(err) {}</script>
</body></html>