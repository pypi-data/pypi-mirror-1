Integration test for the 'switcherform'
=======================================

Making a user
-------------

Create a Managing User name theme_user and check to see s/he
has the appropriate roles

    >>> self.portal.portal_membership.addMember('theme_user', 'secret', ['Manager'], [])
    >>> self.portal.acl_users.getUserById('theme_user').getRoles()
    ['Manager', 'Authenticated']

Login as theme_user

    >>> self.login('theme_user')

Making a folder
---------------

Create a folder to switch on

    >>> self.portal.invokeFactory('Folder', 'folder', title=u'dummy folder')
    'folder'
    >>> self.portal.folder.absolute_url()
    'http://nohost/plone/folder'
    >>> self.url = self.portal.folder.absolute_url()

Let's surf!
-----------

Import and create the testbrowser

    >>> from Products.Five.testbrowser import Browser
    >>> self.browser = Browser()

Login to the plone site via the testbrowser

    >>> self.browser.open('http://nohost/plone/')
    >>> self.browser.getLink('Log in').click()
    >>> self.browser.getControl('Login Name').value = 'theme_user'
    >>> self.browser.getControl('Password').value = 'secret'
    >>> self.browser.getControl('Log in').click()

Let's surf over to the folder and see if we get what is expected

    >>> self.browser.open(self.url)

Click on the 'ThemeSwitcher' tab

    >>> self.browser.getLink('ThemeSwitcher').click()

Check the default form options

    >>> self.browser.getControl(name='form.themeswitcher_enable').value
    False
    >>> self.browser.getControl(name='form.themeswitcher_skin').options
    ['skin_two theme', 'skin_one theme']
    >>> self.browser.getControl(name='form.actions.cancel').click()
    >>> self.browser.url
    'http://nohost/plone/folder'

Let's set the switch
--------------------

Time to switch!!!

    >>> self.browser.open('%s//@@switcherform' % self.url)
    >>> self.browser.getControl(name='form.themeswitcher_enable').value = True
    >>> self.browser.getControl(name='form.themeswitcher_skin').value = ['skin_one theme']
    >>> self.browser.getControl(name='form.actions.save').click()
    traversing <ATFolder at folder> and asking for folder_listing
    IThemeSwitcher!!!
    >>> self.browser.getLink('Go Steelers!')
    <Link text='Go Steelers!' url='http://www.steelers.com/'>

Now go to a view for this 'folder' object, the sharing tab will do the trick

    >>> self.browser.getLink('Sharing').click()
    traversing <ATFolder at folder> and asking for ...
    IThemeSwitcher!!!
    >>> self.browser.getLink('Go Steelers!')
    <Link text='Go Steelers!' url='http://www.steelers.com/'>

Turn off the switcher

    >>> self.browser.open('%s//@@switcherform' % self.url)
    >>> self.browser.getControl(name='form.themeswitcher_enable').value = False
    >>> self.browser.getControl(name='form.actions.save').click()
