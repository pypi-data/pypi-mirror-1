<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eXtremeManagement">

  <body>

    <metal:main fill-slot="main">
      <tal:main-macro metal:define-macro="main"
           tal:define="view context/@@task;
                       task view/main;
                       tasks python:context.aq_parent.getFolderContents();
                       num_tasks python:len(tasks);
                       pos context/getObjPositionInParent;
                       next python:pos &lt; num_tasks-1 and tasks[pos+1];
                       prev python:pos != 0 and tasks[pos-1];
                       startable context/startable">

        <metal:prevnext use-macro="context/story_view/macros/previous_next" />
        <div tal:replace="structure provider:plone.abovecontenttitle" />

        <h1 class="documentFirstHeading"> 
            <metal:field use-macro="python:here.widget('title', mode='view')">
            Title
            </metal:field>
        </h1>

        <div tal:replace="structure provider:plone.belowcontenttitle" />

        <p class="documentDescription">
            <metal:field use-macro="python:here.widget('description', mode='view')">
            Description
            </metal:field>
        </p>

        <div tal:replace="structure provider:plone.abovecontentbody" />

        <div class="xm-details">
          <dl tal:condition="not:startable" class="not-startable">
            <dt i18n:translate="cannot_activate">Cannot Activate</dt>
            <dd tal:condition="python:len(context.getAssignees()) == 0">No one has been assigned to this task.</dd>
            <dd tal:condition="python:context.getHours() == 0 and context.getMinutes() == 0">Need to assign a time estimate to this task.</dd>

          </dl>

          <table class="listing"
                 width="100%"
                 cellpadding="0"
                 cellspacing="0">
            <tr>
              <th class="customer_info_header"
                  i18n:translate="listingheader_estimate_hours">
                Estimate (hours)
              </th>
              <td tal:content="task/estimate" />
            </tr>
            <tr>
              <th class="customer_info_header"
                  i18n:translate="listingheader_actual_hours">
                Actual (hours)
              </th>
              <td tal:content="task/actual">
                0:00
              </td>
            </tr>
            <tr>
              <th class="customer_info_header"
                  i18n:translate="listingheader_state">
                Status
              </th>
              <td tal:content="task/review_state" />
            </tr>
            <tr>
              <th class="customer_info_header"
                  i18n:translate="listingheader_assignees">
                Assignee(s)
              </th>
              <td>
                <ul class="xm-assignees">
                  <li tal:repeat="item task/assignees"><span tal:replace="item/niceName">Assignee</span></li>
                </ul>
              </td>
            </tr>
          </table>

          <div class="visualClear"><!-- --></div>
        </div>

        <metal:field use-macro="python:here.widget('mainText', mode='view')">
          Body text
        </metal:field>

        <div id="break-before-bookings" class="visualClear"><!-- --></div>

        <div tal:replace="structure provider:plone.belowcontentbody" />
      </tal:main-macro>
      <metal:block metal:define-macro="folderlisting" />
    </metal:main>
  </body>
</html>
