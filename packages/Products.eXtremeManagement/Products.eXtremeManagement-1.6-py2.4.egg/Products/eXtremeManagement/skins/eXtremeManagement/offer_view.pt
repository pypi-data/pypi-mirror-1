<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eXtremeManagement">

  <body>

    <div metal:fill-slot="main">
      <div metal:define-macro="body"
           tal:define="view context/@@offer;
                       iteration view/main;
                       stories view/stories;
                       start context/getStartDate;
                       end context/getEndDate;">


        <div class="xm-details"
             tal:condition="python: start or end">

          <table class="listing"
                 width="100%"
                 cellpadding="0"
                 cellspacing="0">
            <tr tal:condition="start">
              <th class="customer_info_header"
                  i18n:translate="estimated_start_project">Estimated start of project</th>
              <td>
                <metal:field use-macro="python:here.widget('startDate',
                                        mode='view')">
                  Variable goes here
                </metal:field>
              </td>
            </tr>
            <tr tal:condition="end">
              <th class="customer_info_header"
                  i18n:translate="estimated_release_date">Estimated release date</th>
              <td>
                <metal:field use-macro="python:here.widget('endDate',
                                        mode='view')">
                  Variable goes here
                </metal:field>
              </td>
            </tr>

          </table>

          <div class="visualClear"><!-- --></div>
        </div>

        <p class="documentDescription">
          <metal:field use-macro="python:here.widget('description', mode='view')">
            Description
          </metal:field>
        </p>


        <div id="break-before-stories" class="visualClear"><!-- --></div>

        <tal:subitems tal:condition="stories">
          <div id="offerViewHeader">
            <h2 class="offer-story-estimate-header"
                i18n:translate="listingheader_initial_estimate">
              Initial estimate (days)
            </h2>
            <h2 i18n:translate="heading-stories"
                class="offer-story-header">Stories</h2>
            <div class="visualClear" />
          </div>

          <table width="100%"
                 cellpadding="0"
                 cellspacing="0"
                 id="offerView">
            <tbody valign="top">
              <tal:repeat repeat="story stories">
                <tr class="storyTitle-storyEstimate">
                  <td>
                    <h2>
                      <span tal:replace="story/title" />
                      <span class=""
                            tal:attributes="class story/draft_class"
                            tal:condition="story/show_draft_story">
                        (<span i18n:domain="plone"
                        i18n:translate="Draft">Draft</span>)
                      </span>
                      <a href=""
                         tal:condition="story/editable"
                         tal:attributes="href string:${story/url}/edit">
                        <img src="edit.gif" alt="Edit" title="Edit"
                             i18n:domain="plone"
                             i18n:attributes="alt;
                                              title"/>
                      </a>
                    </h2>
                  </td>
                  <td class="offer-story-estimate">
                    <h2 class=""
                        tal:condition="story/size_estimate"
                        tal:attributes="class story/draft_class"
                        tal:content="story/size_estimate" />
                    <tal:empty condition="not: story/size_estimate">
                      &nbsp;
                    </tal:empty>
                  </td>
                </tr>
                <tr>
                  <td colspan="2"
                      class="offer-story-text"
                      tal:content="structure story/main_text" />
                </tr>
              </tal:repeat>
            </tbody>

            <tfoot id="totalTasks">
              <tr>
                <td class="offer-story-title-footer"
                    i18n:translate="total">Total</td>
                <td class="offer-story-estimate-footer"
                    tal:content="iteration/size_estimate" />
              </tr>
            </tfoot>
          </table>
        </tal:subitems>

        <p class="discreet"
           tal:condition="python: not stories"
           i18n:translate="no_stories_published">
          No stories published yet!
        </p>
      </div>

      <metal:block metal:define-macro="folderlisting" />
    </div>
  </body>
</html>
