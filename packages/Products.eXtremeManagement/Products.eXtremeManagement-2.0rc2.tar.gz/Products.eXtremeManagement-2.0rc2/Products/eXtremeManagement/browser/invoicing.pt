<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eXtremeManagement">
  <head>
    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border', 0)" />
  </head>
  <body>

    <div metal:fill-slot="main"
         id="invoicing-overview">
      <h1 i18n:translate="label_invoicing_overview">
        Invoicing overview
      </h1>

      <table class="listing" tal:condition="view/projectlist">
        <tr>
          <th class="nosort" i18n:translate="listingheader_projects">
            Project
          </th>
          <th class="nosort" i18n:translate="listingheader_iteration">
            Iteration
          </th>
          <th class="nosort" i18n:translate="label_date_completed">
              Date completed
          </th>
          <th class="nosort" i18n:translate="label_hours_worked">
            Hours worked
          </th>
        </tr>

        <tal:projects tal:repeat="project view/projectlist">
          <tal:iterations tal:repeat="iteration project/iterations">
            <tr>
              <td>
                <a tal:content="project/title"
                   tal:attributes="title project/description;
                                   href project/url;"/>
              </td>
              <td>
                <a tal:content="iteration/title"
                   tal:attributes="title iteration/description;
                                   href iteration/url;"/>
              </td>
              <td tal:condition="not: iteration/completion_date"
                  class="right"> - </td>
              <td tal:condition="iteration/completion_date"
                  tal:content="python:context.toLocalizedTime(iteration['completion_date'],
                             long_format=0)"
                  class="right" />
              <td tal:content="iteration/actual"
                  class="right" />
            </tr>
          </tal:iterations>
        </tal:projects>
      </table>
      
      <p tal:condition="not: view/projectlist"
         i18n:translate="description_nothing_to_invoice">Nothing to invoice</p>

      <h2 i18n:translate="head_this_month"> Invoiced this month </h2>

      <table class="listing" tal:condition="view/invoicedlist">
        <thead>
          <tr>
            <th class="nosort" i18n:translate="listingheader_projects">
                Project
            </th>
            <th class="nosort" i18n:translate="listingheader_iteration">
                Iteration
            </th>
            <th class="nosort" i18n:translate="label_date_completed">
                Date completed
            </th>
            <th class="nosort" i18n:translate="label_hours_worked">
                Hours worked
            </th>
          </tr>
        </thead>
        <tfoot tal:condition="view/invoiced_total">
          <tr>
            <th colspan="3"
                i18n:translate="listingheader-total">
                Total
            </th>
            <td class="right total"
                tal:content="view/invoiced_total" />
          </tr>
        </tfoot>
        <tbody>
        <tal:projects tal:repeat="project view/invoicedlist">
          <tal:iterations tal:repeat="iteration project/iterations">
            <tr>
              <td>
                <a tal:content="project/title"
                   tal:attributes="title project/description;
                                   href project/url;"/>
              </td>
              <td>
                <a tal:content="iteration/title"
                   tal:attributes="title iteration/description;
                                   href iteration/url;"/>
              </td>
              <td tal:condition="not: iteration/completion_date"
                  class="right"> - </td>
              <td tal:condition="iteration/completion_date"
                  tal:content="python:context.toLocalizedTime(iteration['completion_date'],
                             long_format=0)"
                  class="right" />
              <td tal:content="iteration/actual"
                  class="right" />
            </tr>
          </tal:iterations>
        </tal:projects>
        </tbody>
      </table>

      <p tal:condition="not: view/invoicedlist"
         i18n:translate="description_nothing_invoiced">Nothing invoiced yet</p>

    </div>
  </body>
</html>