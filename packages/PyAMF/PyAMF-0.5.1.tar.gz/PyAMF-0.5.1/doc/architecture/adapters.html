<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adapter Framework &mdash; PyAMF - AMF for Python</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within PyAMF - AMF for Python"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/pyamf.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="PyAMF - AMF for Python" href="../index.html" />
    <link rel="up" title="Architecture" href="index.html" />
    <link rel="next" title="Attribute Control" href="attributecontrol.html" />
    <link rel="prev" title="Architecture" href="index.html" /> 
  </head>
  <body>  

    <div class="document">
<div>
<a class="toplogo" href="../index.html"><img src="../_static/logo.png" border="0"/></a>
</div>

      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="adapter-framework">
<h1>Adapter Framework<a class="headerlink" href="#adapter-framework" title="Permalink to this headline">¶</a></h1>
<div class="topic">
<p class="topic-title first">Introduction</p>
<p>The Adapter Framework allows PyAMF to integrate nicely with other Python
libraries. This includes setting up type conversions, class mappings, etc.</p>
</div>
<div class="section" id="adapters-overview">
<h2>Adapters Overview<a class="headerlink" href="#adapters-overview" title="Permalink to this headline">¶</a></h2>
<p>We currently have adapters for the following packages:</p>
<ul class="simple">
<li>Django</li>
<li>Google App Engine</li>
<li>SQLAlchemy</li>
<li><a class="reference external" href="http://www.python.org/doc/2.5.2/lib/types-set.html">sets</a> module</li>
<li><a class="reference external" href="http://www.python.org/doc/2.5.2/lib/module-decimal.html">decimal</a> module</li>
</ul>
</div>
<div class="section" id="how-it-works">
<h2>How It Works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>The adapter framework works silently in the background. This means that the user
does not need to specifically import the Django adapter module within PyAMF, it
is all handled in the background. It works by adding a module loader and finder
to sys.meta_path so it can intercept import calls and) to fire a callback when,
for example the <tt class="docutils literal"><span class="pre">django</span></tt> module is imported and accessed.</p>
<p>It is important to note that PyAMF does not load all the modules when
registering its adapters and therefore it doesn&#8217;t load modules that you
don&#8217;t use in your program.</p>
<p>So, code like this works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">http</span>
<span class="kn">import</span> <span class="nn">pyamf</span>
</pre></div>
</div>
<p>As well as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyamf</span>
<span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">http</span>
</pre></div>
</div>
<p>The adapter framework makes it easy to add other packages to the list, as PyAMF
matures.</p>
</div>
<div class="section" id="building-your-own-adapter">
<h2>Building Your Own Adapter<a class="headerlink" href="#building-your-own-adapter" title="Permalink to this headline">¶</a></h2>
<p>Your custom module:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre>1
2
3
4
5</pre></td><td class="code"><div class="highlight"><pre><span class="c"># mymodule.py</span>

<span class="k">class</span> <span class="nc">CustomClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>Glue code:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyamf.adapters</span> <span class="kn">import</span> <span class="n">register_adapter</span>


<span class="k">def</span> <span class="nf">when_imported</span><span class="p">(</span><span class="n">mod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is called immediately after mymodule has been imported.</span>
<span class="sd">    It configures PyAMF to encode a list when an instance of mymodule.CustomClass</span>
<span class="sd">    is encountered.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pyamf</span>

    <span class="n">pyamf</span><span class="o">.</span><span class="n">add_type</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">CustomClass</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>


<span class="n">register_adapter</span><span class="p">(</span><span class="s">&#39;mymodule&#39;</span><span class="p">,</span> <span class="n">when_imported</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>And you&#8217;re done!</p>
</div>
<div class="section" id="what-next">
<h2>What next?<a class="headerlink" href="#what-next" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://pyamf.org/newticket">Contributions</a> (including unit tests) are always
welcome!</p>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Adapter Framework</a><ul>
<li><a class="reference external" href="#adapters-overview">Adapters Overview</a></li>
<li><a class="reference external" href="#how-it-works">How It Works</a></li>
<li><a class="reference external" href="#building-your-own-adapter">Building Your Own Adapter</a></li>
<li><a class="reference external" href="#what-next">What next?</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Architecture</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="attributecontrol.html"
                                  title="next chapter">Attribute Control</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/architecture/adapters.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
Copyright &#169; 2007-2009 The <a href='http://pyamf.org'>PyAMF</a> Project
</div>

  </body>
</html>