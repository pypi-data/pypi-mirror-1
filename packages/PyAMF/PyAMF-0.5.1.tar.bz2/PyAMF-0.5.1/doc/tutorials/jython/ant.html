<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Ant &mdash; PyAMF - AMF for Python</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within PyAMF - AMF for Python"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/pyamf.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="PyAMF - AMF for Python" href="../../index.html" />
    <link rel="up" title="Jython" href="index.html" />
    <link rel="next" title="Swing" href="swing.html" />
    <link rel="prev" title="Jython" href="index.html" /> 
  </head>
  <body>  

    <div class="document">
<div>
<a class="toplogo" href="../../index.html"><img src="../../_static/logo.png" border="0"/></a>
</div>

      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ant">
<h1>Ant<a class="headerlink" href="#ant" title="Permalink to this headline">¶</a></h1>
<img alt="../../_images/ant-logo.gif" src="../../_images/ant-logo.gif" />
<div class="topic">
<p class="topic-title first">Introduction</p>
<p><a class="reference external" href="http://ant.apache.org">Apache Ant</a> is a Java-based build tool. Ant
build files are created using XML but it also support Python
scripts using <a class="reference external" href="http://jython.org">Jython</a>.</p>
<p>This howto was created using Jython 2.5.0 standalone, PyAMF 0.5,
Ant 1.7 and Java JDK 1.6.0_13 on Mac OSX 10.5.7.</p>
</div>
<div class="section" id="about-jsr-223">
<h2>About JSR-223<a class="headerlink" href="#about-jsr-223" title="Permalink to this headline">¶</a></h2>
<p>There are 2 ways to execute Python scripts in Ant:</p>
<ul class="simple">
<li>using <a class="reference external" href="http://jythonpodcast.hostjava.net/jythonbook/chapter10.html#jsr-223">JSR-223</a></li>
<li><a class="reference external" href="http://jythonpodcast.hostjava.net/jythonbook/chapter10.html#utilizing-pythoninterpreter">utilizing</a>
the <tt class="docutils literal"><span class="pre">PythonInterpreter</span></tt></li>
</ul>
<p>JSR-223 enables dynamic languages to be callable via Java in a seamless
manner, which is supported in Jython 2.2.1 and newer. This howto will
show you how to make use of the <tt class="docutils literal"><span class="pre">PythonInterpreter</span></tt> class directly.</p>
<p>This style of embedding code is very similar to making use of a
scripting engine, and it has the advantage of working with Jython 2.5
and newer. The JSR-223 requires the unreleased Jython 2.5.1 or newer.
In order to make use of the <tt class="docutils literal"><span class="pre">PythonInterpreter</span></tt> technique, you only
need to have the standalone <tt class="docutils literal"><span class="pre">jython.jar</span></tt> in your classpath, there
is no need to have an extra engine involved.</p>
</div>
<div class="section" id="application-setup">
<h2>Application Setup<a class="headerlink" href="#application-setup" title="Permalink to this headline">¶</a></h2>
<p>Start out with checking whether Apache Ant is working:</p>
<div class="highlight-bash"><div class="highlight"><pre>ant -version
</pre></div>
</div>
<p>Returns the version number:</p>
<div class="highlight-bash"><div class="highlight"><pre>Apache Ant version 1.7.0 compiled on May 21 2009
</pre></div>
</div>
<p>Grab the example project from SVN:</p>
<div class="highlight-bash"><div class="highlight"><pre>svn <span class="nb">export </span>http://svn.pyamf.org/pyamf/sandbox/thijs/jython-ant/2.5.0/embedded jython-ant
</pre></div>
</div>
<p>Copy <tt class="docutils literal"><span class="pre">jython.jar</span></tt> from your Jython 2.5 distribution folder
into the project&#8217;s <tt class="docutils literal"><span class="pre">jython</span></tt> folder. Make sure you installed
Jython 2.5 in standalone mode which produces a <tt class="docutils literal"><span class="pre">jython.jar</span></tt>
file that contains all necessary files for your application
to run without any other Jython dependencies:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd </span>jython-ant/jython
cp /path/to/jython2.5.0/jython.jar .
</pre></div>
</div>
<p>This <tt class="docutils literal"><span class="pre">jython</span></tt> folder is on the classpath of your application
so any other <tt class="docutils literal"><span class="pre">.jar</span></tt> files you may have go in here as well.</p>
<p>Now grab a copy of PyAMF and put it in the <tt class="docutils literal"><span class="pre">jython/Lib</span></tt>
folder:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd </span>Lib
svn <span class="nb">export </span>http://svn.pyamf.org/pyamf/trunk/pyamf
</pre></div>
</div>
</div>
<div class="section" id="run-application">
<h2>Run Application<a class="headerlink" href="#run-application" title="Permalink to this headline">¶</a></h2>
<p>Use Ant to build and run the application. This will do the
following for you:</p>
<ul class="simple">
<li>clean the <tt class="docutils literal"><span class="pre">build</span></tt> folder</li>
<li>compile the <tt class="docutils literal"><span class="pre">src/java/org/pyamf/HelloWorld.java</span></tt> class
containing the <tt class="docutils literal"><span class="pre">PythonInterpreter</span></tt></li>
<li>create a file called <tt class="docutils literal"><span class="pre">HelloWorld.jar</span></tt> in
<tt class="docutils literal"><span class="pre">build/classes/org/pyamf</span></tt> containing the compiled Java
<tt class="docutils literal"><span class="pre">.class</span></tt> file</li>
<li>run the <tt class="docutils literal"><span class="pre">HelloWorld.jar</span></tt> application</li>
<li>try to load the <tt class="docutils literal"><span class="pre">server.py</span></tt> script that contains the
PyAMF remoting gateway for WSGI</li>
</ul>
<p>Go to the project&#8217;s base folder and run Ant:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ../..
ant
</pre></div>
</div>
<p>This should print the build progress and application output:</p>
<div class="highlight-bash"><div class="highlight"><pre>Buildfile: build.xml

clean:

compile:
  <span class="o">[</span>mkdir<span class="o">]</span> Created dir: /path/to/jython-ant/build/classes
  <span class="o">[</span>javac<span class="o">]</span> Compiling 1 <span class="nb">source </span>file to /path/to/jython-ant/build/classes

jar:
  <span class="o">[</span>mkdir<span class="o">]</span> Created dir: /path/to/jython-ant/build/jar
    <span class="o">[</span>jar<span class="o">]</span> Building jar: /path/to/jython-ant/build/jar/HelloWorld.jar

run:
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/path/to/jython-ant/jython/jython.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/path/to/jython-ant/build/jar/HelloWorld.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/classes.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/ui.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/laf.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/jsse.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/jce.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Classes/charsets.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/AppleScriptEngine.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/CoreAudio.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/dns_sd.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/j3daudio.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/j3dcore.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/j3dutils.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/jai_codec.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/jai_core.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/mlibwrapper_jai.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/MRJToolkit.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/QTJava.zip&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Java/Extensions/vecmath.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/ext/apple_provider.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/ext/dnsns.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/ext/localedata.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/ext/sunjce_provider.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> *sys-package-mgr*: processing new jar, <span class="s1">&#39;/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/ext/sunpkcs11.jar&#39;</span>
   <span class="o">[</span>java<span class="o">]</span> Running AMF gateway on http://localhost:8000
</pre></div>
</div>
<p>The first time you run Ant it also includes some caching messages from Jython
that start with <tt class="docutils literal"><span class="pre">*sys-package-mgr*:</span> <span class="pre">processing</span> <span class="pre">new</span> <span class="pre">jar</span></tt>.
The default folder where these cache files are stored is <tt class="docutils literal"><span class="pre">jython/cachedir</span></tt>.</p>
<p>The final line shows your AMF gateway is up and running.</p>
</div>
<div class="section" id="clients">
<h2>Clients<a class="headerlink" href="#clients" title="Permalink to this headline">¶</a></h2>
<div class="section" id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<p>Run <tt class="docutils literal"><span class="pre">client.py</span></tt> in <tt class="docutils literal"><span class="pre">src/python/</span></tt> which should print:</p>
<div class="highlight-bash"><div class="highlight"><pre>2009-07-20 00:00:32,669 INFO  <span class="o">[</span>root<span class="o">]</span> Connecting to http://localhost:8000
2009-07-20 00:00:32,783 INFO  <span class="o">[</span>root<span class="o">]</span> Hello world!
</pre></div>
</div>
<p>And the server running in Ant should show some debug information:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>java<span class="o">]</span> 2009-07-19 23:48:59,756 DEBUG <span class="o">[</span>root<span class="o">]</span> remoting.decode start
<span class="o">[</span>java<span class="o">]</span> 2009-07-19 23:49:00,190 DEBUG <span class="o">[</span>root<span class="o">]</span> Remoting target: u<span class="s1">&#39;echo.echo&#39;</span>
<span class="o">[</span>java<span class="o">]</span> 2009-07-19 23:49:00,223 DEBUG <span class="o">[</span>root<span class="o">]</span> remoting.decode end
<span class="o">[</span>java<span class="o">]</span> 2009-07-19 23:49:00,232 INFO  <span class="o">[</span>root<span class="o">]</span> AMF Request: &lt;Envelope <span class="nv">amfVersion</span><span class="o">=</span>0 <span class="nv">clientType</span><span class="o">=</span>0&gt;
<span class="o">[</span>java<span class="o">]</span>  <span class="o">(</span>u<span class="s1">&#39;/1&#39;</span>, &lt;Request <span class="nv">target</span><span class="o">=</span>u<span class="s1">&#39;echo.echo&#39;</span>&gt;<span class="o">[</span>u<span class="s1">&#39;Hello world!&#39;</span><span class="o">]</span>&lt;/Request&gt;<span class="o">)</span>
<span class="o">[</span>java<span class="o">]</span> &lt;/Envelope&gt;
<span class="o">[</span>java<span class="o">]</span> 2009-07-19 23:49:00,323 INFO  <span class="o">[</span>root<span class="o">]</span> AMF Response: &lt;Envelope <span class="nv">amfVersion</span><span class="o">=</span>0 <span class="nv">clientType</span><span class="o">=</span>0&gt;
<span class="o">[</span>java<span class="o">]</span>  <span class="o">(</span>u<span class="s1">&#39;/1&#39;</span>, &lt;Response <span class="nv">status</span><span class="o">=</span>/onResult&gt;u<span class="s1">&#39;Hello world!&#39;</span>&lt;/Response&gt;<span class="o">)</span>
<span class="o">[</span>java<span class="o">]</span> &lt;/Envelope&gt;
<span class="o">[</span>java<span class="o">]</span> 127.0.0.1 - - <span class="o">[</span>19/Jul/2009 23:49:00<span class="o">]</span> <span class="s2">&quot;POST / HTTP/1.1&quot;</span> 200 44
</pre></div>
</div>
</div>
<div class="section" id="flash">
<h3>Flash<a class="headerlink" href="#flash" title="Permalink to this headline">¶</a></h3>
<p>The Hello World Flash examples should all work with this example&#8217;s <tt class="docutils literal"><span class="pre">server.py</span></tt>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Ant</a><ul>
<li><a class="reference external" href="#about-jsr-223">About JSR-223</a></li>
<li><a class="reference external" href="#application-setup">Application Setup</a></li>
<li><a class="reference external" href="#run-application">Run Application</a></li>
<li><a class="reference external" href="#clients">Clients</a><ul>
<li><a class="reference external" href="#python">Python</a></li>
<li><a class="reference external" href="#flash">Flash</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Jython</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="swing.html"
                                  title="next chapter">Swing</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/tutorials/jython/ant.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
Copyright &#169; 2007-2009 The <a href='http://pyamf.org'>PyAMF</a> Project
</div>

  </body>
</html>