
<!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module pyviblib.calc.qtrfit</title>
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="pyviblib.html"><font color="#ffffff">pyviblib</font></a>.<a href="pyviblib.calc.html"><font color="#ffffff">calc</font></a>.qtrfit</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/usr/lib/python2.4/site-packages/pyviblib/calc/qtrfit.py">/usr/lib/python2.4/site-packages/pyviblib/calc/qtrfit.py</a></font></td></tr></table>
    <p><tt>Superimpose&nbsp;molecules&nbsp;using&nbsp;a&nbsp;quaternion&nbsp;fit.<br>
&nbsp;<br>
This&nbsp;is&nbsp;a&nbsp;Python&nbsp;port&nbsp;of&nbsp;the&nbsp;QTRFIT&nbsp;algorithm&nbsp;written&nbsp;by&nbsp;David&nbsp;J.&nbsp;Heisterberg.<br>
Copyright:&nbsp;Ohio&nbsp;Supercomputer&nbsp;Center,&nbsp;David&nbsp;J.&nbsp;Heisterberg,&nbsp;1990.<br>
See&nbsp;<a href="http://www.ccl.net/cca/software/SOURCES/C/quaternion-mol-fit/quatfit.c">http://www.ccl.net/cca/software/SOURCES/C/quaternion-mol-fit/quatfit.c</a>.<br>
&nbsp;<br>
There&nbsp;is,&nbsp;however,&nbsp;a&nbsp;subtle&nbsp;difference&nbsp;between&nbsp;this&nbsp;implementation&nbsp;and&nbsp;the<br>
original&nbsp;one.&nbsp;It&nbsp;lies&nbsp;in&nbsp;a&nbsp;way&nbsp;how&nbsp;the&nbsp;center&nbsp;of&nbsp;a&nbsp;molecule&nbsp;is&nbsp;calculated.&nbsp;We<br>
use&nbsp;the&nbsp;plain&nbsp;weighting&nbsp;coefficients&nbsp;rather&nbsp;than&nbsp;square&nbsp;roots&nbsp;from&nbsp;them.&nbsp;This<br>
corresponds&nbsp;to&nbsp;physically&nbsp;meaningful&nbsp;results.<br>
&nbsp;<br>
The&nbsp;module&nbsp;exports&nbsp;the&nbsp;only&nbsp;function&nbsp;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#-fit">fit</a>()&nbsp;--&nbsp;&nbsp;perform&nbsp;a&nbsp;quaternion&nbsp;fit</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-fit"><strong>fit</strong></a>(pairs, coords_ref, coords_fit, weight)</dt><dd><tt>Perform&nbsp;a&nbsp;quaternion&nbsp;fit.<br>
&nbsp;<br>
Positional&nbsp;arguments&nbsp;:<br>
pairs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;atom&nbsp;pairs&nbsp;to&nbsp;be&nbsp;superimposed&nbsp;(null-based&nbsp;ndarray)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape&nbsp;:&nbsp;(npairs,&nbsp;2)&nbsp;with&nbsp;npairs&nbsp;being&nbsp;the&nbsp;number&nbsp;of&nbsp;atom&nbsp;pairs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;atom&nbsp;numbers&nbsp;are&nbsp;one-based<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;:&nbsp;array([&nbsp;[1,&nbsp;1],&nbsp;[5,&nbsp;5],&nbsp;[7,&nbsp;7]&nbsp;])<br>
coords_ref&nbsp;&nbsp;--&nbsp;&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;reference&nbsp;frame&nbsp;(one-based&nbsp;ndarray)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape&nbsp;:&nbsp;(Natoms_ref,&nbsp;4)&nbsp;with&nbsp;Natoms_ref&nbsp;being&nbsp;the&nbsp;number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;atoms&nbsp;in&nbsp;the&nbsp;reference&nbsp;frame<br>
coords_fit&nbsp;&nbsp;--&nbsp;&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;fitted&nbsp;frame&nbsp;(one-based&nbsp;ndarray)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape&nbsp;:&nbsp;(Natoms_fit,&nbsp;4)&nbsp;with&nbsp;Natoms_fit&nbsp;being&nbsp;the&nbsp;number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;atoms&nbsp;in&nbsp;the&nbsp;fitted&nbsp;frame<br>
weight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;weights&nbsp;for&nbsp;the&nbsp;atoms&nbsp;to&nbsp;be&nbsp;superimposed&nbsp;(one-based&nbsp;ndarray)<br>
&nbsp;<br>
Return&nbsp;value&nbsp;is&nbsp;a&nbsp;dictionary&nbsp;with&nbsp;the&nbsp;following&nbsp;keys&nbsp;:<br>
rms&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;root&nbsp;mean&nbsp;square&nbsp;(RMS)&nbsp;deviation&nbsp;<br>
q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;quaternion&nbsp;(null-based&nbsp;ndarray&nbsp;of&nbsp;the&nbsp;length&nbsp;4)<br>
U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;left&nbsp;rotation&nbsp;matrix&nbsp;(one-based&nbsp;two-dimensional&nbsp;ndarray)<br>
ref_center&nbsp;&nbsp;:&nbsp;center&nbsp;of&nbsp;the&nbsp;reference&nbsp;molecule&nbsp;(one-based&nbsp;ndarray)<br>
fit_center&nbsp;&nbsp;:&nbsp;center&nbsp;of&nbsp;the&nbsp;fitted&nbsp;molecule&nbsp;(one-based&nbsp;ndarray)</tt></dd></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>__all__</strong> = ['fit']<br>
<strong>__author__</strong> = 'Maxim Fedorovsky'</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#7799ee">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Author</strong></big></font></td></tr>
    
<tr><td bgcolor="#7799ee"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%">Maxim&nbsp;Fedorovsky</td></tr></table>
</body></html>