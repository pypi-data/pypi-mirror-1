{% extends "person/master.html"%}

{% block title %}
  {% if isSessionPerson %}
    {{ person.getLabelValue }} - Your page
  {% else %}
    {% if person %}
    {{ person.getLabelValue }} - Profile
    {% else %}
    Profile - No name specified!
    {% endif %}
  {% endif %}
{% endblock %}

{% block content %}

  {% if isSessionPerson %}
    <h2>Welcome, {{ person.getFirstName }}</h2>
    <p><strong>Login name:</strong> {{ person.name }}</p>
    <p><strong>Registered name:</strong> {{ person.fullname }}</p>
    <p><strong>Registered email:</strong> {{ person.email }}</p>
    <p>
      This page gives you an overview of the projects you&rsquo;re associated with, and other useful information about your {{ systemServiceName }} account.
    </p>
      {% if canUpdatePerson %}
    <form action="{{uriPrefix}}/person/{{ person.name }}/edit/" method="post">
      <strong>Do you wish to edit this profile?</strong><br />
      <p>
        <input type="submit" value="Edit profile" />
      </p>
    </form>
      {% endif %}
      {% if canDeletePerson %}
    <form action="{{uriPrefix}}/person/{{ person.name }}/delete/" method="post">
      <strong>Do you wish to delete your account?</strong><br />
      <p>
        <input type="submit" value="Delete account" />
      </p>
    </form>
      {% endif %}
  {% else %}
    {% if person %}
    <h2>{{ person.getFirstName }}&rsquo;s profile page</h2>
    <p>
      This is the profile page for {{ person.getLabelValue }}.
    </p>
    <h3>{{ person.getFirstName }}&rsquo;s projects</h3>
    <ul>
      {% for member in person.memberships %}
      <li><a href="{{uriPrefix}}/project/{{ member.project.name }}/">{{member.project.getLabelValue}}</a></li>
      {% endfor %}
    </ul>
    {% else %}
    <h2>No name specified</h2>
    <p class="flash-error">
      You'll need to <a href="{{uriPrefix}}/person/">select a user</a> in order to see a user's profile page.<br />
      <br />
      If you were looking for your profile page, please <a href="{{uriPrefix}}/login/">log in</a>.
    </p>
    {% endif %}
  {% endif %}  

{% endblock %}

{% block primarysidebar %}
  {% if isSessionPerson %}
    <div class="box">
      <h2>Your Projects</h2>
      <ul>
      {% for member in person.memberships %} 
        <li><a href="{{uriPrefix}}/project/{{ member.project.name }}/">{{ member.project.title }}</a></li>
      {% endfor %}
      </ul>
      <ul>
        <li><a href="{{uriPrefix}}/project/create/">Register new project</a></li>
        <li><a href="{{uriPrefix}}/project/">Join project</a></li>
      </ul>
    </div>
  {% endif %}
<div class="box">
  <h2>Using KForge</h2>
  <ul>
    <li><a href="http://www.kforgeproject.com/doc/">Documentation</a></li>
    <li><a href="http://lists.okfn.org/mailman/listinfo/kforge-user">KForge-User Mailing list</a></li>
  </ul>
</div>
{% endblock %}
