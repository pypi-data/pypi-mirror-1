<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      xml:lang="en"
      lang="en"
      i18n:domain="absence">
  <body>
    <div metal:fill-slot="main">

      <h1 i18n:translate="head_absencelist">
        Absencelist
      </h1>
      <p class="discreet"
         i18n:translate="label_most_recent_first">
        Most recent first
      </p>

      <div class="alternative-absence-views"
           tal:define="current_absence context/@@plonehrm.absence/get_current_absence;">
        <tal:current condition="nocall:current_absence">
          <a tal:attributes="href current_absence/absolute_url"
             i18n:translate="label_current_case">Current case</a>
          |
        </tal:current>
        <span i18n:translate="label_complete_history">Complete history</span>
      </div>

      <table
         tal:define="absencelist view/get_absence_list"
         tal:condition="absencelist"
         class="absencelist listing"
         cellspacing="0"
         cellpadding="0">
        <tal:block define="toLocalizedTime nocall:context/@@plone/toLocalizedTime;">
          <thead>
            <tr class="notedate-absencelist-header">
              <th nowrap="true"
                  i18n:translate="heading_reason">Reason</th>
              <th nowrap="true"
                  i18n:translate="heading_absent_since">Absent since</th>
              <th nowrap="true"
                  i18n:translate="heading_working_since">Working since</th>
              <th nowrap="true"
                  i18n:translate="heading_days_absent">Days absent</th>
              <th nowrap="true"
                  i18n:translate="heading_accident">Due to an accident</th>
            </tr>
          </thead>
          <tbody>
            <tal:block tal:repeat="absence absencelist">
              <tr tal:define="oddrow repeat/absence/odd;"
                  tal:attributes="class python:oddrow and 'even' or 'odd'">
		<td tal:define="health_class python:absence.end_date and 'employee_healthy' or 'employee_sick'"
                    tal:attributes="class string:contenttype-absence ${health_class}">
                  <a tal:content="absence/text"
                     tal:attributes="href absence/absolute_url" />
		</td>
		<td class="notedate-absencelist" nowrap="true">
                  <span tal:replace="python:toLocalizedTime(absence.start_date.isoformat())">
                    10-8-2007
                  </span>
		</td>
		<td class="notedate-absencelist" nowrap="true">
                  <tal:end_date condition="absence/end_date|nothing">
                    <span tal:replace="python:toLocalizedTime(absence.end_date.isoformat())">
                      10-8-2007
                    </span>
                  </tal:end_date>
		</td>
		<td class="notedate-absencelist" nowrap="true">
                  <tal:oneday tal:condition="python:absence.days_absent() == 1">
                    <span i18n:translate="label_one_day">1 day</span>
                  </tal:oneday>
                  <tal:days tal:condition="python:absence.days_absent() != 1">
                    <span i18n:translate="label_days">
                      <span i18n:name="number" tal:content="absence/days_absent"/>
                      days
                    </span>
                  </tal:days>
		</td>
		<td>
		  <span tal:condition="absence/getIs_accident"
			i18n:domain="plone"
			i18n:translate="Yes">Yes</span>
		</td>
              </tr>
            </tal:block>
          </tbody>
        </tal:block>
      </table>
    </div>
  </body>
</html>
