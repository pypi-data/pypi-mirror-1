<metal:block metal:define-macro="listed_audio"
             i18n:domain="p4a.audio">
  <div class="media-item"
       tal:define="audioobj audioobj|options/audioobj|nothing;
                   audio audio|options/audio|python:view.safe_audio(audioobj);
                   viewurl string:${audio/url}/view;
                   oddeven oddeven|audio/oddeven|string:;
                   portal_url portal_url|view/portal_url;
                   playerdir string:$portal_url/++resource++audioplayer"
       tal:attributes="class string:media-item ${audio/oddeven}">
    <div class="item-left">
      <dl>
        <dt class="album-art" i18n:translate="label_album_art">Album Art:</dt>
        <dd class="album-art">
          <a href="" tal:attributes="href string:$viewurl"
             tal:condition="audio/has_image"
            ><img tal:attributes="src audio/imageurlwidget"
                  alt="Audio Album Art" /></a>
          <span class="no-album-art"
                tal:condition="not:audio/has_image" i18n:translate="label_no_album_art">No album art</span>
        </dd>
        <dt i18n:translate="label_track_length">Time:</dt>
        <dd tal:content="audio/length">8:30</dd>
        <dt class="type-audio" i18n:translate="label_file_type">Type:</dt>
        <dd class="type-audio" i18n:translate="file_type">Audio</dd>
      </dl>
      <div class="visualClear"><!-- --></div>
    </div>
    <div class="item-content">
      <h2 class="item-title">
        <a tal:content="audio/title"
           tal:attributes="href viewurl">Audio Title</a>
        <span  class="relevance" 
               tal:condition="python:audio['relevance'] is not None">
          [<span tal:replace="audio/relevance" />%]
        </span>
      </h2>
      <p class="author-byline" i18n:translate="label_posted">Posted <span tal:replace="audio/creation_time" i18n:name="date"/> by <a href=""
         tal:attributes="href string:$portal_url/author/${audio/content_author}"
         tal:content="audio/content_author_name" i18n:name="author"/></p>

      <div class="media-player">
        <object type="application/x-shockwave-flash"
                data="http://www.fakedomain.com/myname/audio/player.swf"
                id="audioplayer2" 
                tal:attributes="data string:${playerdir}/player.swf; 
                                id string:audioplayer${audio/player_count}"
                height="24" width="290">
          <param name="movie"
                 value="http://www.fakedomain.com/myname/audio/player.swf" 
                 tal:attributes="value string:${playerdir}/player.swf" />
          <param name="FlashVars"
                 value="playerID=2&amp;soundFile=http://www.fakedomain.com/myname/audio/other.mp3" 
                 tal:attributes="value string:playerID=${audio/player_count}&amp;soundFile=${audio/url}" />
          <param name="quality" value="high" />
          <param name="menu" value="false" />
          <param name="wmode" value="transparent" />
        </object>
      </div>
      <p class="item-description">
        <span tal:replace="audio/description"></span>
                &nbsp;&nbsp;<a href=""
                               tal:attributes="href viewurl" i18n:translate="label_more">More</a>
      </p>

      <dl>
        <tal:block tal:condition="view/has_contenttagging_support">
          <dt class="tag" i18n:translate="label_tags">Tags:</dt>
          <dd class="tag" tal:repeat="tag audio/tags">
            <a href=""
               tal:attributes="href tag/url"
               tal:content="tag/name">sometag</a>
          </dd>
        </tal:block>
        <tal:block tal:condition="view/has_contentrating_support">
          <dt class="rating" i18n:translate="label_ratings">Ratings:</dt>
          <dd tal:define="avg audio/avgrating;
                          stars python:range(1, 6);
                          star_icon string:/++resource++star_icon.gif;
                          blank_star_icon string:/++resource++blank_star_icon.gif;">
<span tal:content="audio/rating_count"/> <i18n:span i18n:translate="label_ratings_count">rating(s)</i18n:span> &nbsp;&nbsp;
            <img tal:repeat="star python:range(1, 6)"
                 tal:attributes="src python:avg &lt; star and blank_star_icon or star_icon;
              alt star" />
          </dd>
        </tal:block>
        <dt class="commenting" i18n:translate="label_comments"
          tal:condition="audio/commenting_allowed">Comments:</dt>
        <dd tal:condition="audio/commenting_allowed">
          <a href="" tal:attributes="href viewurl">
          <span tal:replace="audio/commenting_count"></span>
          <i18n:span i18n:translate="label_comments_count">comment(s)</i18n:span></a>
        </dd>
      </dl>
      <div class="visualClear"><!-- --></div>
    </div>
    <div class="visualClear"><!-- --></div>
  </div>
</metal:block>
