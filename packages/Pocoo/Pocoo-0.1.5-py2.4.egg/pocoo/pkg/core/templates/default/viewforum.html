{% extends "layout/navigation.html" %}
{* vim: set et ai ts=2 sw=2 enc=utf-8: *}

{% block "title" %}{% trans "View Forum" %} - {{ forum.name|e }}{% endblock %}
{% block "html/head" %}
  <link rel="alternate" href="{{ feed_url }}" type="application/rss+xml" />
{% endblock %}

{% block "trace" %}
  &raquo;
  {% for item in pathbar %}
    <a href="{{ item.url }}">{{ item.name|e }}</a> {% if not loop.last %}&raquo;{% endif %}
  {% endfor %}
{% endblock %}

{% block "content" %}
  <table class="forumlist">
    <tr class="row_head">
      <th colspan="3">{{ forum.name|e }}</th>
    </tr>
    <tr>
      <td colspan="3" class="description">
        {{ forum.description|e }}
      </td>
    </tr>

    {% if forum.forums %}
      {% define forums forum.forums %}
      {% include "partial/forum.html" %}
    {% endif %}

    <tr>
      <td colspan="3" class="description">
        <a href="{{ forum.url }}/new">{% trans "Create new thread" %}</a>
      </td>
    </tr>
  </table>

  <table class="threadlist">
    <tr>
      <th>{% trans "Threads" %}</th>
      <th class="count">{% trans "Posts/Views" %}</th>
      <th class="last">{% trans "Last Post" %}</th>
    </tr>
    {% for thread in forum.threads %}
      {% cycle cls through "row1", "row2" %}
      <tr class="row {{ cls }}">
        <td class="thread">
          <a href="{{ thread.url }}">{{ thread.title|e }}</a>
          {% trans "by" %}
          {% if thread.author.registered %}
            <a href="{{ thread.author.url }}">{{ thread.author.username|e }}</a>
          {% else %}
            {{ thread.author.username|e }}
          {% endif %}
        </td>
        <td class="count">
          {{ thread.post_count }}/{{ thread.view_count }}
        </td>
        <td class="last">
          {% trans "by" %}
          {% if thread.last_post.author.registered %}
            <a href="{{ thread.last_post.author.url }}">{{ thread.last_post.author.username|e }}</a>
          {% else %}
            {{ thread.last_post.author.username|e }}
          {% endif %}
          (<a href="{{ thread.last_post.url }}">{{ thread.last_post.timestamp|timedeltaformat }}</a>)
        </td>
      </tr>
    {% elsefor %}
      <tr class="empty">
        <td colspan="3">{% trans "No threads found" %}</td>
      </tr>
    {% endfor %}
  </table>

  <div class="pagination">
    <strong>{% trans 'Go to Page' %}:</strong>&nbsp;&nbsp;
    {% paginate forum.pagination
         '<a href="%(url)s">%(page)s</a>',
         '<strong>%(page)s</strong>',
         ', ',
         '&nbsp;&nbsp;...&nbsp;&nbsp;'
    %}
  </div>

{% endblock %}
