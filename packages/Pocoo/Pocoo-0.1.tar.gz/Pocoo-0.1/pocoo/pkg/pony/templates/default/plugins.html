<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>Pocoo PluginPony</title>
    <link rel="stylesheet" href="{{ system.template.cobalt }}/pony/default/style/screen.css" type="text/css"/>
    <script type="text/javascript">
      function toggle(obj) {
        var box = obj.nextSibling.nextSibling;
        if (box && box.style) {
          var cur = box.style.display;
          box.style.display = (cur == '') ? 'table-row' : '';
        }
      }

      function toggleall(obj) {
        var parent = obj.parentNode.parentNode;
        var nodes = parent.getElementsByTagName('TR');
        for (var i = 0; i < nodes.length; i++) {
          toggle(nodes[i]);
        }
      }
    </script>
  </head>
  <body>
    <div class="box">
      <h1>PluginPony</h1>
      <p style="text-align: right"><a href="#" onclick="toggleall(this)">Toggle all</a></p>
      <p>List of installed packages:</p>
      <table class="pluginlist">
        <tr><th style="padding-right: 10px">loaded</th>
          <th style="width: 100%">Package Name</th>
        </tr>

        {% for package in packages %}
        <tr class="item" onclick="toggle(this)">
          <td>{% if package.loaded %}&nbsp;<strong>*</strong>{% else %}&nbsp;{% endif %}</td>
          <td><strong>{{ package.name|e }}</strong></td>
        </tr>
        {% if package.loaded %}
        <tr class="explanation">
          <td>&nbsp;</td>
          <td><table>
              <tr><td>Full name</td><td>{{ package.fullname|e }}</td></tr>
              <tr><td>Path</td><td>{{ package.path|e }}</td></tr>
              <tr><td>Description</td><td>{{ package.description|e }}</td></tr>
              <tr><td>Author</td><td>{{ package.author|e }}</td></tr>
              {% if package.revision %}<tr><td>Revision</td><td>{{ package.revision|e }}</td></tr>{% endif %}
              <tr><td>Version</td>
                <td>{% for vi in package.version %}{{ vi }}{% if not loop.last %}.{% endif %}{% endfor %}</td></tr>
              <tr><td>Dependencies</td>
                <td>{% for dep in package.depends %}
                  {{ dep }}{% if not loop.last %}, {% endif %}
                  {% elsefor %}none{% endfor %}</td></tr>
          </table></td>
        </tr>
        {% else %}
        <tr class="explanation">
          <td>&nbsp;</td><td>(package not loaded)</td>
        </tr>
        {% endif %}
        {% endfor %}
      </table>

      <p>List of plugin types:</p>
      <table class="pluginlist">
        <tr><th style="padding-right: 10px">&nbsp;&nbsp;</th>
          <th style="width: 100%">Component Type Name</th>
        </tr>

        {% for plugin in plugintypes %}
        <tr class="item" onclick="toggle(this)">
          <td>&nbsp;</td>
          <td><strong>{{ plugin.name|e }}</strong></td>
        </tr>
        <tr class="explanation">
          <td>&nbsp;</td>
          <td>
          <table>
            <tr><td>Module</td><td>{{ plugin.module }}</td></tr>
            <tr><td>Plugins</td><td>{% for plug in plugin.plugins %}
                {{ plug|e }}{% if not loop.last %},{% endif %}
                {% endfor %}</td></tr>
            {% if plugin.doc %}<tr><td>Docstring</td><td>{{ plugin.doc }}</td></tr>{% endif %}
          </table>
          </td>
        </tr>
        {% endfor %}
      </table>

      <p>List of registered plugins:</p>
      <table class="pluginlist">
        <tr><th style="padding-right: 10px">Pkg&nbsp;&nbsp;</th>
          <th style="width: 100%">Component Name</th>
        </tr>

        {% for plugin in plugins %}
        <tr class="item" onclick="toggle(this)">
          <td>{{ plugin.package|e }}</td>
          <td><strong>{{ plugin.name|e }}</strong></td>
        </tr>
        <tr class="explanation">
          <td>&nbsp;</td>
          <td>
          <table>
            <tr><td>Package</td><td>{{ plugin.package|e }}</td></tr>
            <tr><td>Types</td><td>{% for type in plugin.types %}
                {{ type|e }}{% if not loop.last %},{% endif %}
                {% endfor %}</td></tr>
            {% if plugin.doc %}<tr><td>Docstring</td><td>{{ plugin.doc }}</td></tr>{% endif %}
          </table>
          </td>
        </tr>
        {% endfor %}
      </table>
      <p>List of registered URL regular expressions:</p>
      <dl>
      {% for regex in regexes %}
        <dt><tt>{{ regex.regex|e }}</tt>
            <span style="font-size: x-small">{{ regex.package|e }}</span></dt>
        <dd>{{ regex.component|e }}</dd>
      {% endfor %}
      </dl>
    </div>
  </body>
</html>
