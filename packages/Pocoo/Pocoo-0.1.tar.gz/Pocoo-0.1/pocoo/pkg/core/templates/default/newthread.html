{% extends "layout/navigation.html" %}
{* vim: set et ai ts=2 sw=2 enc=utf-8: *}

{% block "html/head" %}
  <script type="text/javascript" src="{{ system.template.cobalt }}/core/pocoo/app/NewPostPage.js"></script>
  <script type="text/javascript" src="{{ editor_javascript }}"></script>
  <script type="text/javascript">
    var editor_options = {{ editor_options|e }};
  </script>
{% endblock %}

{% block "title" %}{% trans "New Thread" %}{% endblock %}

{% block "trace" %}
  &raquo;
  {% for item in pathbar %}
    <a href="{{ item.url }}">{{ item.name|e }}</a> &raquo;
  {% endfor %}
  {% trans "New Thread" %}
{% endblock %}

{% block "bodytag" %} onload="initEditor('text', 'toolbar', 'preview', 'prev_text', editor_options)"{% endblock %}
{% block "content" %}
  {% prepare 'errorbox' accepting errors %}
    {% if errors %}
      <ul class="errors">
      {% for error in errors %}
        <li>{{ error|e }}</li>
      {% endfor %}
      </ul>
    {% endif %}
  {% endprepare %}

{% if system.conf.messages.newpostnotice %}
  <div class="dialog">
    <h2>Notice</h2>
    <div class="text">
      {{ system.conf.messages.newpostnotice|e }}
    </div>
  </div>
{% endif %}

<form action="{{ form.action }}" method="{{ form.method }}">
  <div class="editor">
    <h1>
      {% trans "Create new thread" %}
    </h1>
    <div class="text">
      {% if show_username_entry %}
        {% trans "Username" %}:
        <input type="text" name="{{ form.username.name }}" value="{{ form.username.value|e }}" />
        {% call 'errorbox' form.username.errors %}<br />
      {% endif %}
      {% trans "Title" %}:
        <input type="text" name="{{ form.title.name }}" value="{{ form.title.value|e }}" />
      {% call 'errorbox' form.title.errors %}<br />
      <div id="toolbar"></div><br style="clear: both;" />
      {% trans "Text" %}:<br />
      <textarea class="full" name="{{ form.text.name }}" id="text">{{ form.text.value|e }}</textarea>
      {% call 'errorbox' form.text.errors %}<br />
      <input type="button" value="{% trans "Preview" %}" class="butt" onclick="preview('text')" />
      <input type="submit" value="{% trans "Submit" %}" class="butt" />
    </div>
  </div>

  <div id="preview" class="preview" style="display: none">
    <h2>{% trans "Preview" %}</h2>
    <div class="information">
      <strong>{% trans 'Note' %}:</strong>
      {% trans "This is only a preview of your post." %}
    </div>
    <div class="text" id="prev_text">
    </div>
  </div>
</form>
{% endblock %}
