{* vim: set et ai ts=2 sw=2 enc=utf-8: *}

{% for forum in forums %}
  {% cycle cls through "row1", "row2" %}
  <tr class="row {{ cls }}">
    {% if not forum.is_external_link %}
      <td class="forum">
        <div class="title">{*
          *}<a href="{{ forum.url }}">{{ forum.name|e }}</a>{*
        *}</div>
        {% if forum.description %}
          <div class="description">
            {{ forum.description|e }}
          </div>
          {% if forum.subforums %}
            <div class="subforums">
              <h4>{% trans "Subforums" %}:</h4>
              {% for sf in forum.subforums %}
                <a href="{{ sf.url }}">{{ sf.name|e }}</a>{% if not loop.last %}, {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        {% endif %}
      </td>
      <td class="count">{{ forum.thread_count }}/{{ forum.post_count }}</td>
      <td class="last">
        {% if forum.last_post %}
          <a href="{{ forum.last_post.url }}">{{ forum.last_post.title|e }}</a> by
          {% if forum.last_post.author.registered %}
            <a href="{{ forum.last_post.author.url }}">{{ forum.last_post.author.username|e }}</a><br />
          {% else %}
            {{ forum.last_post.author.username|e }}<br />
          {% endif %}
          {{ forum.last_post.timestamp|timedeltaformat }}
        {% else %}
          {% trans "No posts" %}
        {% endif %}
      </td>
    {% else %}
      <td class="forum" colspan="3">
        <div class="title">{*
          *}<a href="{{ forum.url }}">{{ forum.name|e }}</a>{*
        *}</div>
        {% if forum.description %}
          <div class="description">
            {{ forum.description|e }}
          </div>
        {% endif %}
      </td>
    {% endif %}
  </tr>
{% endfor %}
