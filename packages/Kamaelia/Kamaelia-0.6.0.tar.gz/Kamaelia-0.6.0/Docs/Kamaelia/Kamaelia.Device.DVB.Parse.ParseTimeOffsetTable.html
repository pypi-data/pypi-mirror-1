<html>
<head>
<title> Components/pydoc/Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable </title>

<style>
a {
    text-decoration: none;
}
*.thinborder {
    border-style: solid;
    border-width: thin;
}
.boxright {
    float: right;
    width: 20em;
    padding: 0.5em;
    margin: 1em;
    clear: right;
    border: 1px solid;
    text-align: left;
}
.leftbar {
    float: left;
    width: 10em;
    padding-left: 1.0em;
    padding-right: 0.5em;
    padding-top: 0em;
    margin-top: 0em;
    margin-bottom: 1em;
    margin-left: 0em;
    margin-right: 1em;
    clear: left;
    text-align: left;
}
.boxleft{
    float: left;
    width: 9.5em;
    padding-top: 0.5em;
    padding-bottom: 0.5em;
    padding-left: 1.0em;
    padding-right: 1.0em;
    margin-top: 1em;
    margin-bottom: 1em;
    margin-left: 0em;
    margin-right: 1em;
    clear: left;
    border-top: 5px solid;
    border-bottom: 5px solid;
    text-align: left;
}
.none { width: 100%;
        clear: both;
}

.subsection { }
.sectionheader {
                 text-align: center;
                 font-weight: bold;
                 padding-bottom: 1em;
               }
.sectioncontent { font-size: 0.9em;
                  margin-left: 2em;
                  line-height: 1.5;
                  text-align: left;
                }
.verticaldivider { float: bottom;
                   width: 100%;
                 }

 .rbroundbox_green { background: url(/t/green.corners-top.png) repeat-x; 
               width: 50%;
               float: right;
               }
 .rbtop_green div { background: url(/t/green.corners-topleft.png) no-repeat top left; }
 .rbtop_green { background: url(/t/green.corners-topright.png) no-repeat top right; }

 .rbcontent_green div { background: url(/t/green.corners-right.png) repeat-y right; 
                }
 .rbcontent_green { background: url(/t/green.corners-left.png) repeat-y left; 
              padding-left: 1.5em;
            }

 .rbbot_green div { background: url(/t/green.corners-bottomleft.png) no-repeat bottom left; }
 .rbbot_green { background: url(/t/green.corners-bottomright.png) no-repeat bottom right; }
 .rbbottom_green { background: url(/t/green.corners-bottom.png) repeat-x; }
 .rbtop_green div, .rbtop_green, .rbbot_green div, .rbbot_green {
 width: 100%;
 height: 23px;
 font-size: 1px;
 }
body {
   text-align: justify;
}

.sidebar {
    width: 10em;
    float: left;
    padding-left: 1em;
    padding-right: 1em;

}
.bodytext {

    margin: 0 5em 0em 5em;
    float: auto;
    padding-left: 1em;
    padding-right: 1em;
}
.topnav {
    padding-top: 0em;
    margin-top: 0em;
    float: right;
}
</style>

</head>
<body style="font-size: 10pt; font-family: verdana,arial,helvetica,sans-serif; line-height: 1.8;">
</div>

</span></p>
<div class="bodytext">
<html>
<head>
<title>Kamaelia docs : Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable</title>
<style type="test/css">
pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }
</style>
</head>
<body>
<div class="container">
<div class="section">
<h1><a class="reference" href="Kamaelia.html">Kamaelia</a>.<a class="reference" href="Kamaelia.Device.html">Device</a>.<a class="reference" href="Kamaelia.Device.DVB.html">DVB</a>.<a class="reference" href="Kamaelia.Device.DVB.Parse.html">Parse</a>.<a class="reference" href="Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable.html">ParseTimeOffsetTable</a></h1>
</div>
<div class="section">
<div class="container">
<ul class="simple">
<li><strong>component <a class="reference" href="Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable.ParseTimeOffsetTable.html">ParseTimeOffsetTable</a></strong></li>
</ul>
</div>
<ul class="simple">
<li><a class="reference" href="#489">Parsing Time Offset Tables in DVB streams</a><ul>
<li><a class="reference" href="#490">Example Usage</a><ul>
</ul>
</li>
<li><a class="reference" href="#491">Behaviour</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section">
<h1 id="489">Parsing Time Offset Tables in DVB streams</h1>
<p>ParseTimeOffsetTable parses a reconstructed PSI table from a DVB MPEG
Transport Stream, and outputs the current time and date in UTC (GMT) aswell as
the current time offset, and when the next change will be (due to daylight
saving).</p>
<p>The purpose of the TOT and details of the fields within in are defined in the
DVB SI specification, including the possible 'descriptor' fields that feature in
the table:</p>
<ul class="simple">
<li>ETSI EN 300 468
&quot;Digital Video Broadcasting (DVB); Specification for Service Information (SI)
in DVB systems&quot;
ETSI / EBU (DVB group)</li>
</ul>
<div class="section">
<h2 id="490"><a id="example-usage" name="example-usage">Example Usage</a></h2>
<p>A simple pipeline to receive, parse and display the Time Offset Table:</p>
<pre class="literal-block">
FREQUENCY = 505.833330
feparams = {
    &quot;inversion&quot; : dvb3.frontend.INVERSION_AUTO,
    &quot;constellation&quot; : dvb3.frontend.QAM_16,
    &quot;code_rate_HP&quot; : dvb3.frontend.FEC_3_4,
    &quot;code_rate_LP&quot; : dvb3.frontend.FEC_3_4,
}

TOT_PID = 0x14

Pipeline( DVB_Multiplex(FREQUENCY, [TOT_PID], feparams),
          DVB_Demuxer({ TOT_PID:[&quot;outbox&quot;]}),
          ReassemblePSITables(),
          ParseTimeOffsetDateTable(),
          PrettifyTimeOffsetDateTable(),
          ConsoleEchoer(),
        ).run()
</pre>
</div>
<div class="section">
<h2 id="491"><a id="behaviour" name="behaviour">Behaviour</a></h2>
<p>Send reconstructed PSI table 'sections' to the &quot;inbox&quot; inbox. When all sections
of the table have arrived, ParseTimeOffsetTable will parse the table and send it
out of its &quot;outbox&quot; outbox.</p>
<p>The table is output every time it is received. In practice a multiplex is likely
to transmit about 1 instance of this table per second, giving a reasonably
accurate measure of the current time.</p>
<p>The parsed table is sent out as a dictionary data structure, similar to this:</p>
<pre class="literal-block">
{
    'table_type' : 'TOT',
    'country'    : 'GBR'
    'region'     : 0,
    'offset'     : (0, 0),
    'next'       : { 'when'  : [2007, 3, 25, 1, 0, 0],
                     'offset': (1, 0)
                   },
    'UTC_now'    : [2006, 12, 21, 16, 16, 8],
}
</pre>
<p>If this data is sent on through a PrettifyTimeOffsetTable component, then the
equivalent output is a string of the following form:</p>
<pre class="literal-block">
TOT received:
   DateTime now (UTC)         : 2006-12-21 16:16:08
   Current local offset (h,m) : 00:00
   Country &amp; region in it     : GBR (0)
   Next change of offset:
       Changes to             : 01:00
       Changes on (y,m,d)     : 2007-03-25 01:00:00
</pre>
<p>Note that this not only includes the current date, time, location and offset
from UTC (GMT), but it also tells you when the next change of offset will happen
(due to Daylight Saving time) and what that new offset will be.</p>
<p>The above example output shows that it is currently 21st December 2006 16:16:08
GMT but that at 1am on 25th March 2007 it will change to GMT+0100.</p>
<p>If a shutdownMicroprocess or producerFinished message is received on the
&quot;control&quot; inbox, then it will immediately be sent on out of the &quot;signal&quot; outbox
and the component will then immediately terminate.</p>
</div>
</div>
<hr class="docutils" />
<div class="section">
<h1><a class="reference" href="Kamaelia.html">Kamaelia</a>.<a class="reference" href="Kamaelia.Device.html">Device</a>.<a class="reference" href="Kamaelia.Device.DVB.html">DVB</a>.<a class="reference" href="Kamaelia.Device.DVB.Parse.html">Parse</a>.<a class="reference" href="Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable.html">ParseTimeOffsetTable</a>.<a class="reference" href="Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable.ParseTimeOffsetTable.html">ParseTimeOffsetTable</a></h1>
<div class="section">
<h2 id="symbol-ParseTimeOffsetTable">class ParseTimeOffsetTable(<a class="reference" href="Axon.Component.component.html">Axon.Component.component</a>)</h2>
<p>Parses a TOT table.</p>
<p>Receives table sections from PSI packets. Outputs the current time and date
(UTC) and time zone offset.</p>
<div class="section">
<h3><a id="symbol-ParseTimeOffsetTable.Inboxes" name="symbol-ParseTimeOffsetTable.Inboxes">Inboxes</a></h3>
<ul class="simple">
<li><strong>control</strong> : Shutdown signalling</li>
<li><strong>inbox</strong> : DVB PSI Packets from a single PID containing a TOT table</li>
</ul>
</div>
<div class="section">
<h3><a id="symbol-ParseTimeOffsetTable.Outboxes" name="symbol-ParseTimeOffsetTable.Outboxes">Outboxes</a></h3>
<ul class="simple">
<li><strong>outbox</strong> : Current date and time (UTC) and time zone offset</li>
<li><strong>signal</strong> : Shutdown signalling</li>
</ul>
</div>
<div class="section">
<h3>Methods defined here</h3>
<div class="container">
</div>
<div class="section">
<h4><a id="symbol-ParseTimeOffsetTable.__init__" name="symbol-ParseTimeOffsetTable.__init__">__init__(self)</a></h4>
</div>
<div class="section">
<h4><a id="symbol-ParseTimeOffsetTable.main" name="symbol-ParseTimeOffsetTable.main">main(self)</a></h4>
</div>
<div class="section">
<h4><a id="symbol-ParseTimeOffsetTable.shutdown" name="symbol-ParseTimeOffsetTable.shutdown">shutdown(self)</a></h4>
</div>
</div>
<div class="section">
</div>
</div>
</div>
</div>





<div class="section">
<h1>Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer?
Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback
<a class="reference" href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701">here</a>
in reply to the documentation thread in the Kamaelia blog.</p>
</div>


<p><i>-- Automatic documentation generator, 19 Oct 2008 at 14:29:09 UTC/GMT</i>
</body></html>


</div>
<div style="float: left; width: 5em; text-align: center"><img src='/Kamaelia.gif'></div>
<div class="bodytext">
This is a page from the Kamaelia website. You can find the original here:
<ul><li><a href="http://www.kamaelia.org/Components/pydoc/Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable.html">
http://www.kamaelia.org/Components/pydoc/Kamaelia.Device.DVB.Parse.ParseTimeOffsetTable
</a></ul>

</div>
</body>
</html>
