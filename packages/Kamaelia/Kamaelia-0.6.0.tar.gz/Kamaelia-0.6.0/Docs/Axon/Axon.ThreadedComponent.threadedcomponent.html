<html>
<head>
<title> Docs/Axon/Axon.ThreadedComponent.threadedcomponent </title>

<style>
a {
    text-decoration: none;
}
*.thinborder {
    border-style: solid;
    border-width: thin;
}
.boxright {
    float: right;
    width: 20em;
    padding: 0.5em;
    margin: 1em;
    clear: right;
    border: 1px solid;
    text-align: left;
}
.leftbar {
    float: left;
    width: 10em;
    padding-left: 1.0em;
    padding-right: 0.5em;
    padding-top: 0em;
    margin-top: 0em;
    margin-bottom: 1em;
    margin-left: 0em;
    margin-right: 1em;
    clear: left;
    text-align: left;
}
.boxleft{
    float: left;
    width: 9.5em;
    padding-top: 0.5em;
    padding-bottom: 0.5em;
    padding-left: 1.0em;
    padding-right: 1.0em;
    margin-top: 1em;
    margin-bottom: 1em;
    margin-left: 0em;
    margin-right: 1em;
    clear: left;
    border-top: 5px solid;
    border-bottom: 5px solid;
    text-align: left;
}
.none { width: 100%;
        clear: both;
}

.subsection { }
.sectionheader {
                 text-align: center;
                 font-weight: bold;
                 padding-bottom: 1em;
               }
.sectioncontent { font-size: 0.9em;
                  margin-left: 2em;
                  line-height: 1.5;
                  text-align: left;
                }
.verticaldivider { float: bottom;
                   width: 100%;
                 }

 .rbroundbox_green { background: url(/t/green.corners-top.png) repeat-x; 
               width: 50%;
               float: right;
               }
 .rbtop_green div { background: url(/t/green.corners-topleft.png) no-repeat top left; }
 .rbtop_green { background: url(/t/green.corners-topright.png) no-repeat top right; }

 .rbcontent_green div { background: url(/t/green.corners-right.png) repeat-y right; 
                }
 .rbcontent_green { background: url(/t/green.corners-left.png) repeat-y left; 
              padding-left: 1.5em;
            }

 .rbbot_green div { background: url(/t/green.corners-bottomleft.png) no-repeat bottom left; }
 .rbbot_green { background: url(/t/green.corners-bottomright.png) no-repeat bottom right; }
 .rbbottom_green { background: url(/t/green.corners-bottom.png) repeat-x; }
 .rbtop_green div, .rbtop_green, .rbbot_green div, .rbbot_green {
 width: 100%;
 height: 23px;
 font-size: 1px;
 }
body {
   text-align: justify;
}

.sidebar {
    width: 10em;
    float: left;
    padding-left: 1em;
    padding-right: 1em;

}
.bodytext {

    margin: 0 5em 0em 5em;
    float: auto;
    padding-left: 1em;
    padding-right: 1em;
}
.topnav {
    padding-top: 0em;
    margin-top: 0em;
    float: right;
}
</style>

</head>
<body style="font-size: 10pt; font-family: verdana,arial,helvetica,sans-serif; line-height: 1.8;">
</div>

</span></p>
<div class="bodytext">
<html>
<head>
<title>Kamaelia docs : Axon.ThreadedComponent.threadedcomponent</title>
<style type="test/css">
pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }
</style>
</head>
<body>
<div class="section">
<div class="section">
<h2><a class="reference" href="Axon.html">Axon</a>.<a class="reference" href="Axon.ThreadedComponent.html">ThreadedComponent</a>.<a class="reference" href="Axon.ThreadedComponent.threadedcomponent.html">threadedcomponent</a></h2>
</div>
<p>For examples and more explanations, see the <a class="reference" href="Axon.ThreadedComponent.html">module level docs.</a></p>
<hr class="docutils" />
<div class="section">
<h2 id="symbol-threadedcomponent">class threadedcomponent(<a class="reference" href="Axon.Component.component.html">Axon.Component.component</a>)</h2>
<div class="section">
<p>threadedcomponent([queuelengths]) -&gt; new threadedcomponent</p>
<p>Base class for a version of an Axon component that runs main() in a separate
thread (meaning it can, for example, block). Subclass to make your own.</p>
<p>Internal queues buffer data between the thread and the Axon inboxes and
outboxes of the component. Set the default queue length at initialisation
(default=1000).</p>
<p>A simple example:</p>
<pre class="literal-block">
class IncrementByN(<a class="reference" href="Axon.ThreadedComponent.threadedcomponent.html">Axon.ThreadedComponent.threadedcomponent</a>):

    Inboxes = { &quot;inbox&quot; : &quot;Send numbers here&quot;,
                &quot;control&quot; : &quot;NOT USED&quot;,
              }
    Outboxes = { &quot;outbox&quot; : &quot;Incremented numbers come out here&quot;,
                 &quot;signal&quot; : &quot;NOT USED&quot;,
               }

    def __init__(self, N):
        super(IncrementByN,self).__init__()
        self.n = N

    def main(self):
        while 1:
            while self.dataReady(&quot;inbox&quot;):
                value = self.recv(&quot;inbox&quot;)
                value = value + self.n
                self.send(value,&quot;outbox&quot;)

            if not self.anyReady():
                self.pause()
</pre>
</div>
<div class="section">
<h3>Methods defined here</h3>
<div class="section">
<h4><a id="symbol-threadedcomponent.__init__" name="symbol-threadedcomponent.__init__">__init__(self, queuelengths, **argd)</a></h4>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent._do_threadsafe" name="symbol-threadedcomponent._do_threadsafe">_do_threadsafe(self, cmd, argL, argD)</a></h4>
<p>Internal method for ensuring a method call takes place in the main
scheduler's thread.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent._handlemessagefromthread" name="symbol-threadedcomponent._handlemessagefromthread">_handlemessagefromthread(self, msg)</a></h4>
<p>Unpacks a message containing a request to run a method of the form
(objectToCall, argList, argDict) then calls it and places the result
in the axontothreadqueue queue.</p>
<p>Used to execute methods on behalf of the separate thread. Results are
returned to it via the return queue.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent._localmain" name="symbol-threadedcomponent._localmain">_localmain(self)</a></h4>
<p>Do not overide this unless you reimplement the pass through of the boxes
to the threads, and state management.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent._threadmain" name="symbol-threadedcomponent._threadmain">_threadmain(self)</a></h4>
<p>Exception trapping wrapper for main().</p>
<p>Runs in the separate thread. Catches any raised exceptions and attempts
to pass them back to _localmain() to be re-raised.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.activate" name="symbol-threadedcomponent.activate">activate(self[, Scheduler][, Tracker][, mainmethod])</a></h4>
<p>Call to activate this microprocess, so it can start to be executed by a
scheduler. Usual usage is to simply call x.activate().</p>
<p>See <a class="reference" href="Axon.Microprocess.microprocess.activate.html">Axon.Microprocess.microprocess.activate</a>() for more info.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.closeDownComponent" name="symbol-threadedcomponent.closeDownComponent">closeDownComponent(self)</a></h4>
<p>Stub method. <strong>This method is designed to be overridden.</strong></p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.dataReady" name="symbol-threadedcomponent.dataReady">dataReady(self[, boxname])</a></h4>
<p>Returns true if data is available in the requested inbox.</p>
<p>Used by the main() method of a component to check an inbox for ready data.</p>
<p>Call this method to periodically check whether you've been sent any
messages to deal with!</p>
<p>You are unlikely to want to override this method.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.initialiseComponent" name="symbol-threadedcomponent.initialiseComponent">initialiseComponent(self)</a></h4>
<p>Stub method. <strong>This method is designed to be overridden.</strong></p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.link" name="symbol-threadedcomponent.link">link(self, source, sink[, passthrough])</a></h4>
<p>Creates a linkage from one inbox/outbox to another.</p>
<p>-- source  - a tuple (component, boxname) of where the link should start from
-- sink    - a tuple (component, boxname) of where the link should go to</p>
<p>Other optional arguments:</p>
<ul class="simple">
<li>passthrough=0  - (the default) link goes from an outbox to an inbox</li>
<li>passthrough=1  - the link goes from an inbox to another inbox</li>
<li>passthrough=2  - the link goes from an outbox to another outbox</li>
</ul>
<p>See Axon.Postoffice.link(...) for more information.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.main" name="symbol-threadedcomponent.main">main(self)</a></h4>
<p>Override this method, writing your own main thread of control as an
ordinary method. When the component is activated and the scheduler is
running, this what gets executed.</p>
<p>Write it as an ordinary method. Because it is run in a separate thread, it
can block.</p>
<p>If you do not override it, then a default main method exists instead that
will:</p>
<ol class="arabic simple">
<li>Call self.initialiseComponent()</li>
<li>Loop forever calling self.mainBody() repeatedly until mainBody()
returns a False/zero result.</li>
<li>Call self.closeDownComponent()</li>
</ol>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.mainBody" name="symbol-threadedcomponent.mainBody">mainBody(self)</a></h4>
<p>Stub method. <strong>This method is designed to be overridden.</strong></p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.pause" name="symbol-threadedcomponent.pause">pause(self[, timeout])</a></h4>
<p>Pauses the thread and blocks - does not return until the something
happens to re-awake it, or until it times out (if the optional timeout
is specified)</p>
<p>Must only be called from within the main() method - ie. from within the
separate thread.</p>
<p>Keyword arguments:</p>
<ul class="simple">
<li>timeout  -- Optional. None, or the number of seconds after which this call should unblock itself (default=None)</li>
</ul>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.recv" name="symbol-threadedcomponent.recv">recv(self[, boxname])</a></h4>
<p>returns the first piece of data in the requested inbox.</p>
<p>Used by the main() method to recieve a message from the outside world.
All comms goes via a named box/input queue</p>
<p>You will want to call this method to actually recieve messages you've been
sent. You will want to check for new messages using dataReady first
though.</p>
<p>You are unlikely to want to override this method.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.send" name="symbol-threadedcomponent.send">send(self, message[, boxname])</a></h4>
<p>appends message to the requested outbox.</p>
<p>Used by the main() method to send a message to the outside world.
All comms goes via a named box/output queue</p>
<p>You will want to call this method to send messages.</p>
<p>Raises <a class="reference" href="Axon.AxonExceptions.noSpaceInBox.html">Axon.AxonExceptions.noSpaceInBox</a> if this outbox is linked to a
destination inbox that is full, or if your component is producing messages
faster than Axon can pass them on.</p>
<p>You are unlikely to want to override this method.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.sync" name="symbol-threadedcomponent.sync">sync(self)</a></h4>
<p>Call this from main() to synchronise with the main scheduler's thread.</p>
<p>You may wish to do this to throttle your component's behaviour
This is akin to posix.sched_yield or shoving extra &quot;yield&quot;
statements into a component's generator.</p>
</div>
<div class="section">
<h4><a id="symbol-threadedcomponent.unlink" name="symbol-threadedcomponent.unlink">unlink(self[, thecomponent][, thelinkage])</a></h4>
<p>Destroys all linkages to/from the specified component or destroys the
specific linkage specified.</p>
<p>Only destroys linkage(s) that were created <em>by</em> this component itself.</p>
<p>Keyword arguments:</p>
<ul class="simple">
<li>thecomponent -- None or a component object</li>
<li>thelinakge   -- None or the linkage to remove</li>
</ul>
</div>
</div>
<div class="section">
<div class="section">
<h4>Methods inherited from <a class="reference" href="Axon.Component.component.html">Axon.Component.component</a> :</h4>
<ul class="simple">
<li><a class="reference" href="Axon.Component.html#symbol-component.__str__">__str__</a>(self)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.childComponents">childComponents</a>(self)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.setInboxSize">setInboxSize</a>(self, boxname, size)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.anyReady">anyReady</a>(self)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.__addChild">__addChild</a>(self, child)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component._closeDownMicroprocess">_closeDownMicroprocess</a>(self)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component._deliver">_deliver</a>(self, message[, boxname])</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.removeChild">removeChild</a>(self, child)</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.Inbox">Inbox</a>(self[, boxname])</li>
<li><a class="reference" href="Axon.Component.html#symbol-component.addChildren">addChildren</a>(self, *children)</li>
</ul>
</div>
<div class="section">
<h4>Methods inherited from <a class="reference" href="Axon.Microprocess.microprocess.html">Axon.Microprocess.microprocess</a> :</h4>
<ul class="simple">
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess._unpause">_unpause</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess._microprocessGenerator">_microprocessGenerator</a>(self, someobject[, mainmethod])</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess._isStopped">_isStopped</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess.stop">stop</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess.next">next</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess.unpause">unpause</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess.run">run</a>(self)</li>
<li><a class="reference" href="Axon.Microprocess.html#symbol-microprocess._isRunnable">_isRunnable</a>(self)</li>
</ul>
</div>
</div>
</div>
</div>









<div class="section">
<h1>Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer?
Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback
<a class="reference" href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701">here</a>
in reply to the documentation thread in the Kamaelia blog.</p>
</div>




<p><i>-- Automatic documentation generator, 19 Oct 2008 at 14:28:09 UTC/GMT</i>
</body></html>


</div>
<div style="float: left; width: 5em; text-align: center"><img src='/Kamaelia.gif'></div>
<div class="bodytext">
This is a page from the Kamaelia website. You can find the original here:
<ul><li><a href="http://www.kamaelia.org/Docs/Axon/Axon.ThreadedComponent.threadedcomponent.html">
http://www.kamaelia.org/Docs/Axon/Axon.ThreadedComponent.threadedcomponent
</a></ul>

</div>
</body>
</html>
