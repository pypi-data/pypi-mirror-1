<html>
<head>
<title>StructArray - Rabbyt Reference</title>
</head>
<body>

<a href="../../rabbyt/">Documentation Index</a> | From module <a href="../../structarray/">structarray</a>.
<h1>StructArray</h1>



<p><tt class="docutils literal"><span class="pre">StructArray(attributes,</span> <span class="pre">[initial_data,</span> <span class="pre">swizzles,</span> <span class="pre">size,</span> <span class="pre">defaults])</span></tt></p>
<p>StructArray provides an array of structred data.</p>
<p><tt class="docutils literal"><span class="pre">attributes</span></tt> the list of attribute names.
e.g., <tt class="docutils literal"><span class="pre">('x',</span> <span class="pre">'y',</span> <span class="pre">'dx',</span> <span class="pre">'dy')</span></tt>  An <tt class="docutils literal"><span class="pre">Array</span></tt> will be created for each of
these.</p>
<p><tt class="docutils literal"><span class="pre">initial_data</span></tt> is a list of tuples to fill the array with.</p>
<p><tt class="docutils literal"><span class="pre">swizzles</span></tt> provides shortcuts for accessing multiple attributes at a
time.  (This is currently not implemented.)</p>
<p><tt class="docutils literal"><span class="pre">size</span></tt> is the initial length of the array.  If <tt class="docutils literal"><span class="pre">size</span></tt> is longer than
<tt class="docutils literal"><span class="pre">initial_data</span></tt>, the remaining items will be filled in by <tt class="docutils literal"><span class="pre">defaults</span></tt>.
If if <tt class="docutils literal"><span class="pre">initial_data</span></tt> is longer than <tt class="docutils literal"><span class="pre">size</span></tt>, it's length will be used
instead.</p>
<p>If <tt class="docutils literal"><span class="pre">size</span></tt> is a tuple with more than one item, the array will be
multidimensional.  See the documentation for the <tt class="docutils literal"><span class="pre">structarray</span></tt> module
for more on multidimensional arrays.</p>
<p><tt class="docutils literal"><span class="pre">defaults</span></tt> is a tuple of default values for the items.  (One value
corresponding to each attribute.)  This is used both for initially creating
the array, and when <tt class="docutils literal"><span class="pre">set_length()</span></tt> is called.</p>
<p>Item access on a <tt class="docutils literal"><span class="pre">StructArray</span></tt> returns an <tt class="docutils literal"><span class="pre">item</span></tt> object, which
has attributes corresponding to the attributes of the <tt class="docutils literal"><span class="pre">StructArray</span></tt>.</p>
<p>This might make it clearer:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; particles = StructArray(('x', 'y', 'dx', 'dy'), size=10)
&gt;&gt;&gt; p = particles[1]
&gt;&gt;&gt; print p
&lt;item at index 1 (0.0, 0.0, 0.0, 0.0)&gt;
&gt;&gt;&gt; p.x, p.y = 0, 100
&gt;&gt;&gt; p.dx, p.dy = 0, 5
&gt;&gt;&gt; print particles[0]
&lt;item at index 1 (0.0, 100.0, 0.0, 5.0)&gt;
</pre>
</blockquote>
<p>Additionally, an array is created for each attribute, allowing you to work
with the value of that attribute for all of the items:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; print particles.y
&lt;OffsetArray [0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&gt;
</pre>
</blockquote>
<p>(<tt class="docutils literal"><span class="pre">OffsetArray</span></tt> is simply a subclass of <tt class="docutils literal"><span class="pre">Array</span></tt> that stores it's data
at an offset inside of another array.  It works just like <tt class="docutils literal"><span class="pre">Array</span></tt>, only
you can't change the length.)</p>
<p>Assigning to an attribute will do the 'right thing':</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; particles.dx = 6.5
&gt;&gt;&gt; particles.x += particles.dx*2
&gt;&gt;&gt; print particles[1]
&lt;item at index 1 (13.0, 100.0, 6.5, 5.0)&gt;
</pre>
</blockquote>
<p>You can also assign a tuple to an item:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; particles[2] = (15, 20, 0, 100)
&gt;&gt;&gt; print particles[2]
&lt;item at index 2 (15.0, 20.0, 0.0, 100.0)&gt;
</pre>
</blockquote>
<p>When assigning a tuple, you can ommit some values, leaving them as they are:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; particles[2] = (100, 200)
&gt;&gt;&gt; print particles[2]
&lt;item at index 2 (100.0, 200.0, 0.0, 100.0)&gt;
</pre>
</blockquote>



<div class="section">
<h2>Methods</h2>

<div class="section">
    <h3>append</h3>
    <p><tt class="docutils literal"><span class="pre">append(item)</span></tt></p>
<p>Appends an item to the array.</p>

</div>

<div class="section">
    <h3>extend</h3>
    <p><tt class="docutils literal"><span class="pre">extend(items)</span></tt></p>
<p>Iterates over <tt class="docutils literal"><span class="pre">items</span></tt>, calling <tt class="docutils literal"><span class="pre">append()</span></tt> on each one.</p>

</div>

<div class="section">
    <h3>get_data_addr</h3>
    <p><tt class="docutils literal"><span class="pre">get_data_addr()</span></tt></p>
<p>Gets the memory address of the data.</p>
<p>This, together with <tt class="docutils literal"><span class="pre">get_data_stride()</span></tt>, can be used with PyOpenGL
or Pyglet for OpenGL vertex arrays.  For example:</p>
<pre class="doctest-block">
&gt;&gt;&gt; array = StructArray((&quot;x&quot;, &quot;y&quot;), size=100, defaults=(0,0))
&gt;&gt;&gt; glVertexPointer(2, GL_FLOAT,
...     array.get_data_stride(),
...     array.get_data_addr())
</pre>

</div>

<div class="section">
    <h3>get_data_stride</h3>
    <p><tt class="docutils literal"><span class="pre">get_data_stride()</span></tt></p>
<p>Gets the number of bytes between the begining of each array element.</p>

</div>

<div class="section">
    <h3>get_dimensions</h3>
    <p><tt class="docutils literal"><span class="pre">get_size()</span></tt></p>
<p>Returns a tuple of this array's dimensional size.</p>
<p>If it is a single dimension array, a tuple containing the length will
be returned.</p>

</div>

<div class="section">
    <h3>sanitize_index</h3>
    <p><tt class="docutils literal"><span class="pre">sanitize_index(index)</span></tt> -&gt; sanitized index</p>
<p>This method takes an index, such as passed to __getitem__, and  returns
an index that is between 0 and len(self).  (So that it can be used with
the underlying C array.)  This includes handling negitive and/or
multidimensional indexes.</p>
<p>Slices are currently not supported.</p>

</div>

<div class="section">
    <h3>set_length</h3>
    <p><tt class="docutils literal"><span class="pre">set_length(length)</span></tt></p>
<p>Sets the length explicitly.</p>
<p>This is an alternative to using <tt class="docutils literal"><span class="pre">append</span></tt> and <tt class="docutils literal"><span class="pre">extend</span></tt>.  (It should
be a little faster.)</p>

</div>

</div>





</body>
</html>