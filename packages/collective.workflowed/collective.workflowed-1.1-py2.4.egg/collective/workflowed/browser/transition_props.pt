<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      i18n:domain="collective.workflowed">
<head>
<style type="text/css" media="screen" tal:content="string: @import url(${context/portal_url}/base.css);"></style>
</head>
<body>
<h1><span i18n:translate="label_edit_transition">Edit properties for transition</span> <span tal:replace="context/id"></span></h1>
<form action="setProperties" method="POST" onSubmit="window.opener.close_popup();return true;">
<table>

<tr>
<th align="left" i18n:translate="label_id">Id</th>
<td tal:content="context/id"></td>
</tr>

<tr>
<th align="left" i18n:translate="label_title">Title</th>
<td><input type="text" name="title" value="" size="50" tal:attributes="value context/title" /></td>
</tr>

<tr>
<th align="left" valign="top" i18n:translate="label_description">Description</th>
<td><textarea name="description" rows="6" cols="30" tal:content="context/description"></textarea></td>
</tr>

<tr>
<th align="left" i18n:translate="label_destination_state">Destination state</th>
<td>
 <select name="new_state_id" size="1">
   <option value="" tal:attributes="selected python:not context.new_state_id and 'selected' or ''">(Remain in state)</option>
  <tal:block repeat="state context/getAvailableStateIds">
    <option tal:attributes="value state;selected python:context.new_state_id==state and 'selected' or ''" tal:content="state"></option>
  </tal:block>
 </select>
</td>
</tr>

<tr>
<th align="left" i18n:translate="label_trigger_type">Trigger type</th>
<td>
<input type="radio" name="trigger_type" value="0" tal:attributes="checked python:context.trigger_type==0 and 'checked' or ''"/>
<span i18n:translate="label_automatic">Automatic</span>
</td>
</tr>

<tr>
<th></th>
<td>
<input type="radio" name="trigger_type" value="1" tal:attributes="checked python:context.trigger_type==1 and 'checked' or ''"/>
<span i18n:translate="label_user_action">Initiated by user action</span>
</td>
</tr>

<!--
<tr>
<th></th>
<td>
<input type="radio" name="trigger_type" value="2" tal:attributes="checked python:test(context.trigger_type==2,'checked','')"/>
Initiated by WorkflowMethod
</td>
</tr>
-->

<tr>
<th align="left" i18n:translate="label_script_before">Script (before)</th>
<td>
<select name="script_name">
<option value="">(None)</option>
<tal:block repeat="script context/getAvailableScriptIds">
    <option tal:attributes="value script;selected python:context.script_name==script and 'selected' or ''" tal:content="script"></option>
</tal:block>
</select>
</td>
</tr>

<tr>
<th align="left" i18n:translate="label_script_after">Script (after)</th>
<td>
<select name="after_script_name">
<option value="">(None)</option>
<tal:block repeat="script context/getAvailableScriptIds">
    <option tal:attributes="value script;selected python:context.after_script_name==script and 'selected' or ''" tal:content="script"></option>
</tal:block>
</select>
</td>
</tr>

<tr>
<th align="left" valign="top" i18n:translate="label_guard">Guard</th>
<td tal:define="guard context/getGuard">

<table>
<tr>
<th align="left" i18n:translate="label_permissions">Permission(s)</th>
<td><input type="text" name="guard_permissions" value="" tal:attributes="value guard/getPermissionsText" /></td>
</tr>
<tr>
<th align="left" i18n:translate="label_roles">Roles</th>
<td><input type="text" name="guard_roles" value="" tal:attributes="value guard/getRolesText" /></td>
</tr>
<tr>
<th align="left" i18n:translate="label_groups">Groups</th>
<td><input type="text" name="guard_groups" value="" tal:attributes="value guard/getGroupsText" /></td>
</tr>
<tr>
<th align="left" i18n:translate="label_expression">Expression</th>
<td colspan="3">
<input type="text" name="guard_expr" value="" size="50" tal:attributes="value guard/getExprText" />
</td>
</tr>
</table>

</td>
</tr>

<tr>
<th align="left" valign="top" i18n:translate="label_display_in_actions">Display in actions box</th>
<td>
 <table>
  <tr>
   <th align="left" i18n:translate="label_name_formatted">Name (formatted)</th>
   <td>
    <input type="text" name="actbox_name"
     value="" size="50" tal:attributes="value context/actbox_name" />
   </td>
  </tr>
  <tr>
   <th align="left" i18n:translate="label_url_formatted">URL (formatted)</th>
   <td>
    <input type="text" name="actbox_url"
     value="" size="50" tal:attributes="value context/actbox_url" />
   </td>
  </tr>
  <tr>
   <th align="left" i18n:translate="label_category">Category</th>
   <td>
    <input type="text" name="actbox_category"
     value="" tal:attributes="value context/actbox_category" />
   </td>
  </tr>
 </table>
</td>
</tr>

</table>
<input type="submit" name="submit" i18n:attributes="save_changes_button" value="Save changes" />
</form>

</body>
</html>
