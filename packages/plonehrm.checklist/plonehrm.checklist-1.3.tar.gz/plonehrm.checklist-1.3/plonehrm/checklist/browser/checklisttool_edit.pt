<form method="post"
      class="enableFormTabbing"
      tal:attributes="action here/absolute_url"
      tal:define="sorted_items view/get_sorted_items"
      i18n:domain="checklist">

  <tal:block tal:repeat="type python: ['default', 'manager', 'endcontract']">
    <fieldset tal:attributes="id python: 'fieldset-' + type">
      <legend tal:content="python: sorted_items[type][1]"
	      tal:attributes="id python: 'fieldsetlegend-' + type"/>
      <p class="discreet" tal:content="python: sorted_items[type][2]" />
      <tal:block tal:repeat="item python: sorted_items[type][0]">
	<div class="field"
	     tal:attributes="id python: 'field_' + str(item.id);
			     name python: 'field_' + str(item.id)">
	  <input type="text"
		 tal:attributes="value item/text;
				 name python: 'text_' + str(item.id)" />
	  <a href="#"
	     class="checklist_tool_delete_link"
	     tal:attributes="id python: 'delete_' + str(item.id)">
	    <img src="delete_icon.gif" />
	  </a>
	  
	  <p class="dont-show"
	     tal:attributes="id python: 'error_empty_' + str(item.id)"
	     i18n:translate="msg_error_empty_item">
	    Task text can not be empty.</p>
	  
	  <p class="dont-show"
	     tal:attributes="id python: 'error_conflict_' + str(item.id)"
	     i18n:translate="msg_error_conflict_item">
	    A task with this name already exists.</p>
	  
	  <div class="dont-show"
	       tal:attributes="id python: 'delete_form_' + str(item.id)">
	    <span i18n:translate="msg_confirm_delete">
	      Are you sure you want to delete this item?</span>
	    <input type="button"
		   class="context checklist_tool_confirm_delete"
		   value="delete"
		   i18n:domain="plone"
		   i18n:attributes="value label_delete"
		   tal:attributes="id python: 'confirm_delete_' + str(item.id)"/>
	    <input type="button"
		   class="context checklist_tool_cancel_delete"
		   value="cancel"
		   i18n:domain="plone"
		   i18n:attributes="value label_cancel"
		   tal:attributes="id python: 'cancel_delete_' + str(item.id)"/>
	  </div>
	</div>
      </tal:block>
      <div tal:attributes="id python: 'created_' + type" />
      
      <div class="field"
	   tal:attributes="id python: 'new_' + type">
	<div tal:attributes="id python: 'command_new_' + type">
	  <a href="#"
	     class="checklist_tool_add_new_link"
	     tal:attributes="id python: 'new_button_' + type">
	    <img src="add_icon.gif" />
	    <span i18n:translate="msg_add_new_task">
	      Add new task.</span>
	  </a>	
	</div>
	
	<div class="dont-show"
	     tal:attributes="id python:'field_new_' + type">
	  <input type="text"
		 tal:attributes="id python: 'new_text_' + type;
				 name python: 'new_text_' + type" />
	  
	  <input type="checkbox"
		 tal:condition="python: sorted_items[type][3]"
		 tal:attributes="name python: 'add-to-all_' + type" />
	  
	  <span tal:condition="python: sorted_items[type][3]"
		i18n:translate="msg_add_to_all">
	    Add to all existing employees</span>
	  
	  <p class="dont-show"
	     tal:attributes="id python: 'error_conflict_' + type"
	     i18n:translate="msg_error_conflict_item">
	    A task with this name already exists.</p>
	</div>
      </div>
    </fieldset>
  </tal:block>
  <div i18n:domain="plone">
    <input type="button"
	   class="context"
	   value="save"
	   i18n:attributes="value label_save"
	   id="save_checklist_tool" />
    <input type="button"
	   class="context"
	   value="cancel"
	   i18n:attributes="value label_cancel"
	   id="cancel_checklist_tool"/>
  </div>
</form>
