<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type" />
  
  <title>Transaction Attributes</title><meta name="generator" content="amaya 8.1a, see http://www.w3.org/Amaya/" />
  <link href="styles.css" rel="stylesheet" type="text/css" /></head>
<body>
<h1>Transaction Attributes</h1>
<p>Sometimes, an application will process an incoming request using a number of different resource objects. For example, in the <a href="paths-filesystem.html">"Treating the Path Like a Filesystem"</a> document, an example is given which involves a number of&nbsp;<code>MapResource</code>
objects arranged in a hierarchy, and whilst such objects are used
merely to select other resources which are then used to provide some
kind of output, there may be other situations where such objects may
need to record some information about their activities, so that the
output-producing resource may customise the output accordingly.</p><p>In&nbsp;the example mentioned above, let
us consider the effect of replacing the special mapping from explicitly
specified year numbers with a new resource object that&nbsp;recognises
year numbers and&nbsp;dispatches requests to other resources:</p><pre>news_resource = YearResource({"document.html" : document_resource, "article.html" : article_resource})<br />documents_resource = MapResource({"news" : news_resource})<br />top_resource = MapResource({"documents" : documents_resource})</pre><p>What&nbsp;<code>YearResource</code> objects would do is to take the year number from the URL (see <a href="paths.html">"URLs and Paths"</a>)
and then to match a name in the dictionary it was initialised with, in
order to dispatch the transaction to a suitable resource. However, it
is likely that the year number is important to such resources: we would
expect to see a different Web page for&nbsp;<code>document.html</code> in&nbsp;<code>2005</code> than in&nbsp;<code>2004</code>, for example. Consequently, the&nbsp;<code>YearResource</code> needs a way to communicate such information to other resources.</p><p>Although we could provide special methods or change the parameters of the&nbsp;<code>respond</code> method in the&nbsp;<code>document_resource</code> and&nbsp;<code>article_resource</code>
objects in order to create a "channel" through which year information
could be passed, an alternative is to retain the existing interface and
behaviour of those objects and to store such information in the
transaction object itself. Since the transaction is&nbsp;essential in
the processing of any incoming request, we can be certain that it will
be available to store and to provide such information when necessary. </p><h2>Using Transaction Attributes</h2>
<p>We may obtain the attributes from the transaction by performing a method call as follows:</p><pre>        # In the respond method...<br />        attributes = trans.get_attributes()</pre><p>This
will provide a dictionary mapping names to&nbsp;attribute values. The
structure of the values is not strictly defined, and it is the
application's role to enforce its own rules on the data stored in the
attributes dictionary.</p><p>Setting and getting values is as straightforward as using a normal dictionary:</p>
<pre>        # Continuing from above...<br />        attributes["year"] = year<br />        # Later...<br />        if attributes.has_key("year"):<br />            year = attributes["year"]<br /></pre><p>As described in the <a href="../apidocs/public/WebStack.Generic.Transaction-class.html#get_attributes">API documentation</a>,
the attributes dictionary exists as long as the transaction object
itself. Should information need to be stored beyond the lifetime of a
transaction, the appropriate persistent information facilities should
be used instead - see <a href="sessions.html">"Sessions and Persistent Information"</a> for more details.</p></body></html>