<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
  <title>Writing Adapters</title>
  <link href="styles.css" rel="stylesheet" type="text/css" /></head>
<body>
<h1>Writing Adapters</h1>

<p>Depending on how "simple" the
adapter code is allowed to be for a
given
server environment (see the <a href="#table">table</a>
for a
summary), you will either need to write a small piece of code which
initialises and deploys your application, or to produce a more
complicated
piece of code which satisfies some more demanding server requirements.</p>

<h2>Simple Adapters - Using the deploy Function</h2>

<p>When deploying an application, it is possible to use a one-shot deployment
function for BaseHTTPRequestServer, CGI, Django, Java Servlet, mod_python,
Twisted and WSGI configurations. The <code>deploy</code> function is called as
follows:</p>

<pre>deploy(resource)
deploy(resource, authenticator) # where authenticators are used
</pre>

<p><strong>Note</strong> that for WSGI, the functions <code>deploy_as_cgi</code>
and <code>deploy_with_wsgiref</code> are provided instead, and the appropriate
function could be imported like this:</p>

<pre>from WebStack.Adapters.WSGI import deploy_as_cgi as deploy</pre>

<p>For some frameworks, an address may be specified:</p>

<pre>deploy(resource, address=(host_string, port_integer))
deploy(resource, authenticator, address=(host_string, port_integer))
</pre>

<p>And for some frameworks, the return value of the function is important:</p>

<pre>something = deploy(resource)
something, something_else = deploy(resource, authenticator)
</pre>

<p>Here is a summary of which
frameworks require address information and which produce important return values from the <code>deploy</code> function:</p>

<table border="1" cellpadding="5" cellspacing="0">
  <tbody>
    <tr>
      <th>Framework</th>
      <th>Address Information</th>
      <th>Return Values</th>
    </tr>
    <tr>
      <td>BaseHTTPRequestHandler</td>
      <td>Supported</td>
      <td></td>
    </tr>
    <tr>
      <td>CGI</td>
      <td>Ignored</td>
      <td></td>
    </tr>
    <tr>
      <td>Django</td>
      <td>Ignored</td>
      <td>Handler function</td>
    </tr>
    <tr>
      <td>Java Servlet</td>
      <td>Ignored</td>
      <td>Servlet class</td>
    </tr>
    <tr>
      <td>mod_python</td>
      <td>Ignored</td>
      <td>Handler function and authenticator function (a 2-tuple)</td>
    </tr>
    <tr>
      <td>Twisted</td>
      <td>Supported (<code>host_string</code> is ignored)</td>
      <td></td>
    </tr>
    <tr>
      <td>Webware (&gt; 0.8.1)</td>
      <td>Ignored</td>
      <td>URL context object</td>
    </tr>
    <tr>
      <td>WSGI</td>
      <td>Supported for <code>deploy_with_wsgiref</code><br />
        Ignored for <code>deploy_as_cgi</code>
      </td>
      <td></td>
    </tr>
  </tbody>
</table>

<h3>Debugging Applications</h3>

<p>Sometimes, when resources throw unhandled exceptions when processing
requests, it is desirable to see the details of the exceptions either
in the Web browser or in the console from which the application was
started. For such purposes, a parameter to the <code>deploy</code>
function can be used:</p>
<pre>deploy(resource, handle_errors=0)</pre>
<p>The <code>handle_errors</code> parameter, if specified with a
false value, will not supress unhandled exceptions with an "internal
server error" response, but will instead provide the underlying server
environment's report of such exceptions.</p>

<h2><a name="table">Complicated Adapters - Providing Framework-Specific Objects</a></h2>

<p>The remaining frameworks (Java Servlet, mod_python, Webware and Zope) do
not support the <code>deploy</code> function due to the way applications are
typically integrated into the various server mechanisms. In these cases, it
may be worth investigating the examples provided and using their adapter code
as a template for the code for your own applications. Here is a summary which
indicates the server environments or frameworks which need most work:</p>

<table border="1" cellpadding="5" cellspacing="0">
  <tbody>
    <tr>
      <th>Framework</th>
      <th>Adapter Code Requirements</th>
      <th>Deployment Process</th>
    </tr>
    <tr>
      <td>BaseHTTPRequestHandler</td>
      <td>Simple - see above</td>
      <td>Run the adapter code directly</td>
    </tr>
    <tr>
      <td>CGI</td>
      <td>Simple - see above</td>
      <td>Web server runs the adapter code</td>
    </tr>
    <tr><td>Django</td><td>Simple - see above</td><td>The adapter prepares the handler function</td></tr><tr>
      <td>Java Servlet</td>
      <td><span style="font-family: monospace;"></span><code></code>Simple - see above</td>
      <td>The adapter prepares the servlet class</td>
    </tr>
    <tr>
      <td>mod_python</td>
      <td><span style="font-family: monospace;"></span><code></code>Simple - see above</td>
      <td>The adapter prepares the handler function</td>
    </tr>
    <tr>
      <td>Twisted</td>
      <td>Simple - see above</td>
      <td>Run the adapter code
directly</td>
    </tr>
    <tr>
      <td>Webware</td>
      <td>&lt;= 0.8.1: Must implement <code>InstallInWebKit</code> function<br />
&gt; 0.8.1: Simple - see above</td>
      <td>Application must be deployed within WebKit</td>
    </tr>
    <tr>
      <td>WSGI</td>
      <td>Simple - see above</td>
      <td>Either the adapter code is run directly (<code>deploy_with_wsgiref</code>)<br />
        Or the Web server runs the adapter code (<code>deploy_as_cgi</code>)
      </td>
    </tr>
    <tr>
      <td>Zope</td>
      <td>Must provide lots of Zope administative classes and functions</td>
      <td>Application must be deployed within Zope</td>
    </tr>
  </tbody>
</table>
<p>See <a href="deploying-applications.html">"Deploying an
Application"</a>
for more details of the deployment process for each environment.</p>
</body></html>
